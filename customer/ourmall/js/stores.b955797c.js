(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["stores"],{"340e":function(e,t,o){e.exports=o.p+"img/shopify_icon.862d4ffa.png"},"4d6b":function(e,t,o){e.exports=o.p+"img/lazada_icon.895bb3eb.png"},"52ae":function(e,t,o){e.exports=o.p+"img/shopify.7222219d.png"},"60c6":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"contentpanel my-custom-page"},[t("div",{ref:"pageHeader",staticClass:"pagetitle"},[e._m(0),t("div",{staticClass:"right"},[t("el-button",{attrs:{type:"primary"},on:{click:e.openConnectStore}},[e._v("Add a new store")])],1)]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"pagebody"},[t("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[t("el-col",{attrs:{span:24}},[t("el-card",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("div",{ref:"pageFilter",staticClass:"page-filter"},[t("el-form",{attrs:{inline:!0,size:"mini"}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"Name"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.name,callback:function(t){e.$set(e.filterParams,"name",t)},expression:"filterParams.name"}})],1),t("el-form-item",{attrs:{label:"Auth Status:"}},[t("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"All Status"},on:{change:e.filterGetItem},model:{value:e.filterParams.isAuth,callback:function(t){e.$set(e.filterParams,"isAuth",t)},expression:"filterParams.isAuth"}},[t("el-option",{attrs:{label:"All Status",value:""}}),t("el-option",{attrs:{label:"Authorized",value:"1"}}),t("el-option",{attrs:{label:"Unauthorized",value:"2"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.filterGetItem}},[e._v("Filter")]),t("el-button",{attrs:{type:"danger"},on:{click:e.clearFilter}},[e._v("Clear")])],1)],1)],1)])],1),t("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{data:e.items,stripe:"","row-key":"id"}},[t("el-table-column",{attrs:{label:"Store Name",width:"400"},scopedSlots:e._u([{key:"default",fn:function(o){return[o.row.shopName&&"3"!=o.row.platform?t("div",[t("shopCate",{attrs:{items:o.row}}),t("el-link",{attrs:{type:"primary",href:"//"+o.row.shopUrl,target:"_blank"}},[e._v(e._s(o.row.shopName))])],1):t("div",[e._v(e._s(o.row.shopName||"---"))])]}}])}),t("el-table-column",{attrs:{label:"Date"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",{staticStyle:{color:"#909399"}},[e._v(" Creation date: "),t("span",{staticStyle:{color:"#303133"}},[e._v(e._s(o.row.timeCreated?e.moment.unix(o.row.timeCreated).format("ll [at] LTS"):"---"))])]),t("div",{staticStyle:{color:"#909399"}},[e._v(" Auth date: "),t("span",{staticStyle:{color:"#303133"}},[e._v(e._s(o.row.timeAuth?e.moment.unix(o.row.timeAuth).format("ll [at] LTS"):"---"))])])]}}])}),t("el-table-column",{attrs:{label:"Whether to host"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-switch",{attrs:{value:Number(o.row.isDeposit),"active-value":1,"inactive-value":2,"active-color":"rgba(69, 219, 94, 1)"},on:{change:function(t){return e.changeDeposit(o.row)}}})]}}])}),t("el-table-column",{attrs:{label:"Status"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("span",{staticClass:"s-label",class:1==o.row.authStatus?"label-success":"label-warning"},[e._v(e._s(1==o.row.authStatus?"Authorized":"Unauthorized"))])]}}])}),t("el-table-column",{attrs:{label:"Action",width:"300"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("div",[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.delStore(o.row)}}},[e._v("Delete")])],1),o.row.vendorName?t("div",[t("el-link",{attrs:{type:"danger"},on:{click:function(t){return e.entrustedRemove(o.row)}}},[e._v("Remove entrusted vendor")])],1):e._e(),t("div",[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.connectStoreAgain(o.row)}}},[e._v("Reauthorize")])],1)]}}])})],1)],1)],1)],1),e.items.length?t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[t("div",[t("el-pagination",{attrs:{"current-page":e.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":e.pageSizes,"page-size":e.rowsPerPage,total:Number(e.total)},on:{"current-change":e.toPage,"size-change":e.changePageSize}})],1)])],1):e._e()],1),t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.connectStoreLoading,expression:"connectStoreLoading"}],attrs:{title:e.modiWoo?"Reauthorization":"Add a new store","custom-class":"connectStore",visible:e.connectStoreOpen,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(t){e.connectStoreOpen=t}}},[t("el-divider"),t("el-form",{attrs:{"label-position":"left","label-width":"110px"}},[t("el-form-item",{attrs:{label:"Store type:"}},[t("div",{staticClass:"imgList"},[e._l(e.platformArr,(function(o,i){return[e.modiWoo&&"woo"!=i?e._e():t("div",{key:i,staticClass:"shopImg",class:{active:e.activePlatform==i,disable:!o.enabled},on:{click:function(t){return e.selectPlatform(i,o.enabled)}}},[t("img",{style:{opacity:o.enabled?1:.5},attrs:{src:e.shopImgList[i],alt:o.name}}),o.enabled?e._e():t("a",{staticClass:"comingSoon",attrs:{href:"javascript:;"}},[e._v("Coming Soon")])])]}))],2)]),"shopify"==e.activePlatform?t("el-form-item",{attrs:{label:"Store URL:"}},[t("div",[t("el-input",{attrs:{disabled:""!=e.errorMessage,size:"medium",placeholder:"Your store name"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.connectStoreFn.apply(null,arguments)}},model:{value:e.shopifyUrl,callback:function(t){e.shopifyUrl=t},expression:"shopifyUrl"}},[t("template",{slot:"prepend"},[e._v("https://")]),t("template",{slot:"append"},[e._v(".myshopify.com")])],2)],1),e.vipData.service?e._e():t("div",[t("i",{staticClass:"el-icon-info"}),t("span",{staticClass:"mg-l-5"},[e._v(e._s(e.$root.$children[0].shopName))]),e._v(" vendor is authorizing the store on Ourmall Dropshipping App, please be noted. ")])]):e._e(),"woo"==e.activePlatform?[t("el-form-item",{attrs:{label:"Store URL:"}},[t("el-input",{staticStyle:{width:"70%"},attrs:{size:"medium",placeholder:"Your Woocommerce store name"},model:{value:e.shopifyUrl,callback:function(t){e.shopifyUrl=t},expression:"shopifyUrl"}})],1),t("el-form-item",{attrs:{label:"ApiKey:"}},[t("el-input",{staticStyle:{width:"50%"},attrs:{size:"medium"},model:{value:e.ApiKey,callback:function(t){e.ApiKey=t},expression:"ApiKey"}})],1),t("el-form-item",{attrs:{label:"ApiSecretKey:"}},[t("el-input",{staticStyle:{width:"50%"},attrs:{size:"medium"},model:{value:e.ApiSecretKey,callback:function(t){e.ApiSecretKey=t},expression:"ApiSecretKey"}})],1)]:e._e(),"shopee"==e.activePlatform?[t("el-form-item",{attrs:{label:"Store Name:"}},[t("el-row",[t("el-col",{attrs:{span:15}},[t("el-input",{attrs:{size:"medium",placeholder:"Your store name"},model:{value:e.shopeeShopName,callback:function(t){e.shopeeShopName=t},expression:"shopeeShopName"}})],1),t("el-col",{attrs:{span:7,offset:1}},[t("el-button",{attrs:{loading:e.authLoading,size:"medium",type:"primary",disabled:!e.shopeeShopName.trim()},on:{click:e.authShopee}},[e._v("Authroize")])],1)],1)],1),t("el-form-item",{attrs:{label:"Auth Code:"}},[t("el-row",[t("el-col",{attrs:{span:15}},[t("el-input",{attrs:{size:"medium",placeholder:"Auth Code"},model:{value:e.shopeeAuthCode,callback:function(t){e.shopeeAuthCode=t},expression:"shopeeAuthCode"}})],1)],1)],1)]:e._e(),"shopify"==e.activePlatform?t("el-form-item",{attrs:{label:"Api Permission:"}},[t("div",[t("el-checkbox",{attrs:{disabled:""},model:{value:e.checkedOrder,callback:function(t){e.checkedOrder=t},expression:"checkedOrder"}},[e._v("order")]),t("el-checkbox",{model:{value:e.checkPublish,callback:function(t){e.checkPublish=t},expression:"checkPublish"}},[e._v("published "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"If you do not check the relevant permissions, it will affect the use of related functions, please operate with caution",placement:"right"}},[t("i",{staticClass:"el-icon-info"})])],1)],1)]):e._e()],2),t("el-divider"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.connectStoreOpen=!1}}},[e._v("Close")]),""==e.errorMessage?t("el-button",{attrs:{size:"small",type:"primary",disabled:e.ableClick},on:{click:e.connectStoreFn}},[e._v("Connect")]):e._e()],1)],1),t("el-dialog",{attrs:{visible:e.depositDialog.isShow,title:e.depositDialog.title,width:"40%","custom-class":"hosted","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.depositDialog,"isShow",t)}},model:{value:e.depositDialog.loading,callback:function(t){e.$set(e.depositDialog,"loading",t)},expression:"depositDialog.loading"}},[1==e.depositDialog.type?[t("el-divider"),t("p",{staticStyle:{margin:"40px 12%",color:"rgba(127, 127, 127, 1)"}},[e._v(' Are you sure you want to cancel the hosting store "'+e._s(e.depositDialog.name)+'", after you close the hosting, the supplier will not be able to actively quote your order! ')]),t("el-divider"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.depositDialog.isShow=!1}}},[e._v("Close")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.depositStore(e.depositDialog.row,2)}}},[e._v("Sure")])],1)]:e._e(),2==e.depositDialog.type?[t("div",{staticClass:"tips_success"},[t("div",{staticClass:"icon"},[t("i",{staticClass:"el-icon-check"})]),t("div",{staticClass:"txt"},[e._v(" You have successfully hosted the "+e._s(e.depositDialog.name)+" store. After the successful hosting, your supplier will take the initiative to quote for your pending orders! ")])])]:e._e()],2),t("el-dialog",{attrs:{title:"Set entrusted vendor",visible:e.DialogEntrustSet.isShow,width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(t){return e.$set(e.DialogEntrustSet,"isShow",t)}}},[t("el-divider"),t("div",{staticStyle:{padding:"0 25px"}},[t("p",{staticClass:"mg-t-20 mg-b-20"},[e._v("Choose a vendor")]),t("div",{style:{minHeight:e.DialogEntrustSet.inputVisible2?"450px":"200px"}},[t("el-popover",{ref:"popoverCustomer",attrs:{"popper-class":"with-shadow with-shadow2",trigger:"manual",width:"300",placement:"bottom"},on:{hide:e.hidepopoverCustomer},model:{value:e.DialogEntrustSet.inputVisible2,callback:function(t){e.$set(e.DialogEntrustSet,"inputVisible2",t)},expression:"DialogEntrustSet.inputVisible2"}},[t("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",staticStyle:{width:"350px"},attrs:{slot:"reference",size:"medium"},on:{focus:function(t){e.DialogEntrustSet.inputVisible2=!e.DialogEntrustSet.inputVisible2}},nativeOn:{keyup:[function(t){return e.changeCustomerName()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeCustomerName()}]},slot:"reference",model:{value:e.DialogEntrustSet.vendorName,callback:function(t){e.$set(e.DialogEntrustSet,"vendorName",t)},expression:"DialogEntrustSet.vendorName"}}),t("div",{staticClass:"tx-center change-customer"},[t("div",{staticStyle:{height:"280px","overflow-y":"scroll"}},[e.vendorData.length?t("div",{staticClass:"mg-t-10"},e._l(e.vendorData,(function(o,i){return o.vendorId?t("div",{key:i+o.id+o.customerName,staticClass:"text customer-item",class:{active:o.active},on:{click:function(t){return e.selectCustomer(o)}}},[t("div",[t("i",{staticClass:"el-icon-s-custom mg-r-5"}),e._v(e._s(o.vendorName?o.vendorName:"---")+" ")]),t("el-link",{staticStyle:{"font-weight":"normal"},attrs:{type:"primary",underline:!1}},[e._v("Select")])],1):e._e()})),0):t("div",{staticClass:"tx-center"},[e._v("No data")])]),t("el-divider"),""==e.DialogEntrustSet.vendorName||e.vendorData.length>0?[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.openAddVendor}},[t("i",{staticClass:"fa fa-user-plus mg-r-10"}),e._v("Add a new vendor")])]:e._e(),e.DialogEntrustSet.vendorName&&0==e.vendorData.length?[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.openAddVendor}},[t("i",{staticClass:"fa fa-user-plus mg-r-10"}),e._v('Add "'+e._s(e.DialogEntrustSet.vendorName)+'"')])]:e._e()],2)],1)],1)]),t("el-divider"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{attrs:{disabled:e.DialogEntrustSet.loading},on:{click:function(t){e.DialogEntrustSet.isShow=!1,e.DialogEntrustSet.inputVisible2=!1}}},[e._v("Cancel")]),t("el-button",{attrs:{type:"primary",disabled:e.DialogEntrustSet.loading,loading:e.DialogEntrustSet.loading},on:{click:e.saveEntrustSet}},[e._v("Save")])],1)])],1),t("el-dialog",{staticClass:"add-vendor-dialog",attrs:{title:"Add a new vendor",visible:e.addVendorDialog.isShow,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.addVendorDialog,"isShow",t)}}},[t("el-divider"),t("el-row",[t("el-col",{attrs:{span:24}},[t("el-form",[t("el-form-item",{attrs:{label:"Name","label-width":e.addVendorDialog.labelW,required:""}},[t("el-input",{attrs:{placeholder:"Name","auto-complete":"off"},model:{value:e.addVendorDialog.name,callback:function(t){e.$set(e.addVendorDialog,"name",t)},expression:"addVendorDialog.name"}})],1),t("el-form-item",{attrs:{label:"Email","label-width":e.addVendorDialog.labelW}},[t("el-input",{attrs:{placeholder:"Email","auto-complete":"off"},model:{value:e.addVendorDialog.email,callback:function(t){e.$set(e.addVendorDialog,"email",t)},expression:"addVendorDialog.email"}})],1),t("el-form-item",{attrs:{label:"Remark","label-width":e.addVendorDialog.labelW}},[t("el-input",{attrs:{placeholder:"Remark","auto-complete":"off"},model:{value:e.addVendorDialog.remark,callback:function(t){e.$set(e.addVendorDialog,"remark",t)},expression:"addVendorDialog.remark"}})],1)],1)],1)],1),t("el-divider"),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.addVendorDialog.isShow=!1}}},[e._v("Close")]),t("el-button",{attrs:{size:"small",type:"primary",loading:e.addVendorDialog.loading},on:{click:function(t){return e.saveVendor(2)}}},[e._v("Save")])],1)],1),t("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:120}}),t("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.connectStoreLoading,expression:"connectStoreLoading"}],attrs:{title:"shopify store authorization",visible:e.dialogVisibleShopify,width:"30%"},on:{"update:visible":function(t){e.dialogVisibleShopify=t}}},[t("div",[t("el-form",[t("el-form-item",{attrs:{label:"Api Permission:"}},[t("div",[t("el-checkbox",{attrs:{disabled:""},model:{value:e.checkedOrder,callback:function(t){e.checkedOrder=t},expression:"checkedOrder"}},[e._v("order")]),t("el-checkbox",{model:{value:e.checkPublish,callback:function(t){e.checkPublish=t},expression:"checkPublish"}},[e._v("published "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"If you do not check the relevant permissions, it will affect the use of related functions, please operate with caution",placement:"right"}},[t("i",{staticClass:"el-icon-info"})])],1)],1)])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisibleShopify=!1}}},[e._v("close")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.againCertification()}}},[e._v("Reauthorize")])],1)])],1)},s=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"left"},[t("div",{staticClass:"title"},[t("i",{staticClass:"el-icon-s-shop"}),t("h2",[e._v("My Stores")])])])}],a=(o("149f"),o("716a")),r={data(){return{apiUserId:localStorage.getItem("c_apiUserId"),userId:"",vipData:{},num:0,checkedOrder:!0,checkPublish:!0,loading:!1,dialogVisibleShopify:!1,tableHeight:400,reSizeTime:0,pageSizes:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_storeRowsPerPage")?Number(localStorage.getItem("c_storeRowsPerPage")):10,items:[],shopImgList:{shopify:o("52ae"),woo:o("ec03"),shopee:o("94d6")},shopeeShopName:"",shopeeAuthCode:"",authLoading:!1,shopeeWindow:null,total:0,totalPage:0,filterParams:{name:"",status:"",isAuth:""},filterParamsDefault:"{}",connectStoreLoading:!1,connectStoreOpen:!1,shopifyUrl:"",ApiSecretKey:"",ApiKey:"",errorMessage:"",DialogEntrustSet:{isShow:!1,loading:!1,vendorName:"",vendorId:"",inputVisible2:!1,id:""},vendorData:[],addVendorDialog:{isShow:!1,loading:!1,labelW:"120px",name:"",remark:"",email:"",id:""},addVendorDialogDefault:"{}",platformArr:this.$dict.platformArr,activePlatform:"shopify",modiWoo:!1,shopifyWindow:null,depositDialog:{isShow:!1,loading:!1,type:"",title:"",row:{},name:""},depositDialogDefault:"{}",disabled:"",ableClick:!1,shopifyData:{}}},components:{shopCate:a["a"]},watch:{$route:"gotoPage",connectStoreOpen(){this.connectStoreOpen||clearInterval(this.connectStoreWait)}},mounted(){this.addVendorDialogDefault=JSON.stringify(this.addVendorDialog),this.depositDialogDefault=JSON.stringify(this.depositDialog),this.filterParamsDefault=JSON.stringify(this.filterParams),this.filterParams.isAuth=this.$route.query.isAuth?this.$route.query.isAuth:"",this.getItem(),this.getVendor(),this.getVipDetail(),this.getStatusNews(),this.$route.params.add&&(this.$route.params.add=!1,this.openConnectStore(),this.$route.params.val&&(this.shopifyUrl=this.$route.params.val))," "!==document.domain&&window.addEventListener("message",e=>{e.data&&"string"===typeof e.data&&(console.log(e.data),this.messageCallback(e.data))})},beforeDestroy(){},methods:{messageCallback(e){if(e.indexOf("=||=")>-1){const t=e.split("=||=");this.shopeeAuthCode=t[0];const o={code:t[0],name:this.shopeeShopName.trim(),platformId:4,shop_id:t[1]};this.$apiCall("api.ShopifyAccount.authorizationErp",o,e=>{9999==e.ErrorCode?(this.getItem(),this.$message.success(e.Message),this.shopeeWindow&&this.shopeeWindow.close(),this.connectStoreOpen=!1):this.$message.error(e.Message)})}},getStatusNews(){this.$apiCall("api.User.checkLoginStatusNews",{},e=>{if(9999==e.ErrorCode){console.log(e,"1111");let t=e.Data.Results;t.isAutoJump&&1==t.isAutoJump?this.disabled="disabled":this.disabled=""}else this.$message.error(e.Message)})},authShopee(){let e={platform:4,shopName:this.shopeeShopName.trim()};this.authLoading=!0,this.$apiCall("api.ShopifyAccount.addOtherAccount",e,e=>{this.authLoading=!1,9999==e.ErrorCode?(e.Data.Results.url?this.shopeeWindow=window.open(e.Data.Results.url,"popup","width = 600, height = 600"):this.$message.error("error!"),console.log(this.shopeeWindow)):this.$message.error(e.Message)})},getVipDetail(){setTimeout(()=>{this.userId=this.$store.state.userInfo.id,this.$apiCall("api.Admin.getVipDetail",{userId:this.userId},e=>{9999==e.ErrorCode&&(this.vipData=e.Data.Results)})},500)},selectPlatform(e,t){t&&(this.activePlatform=e)},openAddVendor(){this.addVendorDialog=JSON.parse(this.addVendorDialogDefault),this.addVendorDialog.name=this.vendorName,this.addVendorDialog.isShow=!0},saveVendor(e){if(!this.addVendorDialog.name)return void this.$elementMessage("Customer name required","error");this.addVendorDialog.loading=!0;let t="api.Relationship.addByCustomer",o={name:this.addVendorDialog.name,email:this.addVendorDialog.email,remark:this.addVendorDialog.remark};this.$apiCall(t,o,e=>{this.addVendorDialog.loading=!1,9999==e.ErrorCode?(this.DialogEntrustSet.vendorName="",this.addVendorDialog.isShow=!1,this.$elementMessage("Customers successfully added","success"),this.getVendor()):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},changeCustomerName(){let e=500;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.$showLoading(),this.$apiCall("api.Relationship.findByCustomer",{name:this.DialogEntrustSet.vendorName},e=>{this.$hideLoading(),9999==e.ErrorCode?this.vendorData=e.Data.Results:(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},e)},getVendor(){this.$apiCall("api.Relationship.findByCustomer",{},e=>{"9999"==e.ErrorCode?this.vendorData=e.Data.Results:(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},selectCustomer(e){this.DialogEntrustSet.vendorName=e.vendorName,this.DialogEntrustSet.vendorId=e.vendorId,setTimeout(()=>{this.DialogEntrustSet.inputVisible2=!1},100)},hidepopoverCustomer(){setTimeout(()=>{this.DialogEntrustSet.inputVisible2=!1},100)},saveEntrustSet(){let e={id:this.DialogEntrustSet.id,vendorId:this.DialogEntrustSet.vendorId};this.$apiCall("api.ShopifyAccount.bindVendor",e,e=>{this.DialogEntrustSet.loading=!1,9999==e.ErrorCode?(this.$message({message:"Successfully set",type:"success"}),this.DialogEntrustSet.isShow=!1,this.DialogEntrustSet.inputVisible2=!1,this.getItem(!0)):this.$elementMessage(e.Message,"error")})},entrustedSet(e){this.DialogEntrustSet.isShow=!0,this.DialogEntrustSet.vendorName="",this.DialogEntrustSet.vendorId="",this.DialogEntrustSet.id=e.id,setTimeout(()=>{this.$refs.saveTagInput.$refs.input.focus()},300)},entrustedRemove(e){this.$confirm("Are you sure you want to remove entrusted vendor? ","",{confirmButtonText:"Remove",cancelButtonText:"Cancel",type:"error"}).then(()=>{this.$apiCall("api.ShopifyAccount.unbindVendor",{id:e.id},e=>{9999==e.ErrorCode?(this.$message({message:"Successfully remove",type:"success"}),this.getItem(!0)):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})}).catch(()=>{})},againCertification(){this.shopifyWindow=window.open("/blank.html","shopifyAccount-window",void 0,!0),this.$showLoading();let e={},t=[];t[0]=this.checkPublish?1:"",this.activePlatform="shopify",e={shopUrl:this.shopifyData.subShopUrl,getAuth:1,fromList:1,platform:this.shopifyData.platform,authType:t},this.$apiCall("api.ShopifyAccount.addOtherAccount",e,e=>{if(this.dialogVisibleShopify=!1,"9999"==e.ErrorCode){if("shopify"==this.activePlatform&&(this.shopifyWindow.location=e.Data.Results,this.shopifyUrl=this.shopifyData.subShopUrl,this.connectConfirmStart()),"lazada"==this.activePlatform){let t=e.Data.Results.state;this.shopifyWindow.location=e.Data.Results.url,this.connectConfirmStart(t)}}else this.$elementMessage(e.Message,"error")})},connectStoreAgain(e){if(2!=e.platform)return this.shopifyData=e,this.dialogVisibleShopify=!0,!1;if(2==e.platform)return this.activePlatform="woo",void this.openConnectStore("woo",e.shopUrl);this.$showLoading();let t={};if("1"==e.platform){let o=[];o[0]=this.checkPublish?1:"",this.activePlatform="shopify",t={shopUrl:e.subShopUrl,getAuth:1,fromList:1,platform:e.platform,authType:o}}else"3"==e.platform&&(this.activePlatform="lazada",t={ati:this.$getCookie("_ati"),platform:e.platform});this.$apiCall("api.ShopifyAccount.addOtherAccount",t,t=>{if(this.$hideLoading(),"9999"==t.ErrorCode){if("shopify"==this.activePlatform&&(this.shopifyWindow.location=t.Data.Results,this.shopifyUrl=e.subShopUrl,this.connectConfirmStart()),"lazada"==this.activePlatform){let e=t.Data.Results.state;this.shopifyWindow.location=t.Data.Results.url,this.connectConfirmStart(e)}}else this.$elementMessage(t.Message,"error")})},connectStoreConfirmFn(){location.reload()},connectConfirmStart(e){this.shopifyWindow.closed&&(this.shopifyWindow.close(),this.connectStoreLoading=!1,clearInterval(this.connectStoreWait));let t={};"shopify"==this.activePlatform&&(t.shopUrl=this.shopifyUrl),"lazada"==this.activePlatform&&(t.state=e),this.connectStoreWait=setInterval(()=>{this.$apiCall("api.ShopifyAccount.getShopAuthStatus",t,e=>{"9999"==e.ErrorCode?1==e.Data.Results.status?(clearInterval(this.connectStoreWait),this.shopifyWindow.close(),this.connectStoreLoading=!1,this.connectStoreOpen=!1,this.getItem(),this.$message({message:"Successful store authorization",type:"success",duration:0,showClose:!0})):2==e.Data.Results.status&&(this.shopifyWindow.close(),this.connectStoreLoading=!1,this.connectStoreOpen=!1,this.$elementMessage(e.Data.Results.errorMessage,"error"),clearInterval(this.connectStoreWait)):this.$elementMessage(e.Message,"error")})},1e3)},connectStoreFn(){let e={};if(console.log(this.activePlatform),"shopify"==this.activePlatform){if(!this.shopifyUrl)return void this.$elementMessage("Please enter Shopify store URL","error");let t=[];t[0]=this.checkPublish?1:"",e={shopUrl:this.shopifyUrl,platform:1,authType:t}}else if("woo"==this.activePlatform){if(!this.shopifyUrl)return void this.$elementMessage("Please enter Woocommerce store URL","error");e={shopUrl:this.shopifyUrl,apiKey:this.ApiKey,apiSecretKey:this.ApiSecretKey,ivc:localStorage.getItem("c_ivc")?localStorage.getItem("c_ivc"):"",utmSource:localStorage.getItem("c_utm"),platform:2}}else if("lazada"==this.activePlatform)e={platform:3,ati:this.$getCookie("_ati")};else if("shopee"==this.activePlatform)return e={platform:4},void this.$message.error("Please fulfill the store info!");this.connectStoreLoading=!0,this.$apiCall("api.ShopifyAccount.addOtherAccount",e,e=>{if("9999"==e.ErrorCode){if("shopify"==this.activePlatform&&("disabled"==this.disabled?(console.log(11114),this.connectStoreLoading=!1,this.connectStoreOpen=!1,this.getItem(),this.$message({message:"Successful store authorization",type:"success",duration:0,showClose:!0})):(this.shopifyWindow=window.open(e.Data.Results),this.connectConfirmStart())),"lazada"==this.activePlatform){let t=e.Data.Results.state;this.shopifyWindow=window.open(e.Data.Results.url),this.connectConfirmStart(t)}"woo"==this.activePlatform&&(this.getItem(),this.connectStoreOpen=!1,this.$elementMessage("add a new store success","success"))}else this.connectStoreLoading=!1,this.$elementMessage(e.Message,"error")})},openConnectStore(e,t){clearInterval(this.connectStoreWait),this.modiWoo=!1,this.connectStoreOpen=!0,this.connectStoreLoading=!1,this.activePlatform=this.$route.params.platform?this.$route.params.platform:"shopify",this.shopifyUrl="",this.errorMessage="",this.ApiKey=this.ApiSecretKey="","woo"==e&&(this.activePlatform="woo",this.shopifyUrl=t,this.modiWoo=!0)},delStore(e){this.$confirm("Are you sure you want to delete it? ","",{confirmButtonText:"Delete",cancelButtonText:"Discard",type:"error"}).then(()=>{this.$apiCall("api.Invoice.deleteStore",{shopId:e.id},e=>{9999==e.ErrorCode?(this.$message({message:"Successfully delete",type:"success"}),this.getItem(!0)):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})}).catch(()=>{})},changeDeposit(e){console.log(e),1==e.isDeposit?(this.depositDialog=JSON.parse(this.depositDialogDefault),this.depositDialog.type=1,this.depositDialog.title="Close",this.depositDialog.row=e,this.depositDialog.name=e.shopName,this.depositDialog.isShow=!0):this.depositStore(e,1)},depositStore(e,t){2==t&&(this.depositDialog.loading=!0),this.$apiCall("api.ShopifyAccount.changeDeposit",{id:e.id,isDeposit:t},o=>{2==t&&(this.depositDialog.loading=!1),9999==o.ErrorCode?(e.isDeposit=t,1==t?(this.depositDialog=JSON.parse(this.depositDialogDefault),this.depositDialog.type=2,this.depositDialog.title="",this.depositDialog.name=e.shopName,this.depositDialog.isShow=!0):(this.depositDialog.isShow=!1,this.$message({message:"Closed successfully",type:"success"}))):(this.$elementMessage(o.Message,"error"),"1002"!=o.ErrorCode&&"1003"!=o.ErrorCode||this.$userFailure())})},clearFilter(){this.filterParams=JSON.parse(this.filterParamsDefault),1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},filterGetItem(){1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},getItem(e){this.loading=!0,this.$apiCall("api.Invoice.findStores",{page:this.page,rowsPerPage:this.rowsPerPage,shopName:this.filterParams.name,authStatus:this.filterParams.isAuth},t=>{this.loading=!1,9999==t.ErrorCode?(this.items=t.Data.Results,this.total=Number(t.Data.Pagination.totalCount),this.totalPage=Number(t.Data.Pagination.totalPage),this.$getTableHeight(this),e||(this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0)):this.$message({message:t.Message,type:"error"})})},toPage(e){e!=this.$route.query.page&&this.$router.push({query:{page:e}})},changePageSize(e){this.rowsPerPage=e,localStorage.setItem("c_storeRowsPerPage",e),this.getItem()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()}}},l=r,n=(o("7a7d"),o("e607")),c=Object(n["a"])(l,i,s,!1,null,"72e11c56",null);t["default"]=c.exports},6247:function(e,t,o){},"716a":function(e,t,o){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"shop"},[1==e.items.platform?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Shopify",placement:"left"}},[t("img",{staticClass:"shopImg",attrs:{src:o("340e")}})]):2==e.items.platform?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Woocommerce",placement:"left"}},[t("img",{staticClass:"shopImg",attrs:{src:o("7e46")}})]):3==e.items.platform?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Lazada",placement:"left"}},[t("img",{staticClass:"shopImg",attrs:{src:o("4d6b")}})]):4==e.items.platform?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Shopee",placement:"left"}},[t("img",{staticClass:"shopImg",attrs:{src:o("e74a")}})]):e._e()],1)},s=[],a={props:["items"],data(){return{}},methods:{},components:{}},r=a,l=(o("c33f"),o("e607")),n=Object(l["a"])(r,i,s,!1,null,"7d79ad08",null);t["a"]=n.exports},"7a7d":function(e,t,o){"use strict";o("d516")},"7e46":function(e,t,o){e.exports=o.p+"img/woo_icon.bbaca118.png"},"94d6":function(e,t,o){e.exports=o.p+"img/shopee.58ed2826.jpg"},c33f:function(e,t,o){"use strict";o("6247")},d516:function(e,t,o){},e74a:function(e,t,o){e.exports=o.p+"img/shopee_icon.c6765767.png"},ec03:function(e,t,o){e.exports=o.p+"img/woo.4d233337.jpg"}}]);
//# sourceMappingURL=stores.b955797c.js.map