(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ListHistory"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("a630"),a("fb6a"),a("b0c0"),a("d3b7"),a("25f0"),a("3ca3");var s=a("6b75");function n(t,e){if(t){if("string"===typeof t)return Object(s["a"])(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(s["a"])(t,e):void 0}}},"25e0":function(t,e,a){"use strict";a("44e9")},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var s=a("6b75");function n(t){if(Array.isArray(t))return Object(s["a"])(t)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function i(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var r=a("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t){return n(t)||i(t)||Object(r["a"])(t)||l()}},"44e9":function(t,e,a){},"4df4":function(t,e,a){"use strict";var s=a("0366"),n=a("7b0b"),i=a("9bdd"),r=a("e95a"),l=a("50c4"),o=a("8418"),c=a("35a1");t.exports=function(t){var e,a,u,d,p,f,m=n(t),g="function"==typeof this?this:Array,h=arguments.length,b=h>1?arguments[1]:void 0,v=void 0!==b,y=c(m),_=0;if(v&&(b=s(b,h>2?arguments[2]:void 0,2)),void 0==y||g==Array&&r(y))for(e=l(m.length),a=new g(e);e>_;_++)f=v?b(m[_],_):m[_],o(a,_,f);else for(d=y.call(m),p=d.next,a=new g;!(u=p.call(d)).done;_++)f=v?i(d,b,[u.value,_],!0):u.value,o(a,_,f);return a.length=_,a}},"66f6":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"contentpanel listHistory"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody mg-b-20"},[a("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[a("el-col",{attrs:{span:24}},[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"All",name:"0"}},[a("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),a("el-tab-pane",{attrs:{label:"Waiting",name:"1"}},[a("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),a("el-tab-pane",{attrs:{label:"Processing",name:"2"}},[a("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,action:"2",doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),a("el-tab-pane",{attrs:{label:"Completed",name:"3"}},[a("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),a("el-tab-pane",{attrs:{label:"Failed",name:"4"}},[a("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,action:"4",doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1)],1)],1)],1),t.tableData.length?a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[a("div",{staticStyle:{"margin-bottom":"30px"}},[a("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSizes,"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1)],1)],1)],1)])},i=[],r=(s("b0c0"),s("a9e3"),s("159b"),s("2909")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.tableData.length>0?[t.action&&"4"!=t.action?a("div",{staticClass:"d-flex justify-content-between headView"},[this.doneCnt/this.allCnt*100>=0&&this.doneCnt/this.allCnt*100<=100?a("div",{staticClass:"d-flex"},[a("span",{staticClass:"mg-r-10"},[t._v("Upload Progress:")]),a("el-progress",{staticStyle:{width:"500px"},attrs:{"stroke-width":18,percentage:parseInt(this.doneCnt/this.allCnt*100)}})],1):t._e(),t.action&&"4"!=t.action?t._e():a("div",{staticClass:"d-flex"},[a("div",{staticClass:"d-flex"},[t.ids.length?a("div",[t._v(t._s(t.ids.length)+" Selected")]):t._e(),a("el-button",{staticClass:"del",attrs:{type:"primary"},on:{click:function(e){return t.delItems()}}},[t._v("Delete")])],1)])]):a("div",{staticClass:"d-flex headView",staticStyle:{"justify-content":"flex-end"}},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"d-flex"},[t.ids.length?a("div",[t._v(t._s(t.ids.length)+" Selected")]):t._e(),a("el-button",{staticClass:"del",staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.delItems()}}},[t._v("Delete")])],1)])])]:t._e(),a("el-table",{ref:"listTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[t.action&&"4"!=t.action?t._e():a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"img",label:"Img",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.product?a("el-image",{staticClass:"list-img",attrs:{src:e.row.product.mainImg,"preview-src-list":[e.row.product.mainImg],fit:"cover"}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"name",label:"Name",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.product?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.product.name,placement:"top"}},[a("span",{staticClass:"tx-ellipsis2",staticStyle:{"word-break":"break-all","font-size":"12px"}},[t._v(t._s(e.row.product.name))])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"sku",label:"Sku",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.stocks?t._l(e.row.stocks,(function(e){return a("div",{key:e.id},[t._v(" "+t._s(e.sku)+" ")])})):void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"shopname",label:"Store"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.shop?[t._v(" "+t._s(e.row.shop.shopName)+" ")]:void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"gdprice",label:"Cost Price"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.stocks?t._l(e.row.stocks,(function(e){return a("div",{key:e.id},[a("span",{staticStyle:{"font-size":"13px"}},[t._v("USD")]),t._v(" "+t._s(e.costPrice)+" ")])})):void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"price",label:"You Price"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.stocks?t._l(e.row.stocks,(function(s){return a("div",{key:s.id},[s.yourPrice?a("span",[a("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(e.row.shop.currency?e.row.shop.currency:"USD"))]),t._v(" "+t._s(s.yourPrice.price)+" ")]):a("span",[t._v("---")])])})):void 0}}],null,!0)}),a("el-table-column",{attrs:{prop:"state",label:"State"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("listStatus")(e.row.status))+" ")]}}])}),"4"==t.action?a("el-table-column",{attrs:{prop:"fail",label:"Fail reason"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.extra?[t._v(" "+t._s(e.row.extra.message)+" ")]:void 0}}],null,!0)}):t._e(),a("el-table-column",{attrs:{prop:"time",label:"Start Time"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.moment(1e3*e.row.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"action",label:"Action"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return t.openDetail(e.row.id)}}},[t._v(" Detail")])],1),"2"!=e.row.status?a("div",[a("el-link",{attrs:{type:"danger"},on:{click:function(a){return t.delItems(e.row)}}},[t._v("Delete")])],1):t._e(),"3"==e.row.status?a("div",[a("el-link",{attrs:{type:"success",href:e.row.productUrl,target:"_blank"}},[t._v(" Open in Shopify")])],1):t._e()]}}])})],1),a("el-dialog",{attrs:{visible:t.ListDetail,title:"Product Message","close-on-click-modal":!1,width:"45%"},on:{"update:visible":function(e){t.ListDetail=e}}},[t.newList.product?a("div",{staticClass:"d-flex",staticStyle:{"align-items":"flex-start"}},[a("div",{staticClass:"listItem"},[a("el-image",{staticStyle:{width:"250px",height:"250px"},attrs:{src:t.newList.product.mainImg,fit:"cover"}})],1),a("div",{staticClass:"detail"},[a("div",{staticClass:"name"},[t._v(" "+t._s(t.newList.product.name)+" ")]),a("div",[a("span",[t._v("State: ")]),t._v(t._s(t._f("listStatus")(t.newList.status)))]),a("div",[a("span",[t._v("Store: ")]),t._v(t._s(t.newList.shop.shopName))]),a("div",[a("span",[t._v("Start Time: ")]),t._v(t._s(t.moment(1e3*t.newList.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")]),t.newList.extra.message?a("div",[a("span",[t._v("Fail Reason: ")]),t._v(t._s(t.newList.extra.message)+" ")]):t._e(),a("div",{staticStyle:{width:"100%"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.newList.stocks,border:""}},[a("el-table-column",{attrs:{label:"SKU",prop:"sku"}}),a("el-table-column",{attrs:{label:"Cost Price"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"font-size":"13px"}},[t._v("USD")]),t._v(" "+t._s(e.row.costPrice)+" ")]}}],null,!1,2565226068)}),a("el-table-column",{attrs:{label:"You Price"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(t.newList.shop.currency?t.newList.shop.currency:"USD"))]),t._v(" "+t._s(e.row.yourPrice.price)+" ")]}}],null,!1,453076805)})],1)],1)])]):t._e()])],2)},o=[],c={props:["action","status","tableData","taskList","allCnt","doneCnt"],data:function(){return{newList:{},ListDetail:!1,timer:null,checked:!1,AllChecked:!1,ids:[]}},filters:{listStatus:function(t){switch(t){case"1":return"Waiting";case"2":return"Processing";case"3":return"Succeeded";default:return"Failed"}}},mounted:function(){},methods:{openDetail:function(t){var e=this;this.newList=[],this.tableData.forEach((function(a){t==a.id&&(e.newList=a,e.ListDetail=!0)}))},handleSelectionChange:function(t){var e=this;this.timer=null,this.ids=[],t.forEach((function(t){e.ids.push(t.id)}))},delItems:function(t){var e=this;if(t&&this.ids.push(t.id),0==this.ids.length)return this.$elementMessage("Select the task","error"),!1;this.$confirm("Do you want to delete tish task?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){e.$apiCall("api.Product.delImportTaskDetail",{ids:e.ids},(function(t){9999==t.ErrorCode?(e.ids=[],e.allChecked=!1,e.$emit("getItem"),e.$elementMessage("Delete Completed","success")):e.$elementMessage(t.Message,"error")}))})).catch((function(){return e.ids=[],!1}))}},components:{}},u=c,d=(s("25e0"),s("2877")),p=Object(d["a"])(u,l,o,!1,null,"bebd73b2",null),f=p.exports,m={data:function(){return{loading:!1,activeName:"2",status:"2",pageSizes:[12,24,48],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_importPerPage")?Number(localStorage.getItem("c_importPerPage")):12,total:0,totalPage:0,doneCnt:0,allCnt:0,tableData:[],taskList:[]}},watch:{$route:"gotoPage"},mounted:function(){var t=this;this.getImportTaskDetail(),this.getImportTask(),clearInterval(this.timer),this.timer=setInterval((function(){t.taskList.length>0?t.getImportTask():(clearInterval(t.timer),t.timer=null)}),1e3)},beforeDestroy:function(){clearInterval(this.timer),this.timer=null},methods:{getImportTask:function(){var t=this;this.$apiCall("api.Product.findsImportTask",{},(function(e){if(9999==e.ErrorCode){t.taskList=e.Data.Results;var s=0;t.taskList.forEach((function(e){t.doneCnt=s+=Number(e.doneCnt),t.allCnt=s+=Number(e.allCnt)})),t.getImportTaskDetail(a)}})),this.taskList=Object(r["a"])(this.taskList)},toPage:function(t){t!=this.$route.query.page?this.$router.push({query:{page:t}}):this.getImportTaskDetail()},changePageSize:function(t){this.rowsPerPage=t,localStorage.setItem("c_importPerPage",t),this.getImportTaskDetail()},gotoPage:function(){this.page=this.$route.query.page?this.$route.query.page:1,this.getImportTaskDetail()},getImportTaskDetail:function(t){var e=this;t||(this.loading=!0),this.$apiCall("api.Product.findsImportTaskDetail",{status:"0"==this.status?null:this.status,page:this.page,rowsPerPage:this.rowsPerPage},(function(a){setTimeout((function(){e.loading=!1}),500),9999==a.ErrorCode?t?e.tableData.length!=a.Data.Results.length&&(e.tableData=a.Data.Results):(e.tableData=a.Data.Results,e.total=Number(a.Data.Pagination.totalCount),e.totalPage=Number(a.Data.Pagination.totalPage),e.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0):e.$elementMessage(a.Message,"error")}))},handleClick:function(t,e){var a=this;this.status==t.name?(this.loading=!0,setTimeout((function(){a.loading=!1}),500)):(this.status=t.name,this.getImportTaskDetail())}},components:{ListTable:f}},g=m,h=Object(d["a"])(g,n,i,!1,null,"bdfddb74",null);e["default"]=h.exports},"6b75":function(t,e,a){"use strict";function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}a.d(e,"a",(function(){return s}))},"9bdd":function(t,e,a){var s=a("825a"),n=a("2a62");t.exports=function(t,e,a,i){try{return i?e(s(a)[0],a[1]):e(a)}catch(r){throw n(t),r}}},a630:function(t,e,a){var s=a("23e7"),n=a("4df4"),i=a("1c7e"),r=!i((function(t){Array.from(t)}));s({target:"Array",stat:!0,forced:r},{from:n})},fb6a:function(t,e,a){"use strict";var s=a("23e7"),n=a("861d"),i=a("e8b5"),r=a("23cb"),l=a("50c4"),o=a("fc6a"),c=a("8418"),u=a("b622"),d=a("1dde"),p=d("slice"),f=u("species"),m=[].slice,g=Math.max;s({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var a,s,u,d=o(this),p=l(d.length),h=r(t,p),b=r(void 0===e?p:e,p);if(i(d)&&(a=d.constructor,"function"!=typeof a||a!==Array&&!i(a.prototype)?n(a)&&(a=a[f],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return m.call(d,h,b);for(s=new(void 0===a?Array:a)(g(b-h,0)),u=0;h<b;h++,u++)h in d&&c(s,u,d[h]);return s.length=u,s}})}}]);
//# sourceMappingURL=ListHistory.3284c25a.js.map