(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shopify-orders"],{"06c5":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));i("a630"),i("fb6a"),i("b0c0"),i("d3b7"),i("25f0"),i("3ca3");var a=i("6b75");function s(t,e){if(t){if("string"===typeof t)return Object(a["a"])(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Object(a["a"])(t,e):void 0}}},"4df4":function(t,e,i){"use strict";var a=i("0366"),s=i("7b0b"),o=i("9bdd"),l=i("e95a"),r=i("50c4"),n=i("8418"),c=i("35a1");t.exports=function(t){var e,i,d,u,h,p,g=s(t),f="function"==typeof this?this:Array,m=arguments.length,v=m>1?arguments[1]:void 0,y=void 0!==v,b=c(g),S=0;if(y&&(v=a(v,m>2?arguments[2]:void 0,2)),void 0==b||f==Array&&l(b))for(e=r(g.length),i=new f(e);e>S;S++)p=y?v(g[S],S):g[S],n(i,S,p);else for(u=b.call(g),h=u.next,i=new f;!(d=h.call(u)).done;S++)p=y?o(u,v,[d.value,S],!0):d.value,n(i,S,p);return i.length=S,i}},"4f6d":function(t,e,i){},"6b75":function(t,e,i){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}i.d(e,"a",(function(){return a}))},"8eb6":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"contentpanel orders-page",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)"}},[i("div",{ref:"pageHeader",staticClass:"pagetitle"},[i("div",{staticClass:"left"},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-shopify"}),i("h2",[t._v(" "+t._s(1==t.isManage?"All Unfulfilled Shopify Orders":"All Hidden Shopify Orders")+" "),i("em",{staticStyle:{"font-size":"22px"}},[t._v("("+t._s(this.tableData.length)+")")])])])]),i("div",{staticClass:"right"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.exportDialogOpen}},[i("i",{staticClass:"fa fa-download"}),t._v(t._s(t.$t("Export"))+" ")]),t.updateTime&&t.updateTime>t.now?[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"The update process has started, it will take a while to finish.",placement:"bottom"}},[i("el-button",{staticStyle:{color:"#FFFFFF","background-color":"#aeb5e2","border-color":"#aeb5e2"},attrs:{type:"primary",size:"medium"}},[i("i",{staticClass:"el-icon-refresh"}),t._v(t._s(t.$t("Update Order"))+" ")])],1)]:[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Use this button to update your Order List if missing orders.The process may take a while to finish.",placement:"bottom"}},[i("el-button",{attrs:{disabled:!!(t.updateTime&&t.updateTime>t.now),type:"primary",size:"medium",loading:t.updateOrderLoading},on:{click:t.updateOrder}},[i("i",{staticClass:"el-icon-refresh"}),t._v(t._s(t.$t("Update Order"))+" ")])],1)],i("el-button",{attrs:{type:"success"},on:{click:t.openAutomaticSetting}},[i("i",{staticClass:"el-icon-setting el-icon--right"}),t._v(" "+t._s(t.$t("Automatic dispatch orders setting"))+" "),t.ruleCnt?i("span",[t._v("("+t._s(t.ruleCnt)+")")]):t._e()])],2)]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.selectLoading,expression:"selectLoading"}],staticClass:"pagebody"},[i("div",{staticClass:"design-tab-content"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"mg-r-10"},[i("el-input",{attrs:{size:"small","prefix-icon":"el-icon-search",placeholder:"Filter orders",clearable:""},on:{input:t.getCodeName,clear:t.clearFilterItems},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getCodeName(e)}},model:{value:t.codeName,callback:function(e){t.codeName=e},expression:"codeName"}})],1),i("el-button-group",[i("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[i("el-radio-group",{on:{change:function(e){return t.filterItems("dispatch")}},model:{value:t.dispatchStatus,callback:function(e){t.dispatchStatus=e},expression:"dispatchStatus"}},t._l(t.dispatchArr,(function(e,a){return i("el-radio",{key:a,attrs:{label:a}},[t._v(t._s(e))])})),1),3==t.dispatchStatus&&t.supplierList.length?i("div",[i("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v(t._s(t.$t("All vendors")))]),i("div",{staticStyle:{margin:"-8px 0 0","padding-left":"22px"}},[t._v("("+t._s(t.$t("You could select multiple vendors"))+")")]),i("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedSupplier,callback:function(e){t.checkedSupplier=e},expression:"checkedSupplier"}},t._l(t.supplierList,(function(e){return"999e"!=e.id?i("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.vendorName))]):t._e()})),1)],1):t._e(),i("div",[i("el-button",{attrs:{type:"text",disabled:!t.dispatchStatus},on:{click:function(e){return t.clearFilterItems("dispatch")}}},[t._v(t._s(t.$t("Clear")))])],1),i("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("Dispatch Status"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),i("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[i("el-checkbox-group",{on:{change:function(e){return t.filterItems("store")}},model:{value:t.shopifyStore,callback:function(e){t.shopifyStore=e},expression:"shopifyStore"}},t._l(t.storeList,(function(e){return i("el-checkbox",{key:e.shopifyAccountId,attrs:{label:e.shopifyAccountId}},[t._v(t._s(e.store))])})),1),i("div",[i("el-button",{attrs:{type:"text",disabled:!t.shopifyStore.length},on:{click:function(e){return t.clearFilterItems("store")}}},[t._v(t._s(t.$t("Clear")))])],1),i("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("Shopify Stores"),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),i("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[i("el-radio-group",{on:{change:function(e){return t.filterItems("date")}},model:{value:t.timeFilter,callback:function(e){t.timeFilter=e},expression:"timeFilter"}},t._l(t.dateArr,(function(e,a){return i("el-radio",{key:a,attrs:{label:a}},[t._v(t._s(e))])})),1),6==t.timeFilter?i("div",[i("el-date-picker",{attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"Start","end-placeholder":"End"},on:{change:t.dateChange},model:{value:t.filterDate,callback:function(e){t.filterDate=e},expression:"filterDate"}})],1):t._e(),i("div",[i("el-button",{attrs:{type:"text",disabled:!t.timeFilter},on:{click:function(e){return t.clearFilterItems("date")}}},[t._v(t._s(t.$t("Clear")))])],1),i("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("Date Ranges"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),i("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[i("el-checkbox-group",{on:{change:function(e){return t.filterItems("fulfill")}},model:{value:t.fulfillStatus,callback:function(e){t.fulfillStatus=e},expression:"fulfillStatus"}},[i("el-checkbox",{attrs:{label:"1"}},[t._v(t._s(t.$t("Unfulfilled")))]),i("el-checkbox",{attrs:{label:"2"}},[t._v(t._s(t.$t("Partially fulfilled")))])],1),i("div",[i("el-button",{attrs:{type:"text",disabled:!t.fulfillStatus.length},on:{click:function(e){return t.clearFilterItems("fulfill")}}},[t._v(t._s(t.$t("Clear")))])],1),i("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("Fulfillment Status"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),i("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[i("el-radio-group",{on:{change:function(e){return t.filterItems("sort")}},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},t._l(t.sortArr,(function(e,a){return i("el-radio",{key:a,attrs:{label:a}},[t._v(t._s(e))])})),1),i("div",[i("el-button",{attrs:{type:"text",disabled:!t.sortBy},on:{click:function(e){return t.clearFilterItems("sort")}}},[t._v(t._s(t.$t("Clear")))])],1),i("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("SortBy"))),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1)],1),i("div",{staticStyle:{"margin-left":"auto","margin-right":"15px"}},[1==t.isManage?i("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.filterItems2(2)}}},[t._v(t._s(t.$t("Show hidden orders")))]):t._e(),2==t.isManage?i("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.filterItems2(1)}}},[t._v(t._s(t.$t("Show all valid orders")))]):t._e()],1)],1),i("div",{ref:"sortWrap",staticClass:"mg-t-20"},[t.dispatchStatus?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("dispatch")}}},[t._v(" "+t._s(t.dispatchArr[t.dispatchStatus])+" "),3==t.dispatchStatus&&t.checkedSupplierName?i("span",[t._v(" "+t._s(t.checkedSupplierName)+" ")]):t._e()]):t._e(),t.shopifyStore.length?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("store")}}},[t._v(t._s(t.shopifyStoreName))]):t._e(),t.timeFilter?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:!t.isShowFilter},on:{close:function(e){return t.clearFilterItems("date")}}},[t._v(" "+t._s(t.dateArr[t.timeFilter])+" "),6==t.timeFilter&&t.filterDate.length?i("span",[t._v(" "+t._s(t.filterDate[0])+"--"+t._s(t.filterDate[1])+" ")]):t._e()]):t._e(),t.fulfillStatus.length?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("fulfill")}}},[t._v(" "+t._s(1==t.fulfillStatus[0]?"Unfulfilled":"Partially fulfilled")),t.fulfillStatus.length>1?i("span",[t._v(","+t._s(1==t.fulfillStatus[1]?"Unfulfilled":"Partially fulfilled"))]):t._e()]):t._e(),t.sortBy?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("sort")}}},[t._v(t._s(t.sortArr[t.sortBy]))]):t._e()],1),i("div",{staticClass:"invoice-list mg-t-20"},[i("ul",{staticClass:"invoice-header"},[i("li",{staticClass:"invoice-item",staticStyle:{width:"63px","max-width":"63px","padding-left":"24px","border-left":"0",position:"relative"}},[t.checkLoading?i("i",{staticClass:"el-icon-loading",staticStyle:{position:"absolute",left:"5px",top:"8px"}}):t._e(),i("el-checkbox",{on:{change:t.checkedAll},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1),i("li",{staticClass:"invoice-item"},[i("a",{attrs:{href:"javascript:;"},on:{click:t.expandChange}},[i("i",{class:t.expandAll?"el-icon-minus":"el-icon-plus"})]),t._v(" Order ID ")]),i("li",{staticClass:"invoice-item"},[t._v("Shopify store")]),i("li",{staticClass:"invoice-item"},[t._v("Date")]),i("li",{staticClass:"invoice-item"},[t._v("Customer")]),i("li",{staticClass:"invoice-item tx-right pd-r-15"},[t._v(t._s(t.$t("Shopify order total")))]),i("li",{staticClass:"invoice-item"},[t._v("Fulfillment")]),i("li",{staticClass:"invoice-item"},[t._v("Items")])]),t.tableData?i("div",{ref:"treeWrap",staticClass:"tree-wrap",staticStyle:{"overflow-y":"scroll"},style:{height:t.tableHeight>0?t.tableHeight+"px":"0"}},[i("el-tree",{ref:"treeData",attrs:{props:t.props,data:t.tableData,"show-checkbox":"","node-key":"id","default-expand-all":t.expandAll,"default-expanded-keys":t.expandedKeys,"default-checked-keys":t.defaultChecked},on:{"node-expand":t.handleExpandChange,"check-change":t.handleCheckChange,check:t.handleCheck},scopedSlots:t._u([{key:"default",fn:function(e){e.node;var a=e.data;return i("div",{staticClass:"custom-tree-node",attrs:{id:"customTreeNode"+a.id}},[a.span?i("div",{staticClass:"table_info_node table_info_top"},[i("div",{staticClass:"table_info_item"},[a.items&&a.items.length?i("span",{staticStyle:{"font-size":"12px",cursor:"pointer"}},[i("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"700"}}),t._v(" "+t._s(a.codeName)+" ")]):i("span",[i("i",{staticClass:"el-icon-plus",staticStyle:{opacity:"0"}}),t._v(" "+t._s(a.codeName)+" ")])]),i("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[t._v(t._s(a.store))]),i("div",{staticClass:"table_info_item"},[t._v(" "+t._s(t.moment(a.timeCreated).format("ll [at] LTS"))+" ")]),i("div",{staticClass:"table_info_item"},[i("el-popover",{attrs:{"popper-class":"customer-popover",placement:"bottom",title:"Shopify Order "+a.codeName,width:"500",trigger:"hover"}},[i("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(a.shippingJson&&a.shippingJson.name?a.shippingJson.name:"")+" "),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),i("div",{staticClass:"mg-y-15 mg-t-20"},[i("div",{staticClass:"d-flex mg-b-10"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("Order Date"))+" :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(a.timeCreated?a.timeCreated:"---"))])])]),i("div",{staticClass:"d-flex mg-b-10"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("Customer"))+" :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(a.shippingJson&&a.shippingJson.name?a.shippingJson.name:"---")+" ")])])]),i("div",{staticClass:"d-flex mg-b-10"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v("Phone :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(a.shippingJson&&a.shippingJson.phone?a.shippingJson.phone:"---")+" ")])])]),i("div",{staticClass:"d-flex mg-b-10"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("Address"))+":")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(a.shippingJson&&a.shippingJson.address1?a.shippingJson.address1:"")+" "+t._s(a.shippingJson&&a.shippingJson.city?a.shippingJson.city:"")+" "+t._s(a.shippingJson&&a.shippingJson.province?a.shippingJson.province:"")+" "),i("br"),t._v(" "+t._s(a.shippingJson&&a.shippingJson.country?a.shippingJson.country:"")+" ")])])])])])],1),i("div",{staticClass:"table_info_item tx-right pd-r-15 d-flex"},[a.currency?i("span",[t._v(t._s(t.ce[a.currency]?t.ce[a.currency].symbol:a.currency)+" ")]):t._e(),t._v(" "+t._s(a.totalPrice)+" ")]),i("div",{staticClass:"table_info_item"},[a.fulfillmentStatus?"partial"==a.fulfillmentStatus?i("el-tag",{attrs:{size:"small",type:"partial"==a.fulfillmentStatus?"danger":""}},[i("span",{staticClass:"-EFlq"}),t._v(" "+t._s("partial"==a.fulfillmentStatus?"Partially fulfilled":"Fulfilled")+" ")]):t._e():i("el-tag",{attrs:{size:"small",type:"warning"}},[i("span",{staticClass:"-EFlq"}),t._v(" "+t._s(t.$t("Unfulfilled"))+" ")])],1),i("div",{staticClass:"table_info_item"},[t._v(" "+t._s(a.items?a.items.length:"0")+" Items "),i("el-link",{staticClass:"mg-l-20",staticStyle:{display:"inline"},attrs:{underline:!1,type:"primary"},on:{click:function(e){return t.setOrderHide(a)}}},[t._v(t._s(1==t.isManage?"Hide":"Show")+" this order")])],1)]):i("div",{staticClass:"table_info_node"},[i("div",{staticClass:"table_info_item",staticStyle:{flex:"2",overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[i("div",{staticStyle:{display:"flex","align-items":"center"}},[i("el-image",{staticStyle:{"min-width":"40px",width:"40px",height:"40px",margin:"5px 15px 5px 0",border:"1px solid #ddd"},attrs:{src:a.imgUrl,"preview-src-list":a.previewList}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})])]),i("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[i("p",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"},style:a.disabled?"text-decoration:line-through;":""},[t._v(t._s(a.name))]),i("p",[i("span",{staticStyle:{color:"#999"}},[t._v("SKU: ")]),t._v(t._s(a.sku))])])],1)]),i("div",{staticClass:"table_info_item"},[i("p",{class:a.unfulfillQuantity>0&&a.unfulfillQuantity<a.quantity?"line":""},[t._v(" x "+t._s(a.quantity)+" ")]),a.unfulfillQuantity>0&&a.unfulfillQuantity<a.quantity?i("p",[i("span",[t._v(" x "+t._s(a.unfulfillQuantity)+" ")]),i("span",{staticStyle:{color:"#c05717","margin-left":"20px"}},[t._v("("+t._s(a.fulfillQuantity)+" of "+t._s(a.quantity)+" "+t._s(t.$t("purchased items are delivered"))+")")])]):t._e(),0==a.unfulfillQuantity?i("p",[i("span",[t._v("("+t._s(a.fulfillQuantity)+" of "+t._s(a.quantity)+" "+t._s(t.$t("fulfilled"))+")")])]):t._e()]),i("div",{staticClass:"table_info_item"},[i("p",[i("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("Vendor"))+": ")]),t._v(" "+t._s(a.vendorName?a.vendorName:"---")+" ")]),i("p",[i("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("Cost per unit"))+": ")]),t._v(" "+t._s(a.costPrice?"US$ "+a.costPrice:"---")+" ")])]),a.invoiceItems?i("div",{staticClass:"table_info_item"},[a.invoiceItems.length>0?[i("el-popover",{attrs:{"popper-class":"items-popover",placement:"bottom",title:"Selected by "+a.invoiceItems.length+" purchase Orders",width:"500",trigger:"hover"}},[i("span",{staticStyle:{"margin-right":"10px",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v("# ("+t._s(a.invoiceItems.length)+")"),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._l(a.invoiceItems,(function(e){return i("div",{staticClass:"mg-y-15 mg-t-20"},[i("div",{staticClass:"d-flex mg-b-15"},[i("span",{staticClass:"mg-r-10"},[t._v("# "+t._s(e.code))]),i("span",{staticClass:"mg-r-10"},[t._v(t._s(e.vendorName))]),i("el-link",{attrs:{type:"primary"},on:{click:function(i){return t.gotoInvoice(e)}}},[t._v(t._s(t.$t("View the details")))])],1)])}))],2)]:t._e()],2):t._e()])])}}],null,!1,2605932900)})],1):t._e()])])]),i("div",{ref:"ordersFooter",staticClass:"alert-wrap d-flex justify-content-between"},[i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"is-bold"},[t._v(t._s(t.selectData.length)+" "+t._s(t.$t("shopify orders have been selected and can now be dispatched to your vendors")))]),i("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"d-flex"},[i("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.$t("Dispatch to the vendor"))+":")]),i("div",{staticClass:"d-flex align-items-center"},[t._l(t.dynamicTags,(function(e,a){return t.dynamicTags.length>0?i("el-tag",{key:e.id,attrs:{size:"medium",closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(a)}}},[t._v(" "+t._s(e.vendorName)+" ")]):t._e()})),t.inputVisible?i("div",[i("el-popover",{ref:"popoverCustomer",attrs:{"popper-class":"with-shadow with-shadow2",trigger:"manual",width:"300",placement:"bottom"},on:{hide:t.hidepopoverCustomer},model:{value:t.inputVisible2,callback:function(e){t.inputVisible2=e},expression:"inputVisible2"}},[i("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{slot:"reference",size:"medium"},on:{focus:function(e){t.inputVisible2=!t.inputVisible2}},slot:"reference",model:{value:t.vendorName,callback:function(e){t.vendorName=e},expression:"vendorName"}}),i("div",{staticClass:"tx-center change-customer"},[i("div",{staticStyle:{height:"280px","overflow-y":"scroll"}},[t.vendorData.length?i("div",{staticClass:"mg-t-10"},t._l(t.vendorData,(function(e,a){return i("div",{key:a+e.id+e.customerName,staticClass:"text customer-item",class:{active:e.active},on:{click:function(i){return t.selectCustomer(e)}}},[i("div",[i("i",{staticClass:"el-icon-s-custom mg-r-5"}),t._v(t._s(e.vendorName?e.vendorName:"---")+" ")]),i("el-link",{staticStyle:{"font-weight":"normal"},attrs:{type:"primary",underline:!1}},[t._v(t._s(t.$t("Select")))])],1)})),0):i("div",{staticClass:"tx-center"},[t._v(t._s(t.$t("No data")))])]),i("el-divider"),""==t.vendorName||t.vendorData.length>0?[i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.openAddVendor}},[i("i",{staticClass:"fa fa-user-plus mg-r-10"}),t._v(t._s(t.$t("Add a new vendor")))])]:t._e(),t.vendorName&&0==t.vendorData.length?[i("el-button",{attrs:{type:"primary",plain:""},on:{click:t.openAddVendor}},[i("i",{staticClass:"fa fa-user-plus mg-r-10"}),t._v('Add "'+t._s(t.vendorName)+'"')])]:t._e(),i("el-button",{on:{click:t.hidepopoverCustomer}},[t._v(t._s(t.$t("Close")))])],2)],1)],1):t._e(),t.inputVisible?t._e():i("div",[i("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ "+t._s((t.dynamicTags.length,"Choose a vendor")))])],1)],2)])]),i("div",[i("el-button",{staticClass:"button-new-tag",attrs:{type:"primary",size:"small"},on:{click:t.setOrderHideChecked}},[t._v(t._s(1==t.isManage?"Hide":"Show")+" "+t._s(t.$t("selected orders")))]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"button-new-tag mg-l-10",attrs:{type:"success",size:"small"},on:{click:t.getInvocie}},[t._v(t._s(t.$t("Make a purchase order")))])],1)]),i("el-dialog",{staticClass:"add-vendor-dialog",attrs:{title:t.$t("Add a new vendor"),visible:t.addVendorDialog.isShow,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addVendorDialog,"isShow",e)}}},[i("el-divider"),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form",[i("el-form-item",{attrs:{label:"Name","label-width":t.addVendorDialog.labelW,required:""}},[i("el-input",{attrs:{placeholder:"Name","auto-complete":"off"},model:{value:t.addVendorDialog.name,callback:function(e){t.$set(t.addVendorDialog,"name",e)},expression:"addVendorDialog.name"}})],1),i("el-form-item",{attrs:{label:"Email","label-width":t.addVendorDialog.labelW}},[i("el-input",{attrs:{placeholder:"Email","auto-complete":"off"},model:{value:t.addVendorDialog.email,callback:function(e){t.$set(t.addVendorDialog,"email",e)},expression:"addVendorDialog.email"}})],1),i("el-form-item",{attrs:{label:"Remark","label-width":t.addVendorDialog.labelW}},[i("el-input",{attrs:{placeholder:"Remark","auto-complete":"off"},model:{value:t.addVendorDialog.remark,callback:function(e){t.$set(t.addVendorDialog,"remark",e)},expression:"addVendorDialog.remark"}})],1)],1)],1)],1),i("el-divider"),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.addVendorDialog.isShow=!1}}},[t._v(t._s(t.$t("Close")))]),i("el-button",{attrs:{size:"small",type:"primary",loading:t.addVendorDialog.loading},on:{click:function(e){return t.saveVendor(2)}}},[t._v(t._s(t.$t("Save")))])],1)],1),i("el-dialog",{staticClass:"d-block",attrs:{title:"Export orders",visible:t.exportDialog,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){t.exportDialog=e}}},[i("el-divider"),i("div",{staticStyle:{padding:"20px"}},[i("p",{staticClass:"mg-b-10"},[t._v(t._s(t.$t("Export to"))+" "+t._s(t.$store.state.userInfo.email))]),i("el-radio-group",{model:{value:t.exportStatus,callback:function(e){t.exportStatus=e},expression:"exportStatus"}},[i("el-radio",{attrs:{label:"1"}},[t._v(t._s(t.$t("All orders")))]),i("el-radio",{attrs:{label:"2",disabled:!t.selectData.length}},[t._v(t._s(t.$t("Selected"))+": "+t._s(t.selectData.length)+" orders")]),i("el-radio",{attrs:{label:"3"}},[t._v(t._s(t.totalCount)+" "+t._s(t.$t("orders matching your search")))])],1)],1),i("el-divider"),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.exportDialog=!1}}},[t._v(t._s(t.$t("Cancel")))]),i("el-button",{attrs:{size:"small",type:"primary",disabled:!t.exportStatus,loading:t.exportLoading},on:{click:t.exportOrders}},[t._v(t._s(t.$t("Export orders")))])],1)],1),i("el-dialog",{staticClass:"dialog-automatic",attrs:{visible:t.automaticSettingDialog.isShow,title:"Automatic dispatch orders setting"},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShow",e)}}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.automaticSettingDialog.loading,expression:"automaticSettingDialog.loading"}],staticClass:"automatic-body"},[i("div",{staticStyle:{"margin-bottom":"15px"}},[i("el-alert",{attrs:{title:"The unfulfilled shopify order will be dispatched to the vendor according to the optimization apportion rules which you made. You can set up an automatic advice to your vendor to check order and offer quotation.",type:"warning","show-icon":"",closable:!1}})],1),t.automaticSettingDialog.openRulestatus?[i("div",{staticStyle:{"margin-bottom":"15px",padding:"15px",border:"1px #DCDFE6 solid"}},[i("div",{staticClass:" d-flex",staticStyle:{"margin-bottom":"10px"}},[i("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:t.automaticSettingDialog.allProducts},model:{value:t.automaticSettingDialog.productIds,callback:function(e){t.$set(t.automaticSettingDialog,"productIds",e)},expression:"automaticSettingDialog.productIds"}},t._l(t.automaticSettingDialog.products,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name.substring(0,18),value:e.id}},[i("div",{staticClass:"product-select-opt"},[i("div",{staticClass:"img-wrap",style:{backgroundImage:"url("+e.img+")"}}),i("div",{staticClass:"info"},[i("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(e.name))]),i("div",{staticClass:"price"},[i("span",{staticClass:"currency"},[t._v(t._s(e.currency))]),e.minShopPrice==e.maxShopPrice?i("span",[t._v(t._s(e.minShopPrice))]):i("span",[t._v(t._s(e.minShopPrice)+" - "+t._s(e.maxShopPrice))])])])])])})),1),i("el-checkbox",{staticStyle:{"margin-right":"25px","margin-bottom":"0"},model:{value:t.automaticSettingDialog.allProducts,callback:function(e){t.$set(t.automaticSettingDialog,"allProducts",e)},expression:"automaticSettingDialog.allProducts"}},[t._v(" "+t._s(t.$t("Choose my all Shopify products"))+" ")]),i("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:t.automaticSettingDialog.vendorId,callback:function(e){t.$set(t.automaticSettingDialog,"vendorId",e)},expression:"automaticSettingDialog.vendorId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return i("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1),i("div",[t._v(" Every "),i("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"circle period"},model:{value:t.automaticSettingDialog.period,callback:function(e){t.$set(t.automaticSettingDialog,"period",e)},expression:"automaticSettingDialog.period"}},t._l(15,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t+""}})})),1),t._v(" day(s) ")],1)],1),i("div",[i("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:t.automaticSettingDialog.visibilityType,callback:function(e){t.$set(t.automaticSettingDialog,"visibilityType",e)},expression:"automaticSettingDialog.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,e){return i("el-option",{key:e,attrs:{label:t,value:e}})})),1),i("el-select",{staticStyle:{"margin-right":"25px",width:"100px"},attrs:{size:"mini"},model:{value:t.automaticSettingDialog.status,callback:function(e){t.$set(t.automaticSettingDialog,"status",e)},expression:"automaticSettingDialog.status"}},[i("el-option",{attrs:{label:"Enabled",value:"1"}}),i("el-option",{attrs:{label:"Disabled",value:"2"}})],1),i("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,loading:t.automaticSettingDialog.saveRuleLoading,type:"primary",size:"mini"},on:{click:function(e){return t.saveRule()}}},[t._v(t._s(t.$t("Save Rule")))]),i("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!1)}}},[t._v(t._s(t.$t("Cancel")))])],1)])]:i("div",{staticStyle:{"margin-bottom":"10px"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!0)}}},[t._v("+ "+t._s(t.$t("Add a dispatch rule")))])],1),i("div",[i("el-table",{ref:"autoSettingTable",staticClass:"auto-setting-table",staticStyle:{width:"100%"},attrs:{data:t.automaticSettingDialog.items,"row-key":"id",stripe:"",height:"300"}},[i("el-table-column",{attrs:{label:"Priority",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"el-icon-d-caret"}),t._v(" "+t._s(e.$index+1)+" "),e.$index?t._e():i("span",{staticStyle:{color:"#C0C4CC"}},[t._v("(Highest)")])]}}])}),i("el-table-column",{attrs:{label:"Products in Shopify",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?i("div",{staticClass:"d-flex"},[i("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:e.row.editMode.allProducts},model:{value:e.row.editMode.productIds,callback:function(i){t.$set(e.row.editMode,"productIds",i)},expression:"scope.row.editMode.productIds"}},t._l(t.automaticSettingDialog.products,(function(e){return i("el-option",{key:e.id,attrs:{label:e.name.substring(0,18),value:e.id}},[i("div",{staticClass:"product-select-opt"},[i("div",{staticClass:"img-wrap",style:{backgroundImage:"url("+t.stockImg(e)+")"}}),i("div",{staticClass:"info"},[i("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(e.name))]),i("div",{staticClass:"price"},[i("span",{staticClass:"currency"},[t._v(t._s(e.currency))]),e.minPrice==e.maxPrice?i("span",[t._v(t._s(e.minPrice))]):i("span",[t._v(t._s(e.minPrice)+" - "+t._s(e.maxPrice))])])])])])})),1),i("el-checkbox",{staticStyle:{"margin-bottom":"0"},model:{value:e.row.editMode.allProducts,callback:function(i){t.$set(e.row.editMode,"allProducts",i)},expression:"scope.row.editMode.allProducts"}},[t._v(" all ")])],1):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.row.editMode,expression:"!scope.row.editMode"}],staticClass:"d-flex",on:{click:function(i){return t.showProducts(e.row)}}},[e.row.products.length?[t._l(e.row.products,(function(e,a){return[a<5?i("el-image",{key:e.id,staticStyle:{width:"26px",height:"26px","margin-right":"5px"},attrs:{src:t.stockImg(e),fit:"contain",lazy:""}},[i("div",{staticClass:"image-slot",staticStyle:{color:"#C0C4CC","text-align":"center"},attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])]):t._e()]})),e.row.productCnt>5?[i("span",{staticStyle:{color:"#909399"}},[t._v(" ... ("),i("span",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(e.row.productCnt))]),t._v(") ")])]:t._e()]:[t._v(t._s(t.$t("My all Shopify products")))]],2)]}}])}),i("el-table-column",{attrs:{label:"Dispatch to vendor",width:"180",prop:"vendorName"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?i("el-select",{staticStyle:{width:"170px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:e.row.editMode.relationshipId,callback:function(i){t.$set(e.row.editMode,"relationshipId",i)},expression:"scope.row.editMode.relationshipId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return i("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1):i("span",[t._v(t._s(e.row.vendorName))])]}}])}),i("el-table-column",{attrs:{label:"Cycle Time",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?i("div",[i("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"period"},model:{value:e.row.editMode.period,callback:function(i){t.$set(e.row.editMode,"period",i)},expression:"scope.row.editMode.period"}},t._l(15,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e+""}},[i("span",[t._v(t._s(e))]),t._v(" "),i("span",{staticStyle:{color:"#C0C4CC"}},[t._v("day(s)")])])})),1)],1):i("span",[t._v(" Every "+t._s(e.row.period)+" day(s) ")])]}}])}),i("el-table-column",{attrs:{label:"Vendor visibility",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?i("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:e.row.editMode.visibilityType,callback:function(i){t.$set(e.row.editMode,"visibilityType",i)},expression:"scope.row.editMode.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,e){return i("el-option",{key:e,attrs:{label:t,value:e}})})),1):i("span",[t._v(t._s(t.visibilityTypeArr[e.row.visibilityType]))])]}}])}),i("el-table-column",{attrs:{label:"Rule status",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?i("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:e.row.editMode.status,callback:function(i){t.$set(e.row.editMode,"status",i)},expression:"scope.row.editMode.status"}},[i("el-option",{attrs:{label:"Enabled",value:"1"}}),i("el-option",{attrs:{label:"Disabled",value:"2"}})],1):i("el-tag",{attrs:{type:1==e.row.status?"success":"danger","disable-transitions":!0}},[t._v(" "+t._s(1==e.row.status?"Enabled":"Disabled")+" ")])]}}])}),i("el-table-column",{attrs:{label:"Action"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.editMode?[i("el-button",{attrs:{loading:e.row.loading,disabled:e.row.loading,size:"mini",type:"primary"},on:{click:function(i){return t.saveEditRule(e.row)}}},[t._v(t._s(t.$t("Save Rule")))]),i("el-button",{attrs:{disabled:e.row.loading,size:"mini"},on:{click:function(i){return t.cancelEditRule(e.row)}}},[t._v(t._s(t.$t("Cancel")))])]:[i("el-link",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(i){return t.editRule(e.row)}}},[t._v(t._s(t.$t("Edit")))]),i("el-link",{staticStyle:{"margin-right":"10px"},attrs:{disabled:e.row.statusLoading,type:1==e.row.status?"danger":"success"},on:{click:function(i){return t.changeRuleStatus(e.row)}}},[t._v(" "+t._s(1==e.row.status?"Disable":"Enable")+" ")]),i("el-popconfirm",{attrs:{title:"Do you want to delete it",iconColor:"red",confirmButtonText:"Delete",cancelButtonText:"Cancel"},on:{onConfirm:function(i){return t.delRuleStatus(e.row,e.$index)}}},[i("el-link",{attrs:{slot:"reference",disabled:e.row.delLoading,type:"danger"},slot:"reference"},[t._v(t._s(t.$t("Delete")))])],1)]]}}])})],1)],1)],2),i("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"footer"},slot:"footer"},[i("div",[t._v(" "+t._s(t.$t("Only matching last"))+" "),i("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},on:{change:t.changeDay},model:{value:t.automaticSettingDialog.day,callback:function(e){t.$set(t.automaticSettingDialog,"day",e)},expression:"automaticSettingDialog.day"}},t._l(t.automaticSettingDialog.dayArr,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1),t._v(" "+t._s(t.$t("days unfulfilled orders"))+" ")],1),i("div",[i("el-button",{attrs:{disabled:t.automaticSettingDialog.loading},on:{click:function(e){t.automaticSettingDialog.isShow=!1}}},[t._v(" "+t._s(t.$t("Close")))]),i("el-button",{attrs:{type:"primary",loading:t.automaticSettingDialog.loading},on:{click:t.dispatchRuleTest}},[t._v(" "+t._s(t.$t("Dispatch rule TEST"))+" ")])],1)]),i("el-dialog",{attrs:{width:"30%",title:"Dispatch rule Test Preview",visible:t.automaticSettingDialog.previewShow,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"previewShow",e)}}},[i("div",{staticStyle:{padding:"20px"}},[i("p",{staticStyle:{"margin-bottom":"10px"}},[t._v(" "+t._s(t.$t("According to your settings, we found some data for you"))+": ")]),i("p",[t._v(" "+t._s(t.$t("Shopify order"))+": "),i("b",{staticStyle:{"margin-right":"15px",color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.orderCnt))]),t._v(" (Dispatch to "),i("b",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.vendorCnt))]),t._v(" vendor(s)) ")])]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{disabled:t.automaticSettingDialog.runLoading},on:{click:function(e){t.automaticSettingDialog.previewShow=!1}}},[t._v(" "+t._s(t.$t("Dispatch in the Next Cycle"))+" ")]),i("el-button",{attrs:{loading:t.automaticSettingDialog.runLoading,disabled:t.automaticSettingDialog.runLoading,type:"primary"},on:{click:t.runDispatchRule}},[t._v(t._s(t.$t("Dispatch Immediately")))])],1)]),i("el-dialog",{attrs:{width:"50%",title:"Products",visible:t.automaticSettingDialog.isShowProducts,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShowProducts",e)}}},[i("div",{staticClass:"preview-product-list"},t._l(t.automaticSettingDialog.showProductsItems,(function(e){return i("div",{key:e.id,staticClass:"pro"},[i("el-image",{staticStyle:{width:"160px",height:"160px"},attrs:{src:t.stockImg(e),fit:"contain"}}),i("div",{staticClass:"name tx-ellipsis2",attrs:{title:e.name}},[t._v(" "+t._s(e.name)+" ")])],1)})),0),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.automaticSettingDialog.isShowProducts=!1}}},[t._v(t._s(t.$t("Close")))])],1)])],1)],1)},s=[],o=(i("99af"),i("c740"),i("a15b"),i("a434"),i("b0c0"),i("a9e3"),i("b64b"),i("159b"),i("a4d3"),i("e01a"),i("d28b"),i("d3b7"),i("3ca3"),i("ddb0"),i("06c5"));function l(t,e){var i;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=Object(o["a"])(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,n=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){n=!0,l=t},f:function(){try{r||null==i["return"]||i["return"]()}finally{if(n)throw l}}}}var r=i("aa47"),n={data:function(){return{dynamicTags:[],inputVisible:!1,inputVisible2:!1,vendorName:"",loading:!1,tableHeight:400,page:1,rowsPerPage:100,items:[],totalCount:0,totalPage:0,updateOrderLoading:!1,cnow:0,now:Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff,updateTime:localStorage.getItem("c_orders-updateTime")?Number(localStorage.getItem("c_orders-updateTime")):0,dispatchStatus:"",sortBy:"",fulfillStatus:[],timeFilter:"",shopifyStore:[],dateRangeValue:"",codeName:"",dateArr:{1:"Today",2:"Last 7 days",3:"Last 30 days",4:"Last 90 days",5:"Last 12 months",6:"Custom"},sortArr:{1:"Order number (ascending)",2:"Order number (descending)",3:"Date (oldest first)",4:"Date (newest first)"},dispatchArr:{1:"All",2:"Not dispatched to vendor",3:"Dispatched to vendor"},tableData:[],tableDataTab1:[],multipleSelection:[],multipleSelectionSub:[],getRowKey:function(t){return t.id},getRowKeyChild:function(t){return t.id},props:{label:"id",children:"items"},checked:!1,filterDate:[],dateFrom:"",dateTo:"",storeList:[],shopifyStoreName:"",supplierList:[],isIndeterminate:!1,checkedSupplier:[],checkedSupplierName:"",checkAll:!1,vendorData:[],addVendorDialog:{isShow:!1,loading:!1,labelW:"120px",name:"",remark:"",email:"",id:""},addVendorDialogDefault:"{}",selectData:[],selectDataNoHalf:[],expandedKeys:[],expandAll:!1,exportDialog:!1,exportStatus:"",exportLoading:!1,automaticSettingDialog:{loading:!1,isShow:!1,getProductsloading:!1,allProducts:!1,products:[],productIds:[],getVendorsloading:!1,vendorId:"",vendors:[],period:"",visibilityType:"",status:"1",saveRuleLoading:!1,openRulestatus:!1,page:1,rowsPerPage:10,total:0,totalPage:0,items:[],previewShow:!1,vendorCnt:0,orderCnt:0,isShowProducts:!1,showProductsItems:[],day:30,dayArr:[7,10,15,20,30,45,60],runLoading:!1},automaticSettingDialogDefault:"{}",visibilityTypeArr:{1:"Auto dispatch",2:"After my reconfirm"},ruleCnt:0,isManage:1,defaultChecked:[],selectLoading:!1,checkLoading:!1,ce:this.$CE}},components:{},watch:{"$store.state.userInfo":function(){this.$store.state.userInfo.ruleCnt&&(this.ruleCnt=this.$store.state.userInfo.ruleCnt)},shopifyStore:function(){var t=this;if(this.shopifyStore.length){var e=[];this.shopifyStore.forEach((function(i){t.storeList.forEach((function(t){i==t.shopifyAccountId&&e.push(t.store)}))})),this.shopifyStoreName=e.join(",")}},checkedSupplier:function(){var t=this;if(this.checkedSupplier.length){var e=[];this.checkedSupplier.forEach((function(i){t.supplierList.forEach((function(t){i==t.id&&"999e"!=t.id&&e.push(t.vendorName)}))})),this.checkedSupplierName=e.join(",")}},isShowFilter:function(){this.isShowFilter&&(this.timeFilter=3)}},computed:{isShowFilter:function(){return!(this.sortBy||this.fulfillStatus.length||this.shopifyStore.length||this.codeName||this.dispatchStatus)},isAll:function(){return this.selectData.length==this.tableData.length&&this.tableData.length>0}},mounted:function(){var t=this;this.automaticSettingDialogDefault=JSON.stringify(this.automaticSettingDialog),this.addVendorDialogDefault=JSON.stringify(this.addVendorDialog),window.onresize=function(){t.$getTableHeight(t)},this.$nextTick((function(){t.getItems(),t.getStore(),t.getVendor()})),this.cnow=setInterval((function(){t.now=Date.parse(new Date)/1e3-t.$store.state.userInfo.timeDiff}),1e3),this.timeFilter=3,"999e"==this.$route.params.vid&&(this.timeFilter=""),this.$route.params.id&&(this.timeFilter=""),this.checkedSupplier=[]},beforeRouteEnter:function(t,e,i){i((function(t){t.loading=!0}))},beforeDestroy:function(){clearInterval(this.cnow)},methods:{setOrderHideChecked:function(){var t=this;this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHide",{orderIds:this.selectDataNoHalf,type:1==this.isManage?2:1},(function(e){t.$hideLoading(),9999==e.ErrorCode?t.getItems():(t.$hideLoading(),t.$elementMessage(e.Message,"error"))}))},setOrderHide:function(t){var e=this,i=[];i.push(t.id),this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHide",{orderIds:i,type:1==this.isManage?2:1},(function(t){9999==t.ErrorCode?e.getItems():(e.$hideLoading(),e.$elementMessage(t.Message,"error"))}))},changeDay:function(){var t=this;this.$apiCall("api.DispatchOrderRule.setMatchTime",{day:this.automaticSettingDialog.day},(function(e){9999==e.ErrorCode?t.$root.$children[0].checkLogin():t.$elementMessage(e.Message,"error")}))},showProducts:function(t){var e=this;if(t.products.length){var i=function(){e.automaticSettingDialog.showProductsItems=t.products,e.automaticSettingDialog.isShowProducts=!0};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},(function(a){e.automaticSettingDialog.loading=!1,9999==a.ErrorCode?(t.products=a.Data.Results,i()):e.$elementMessage(a.Message,"error")}))):i()}},runDispatchRule:function(){var t=this;this.automaticSettingDialog.runLoading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{isGenerate:1},(function(e){t.automaticSettingDialog.runLoading=!1,9999==e.ErrorCode?(t.$elementMessage("success","success"),t.automaticSettingDialog.isShow=!1,t.automaticSettingDialog.previewShow=!1,t.getItems()):t.$elementMessage(e.Message,"error")}))},dispatchRuleTest:function(){var t=this;this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{},(function(e){t.automaticSettingDialog.loading=!1,9999==e.ErrorCode?(t.automaticSettingDialog.vendorCnt=e.Data.Results.vendorCnt,t.automaticSettingDialog.orderCnt=e.Data.Results.orderCnt,t.automaticSettingDialog.previewShow=!0):t.$elementMessage(e.Message,"error")}))},delRuleStatus:function(t,e){var i=this;t.delLoading=!0,this.$apiCall("api.DispatchOrderRule.deleteRule",{id:t.id},(function(a){t.delLoading=!1,9999==a.ErrorCode?(i.automaticSettingDialog.items.splice(e,1),i.ruleCnt=i.automaticSettingDialog.items.length):i.$elementMessage(a.Message,"error")}))},changeRuleStatus:function(t){var e=this;t.statusLoading=!0,this.$apiCall("api.DispatchOrderRule.setStatus",{id:t.id},(function(i){t.statusLoading=!1,9999==i.ErrorCode?e.$set(t,"status",1==t.status?"2":"1"):e.$elementMessage(i.Message,"error")}))},editRule:function(t){var e=this,i=function(){e.automaticSettingDialog.getProductsloading=!1,e.automaticSettingDialog.getVendorsloading=!1,e.automaticSettingDialog.items.forEach((function(t){e.$set(t,"editMode",null)})),t.editMode={id:t.id,relationshipId:t.relationshipId,period:t.period,visibilityType:t.visibilityType,status:t.status,productIds:[],allProducts:!t.products.length},e.automaticSettingDialog.vendors=[{vendorName:t.vendorName,id:t.relationshipId}],e.automaticSettingDialog.products=t.products,e.$nextTick((function(){e.automaticSettingDialog.products.forEach((function(e){t.editMode.productIds.push(e.id)}))}))};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},(function(a){e.automaticSettingDialog.loading=!1,9999==a.ErrorCode?(t.products=a.Data.Results,i()):e.$elementMessage(a.Message,"error")}))):i()},stockImg:function(t){return JSON.parse(t.imgsJson)[0]},cancelEditRule:function(t){this.$set(t,"editMode",null)},saveEditRule:function(t){var e=this;if(t.editMode.allProducts||t.editMode.productIds.length)if(t.editMode.relationshipId)if(t.editMode.period)if(t.editMode.visibilityType){t.loading=!0;var i={id:t.editMode.id,relationshipId:t.editMode.relationshipId,period:t.editMode.period,visibilityType:t.editMode.visibilityType,productIds:t.editMode.productIds,status:t.editMode.status};t.editMode.allProducts&&(i.productIds=[]),this.$apiCall("api.DispatchOrderRule.changeByCustomer",i,(function(i){t.loading=!1,9999==i.ErrorCode?(e.$set(t,"editMode",null),e.getAutomaticSettingItems()):e.$elementMessage(i.Message,"error")}))}else this.$elementMessage(this.$t("Please select the vendow visibility"),"error");else this.$elementMessage(this.$t("Please select the circle period"),"error");else this.$elementMessage(this.$t("Please select the vendor"),"error");else this.$elementMessage(this.$t("Please select the products"),"error")},saveRule:function(){var t=this;if(this.automaticSettingDialog.allProducts||this.automaticSettingDialog.productIds.length)if(this.automaticSettingDialog.vendorId)if(this.automaticSettingDialog.period)if(this.automaticSettingDialog.visibilityType){this.automaticSettingDialog.saveRuleLoading=!0;var e={relationshipId:this.automaticSettingDialog.vendorId,period:this.automaticSettingDialog.period,visibilityType:this.automaticSettingDialog.visibilityType,productIds:this.automaticSettingDialog.productIds,status:this.automaticSettingDialog.status};this.automaticSettingDialog.allProducts&&(e.productIds=[]),this.$apiCall("api.DispatchOrderRule.addByCustomer",e,(function(e){t.automaticSettingDialog.saveRuleLoading=!1,9999==e.ErrorCode?(t.changeOpenAddRule(!1),t.getAutomaticSettingItems()):t.$elementMessage(e.Message,"error")}))}else this.$elementMessage(this.$t("Please select the vendor visibility"),"error");else this.$elementMessage(this.$t("Please select the Period"),"error");else this.$elementMessage(this.$t("Please select the vendor"),"error");else this.$elementMessage(this.$t("Please select the products"),"error")},changeOpenAddRule:function(t){this.automaticSettingDialog.openRulestatus=t,t&&(this.automaticSettingDialog.getProductsloading=!1,this.automaticSettingDialog.allProducts=!1,this.automaticSettingDialog.products=[],this.automaticSettingDialog.productIds=[],this.automaticSettingDialog.getVendorsloading=!1,this.automaticSettingDialog.vendorId="",this.automaticSettingDialog.vendors=[],this.automaticSettingDialog.period="",this.automaticSettingDialog.visibilityType="",this.automaticSettingDialog.status="1")},remoteMethodGetVendors:function(t){var e=this;t&&(this.automaticSettingDialog.getVendorsloading=!0,this.$apiCall("api.Relationship.findByCustomer",{name:t},(function(t){e.automaticSettingDialog.getVendorsloading=!1,9999==t.ErrorCode&&(e.automaticSettingDialog.vendors=t.Data.Results)})))},remoteMethodGetProducts:function(t){var e=this;t&&(this.automaticSettingDialog.getProductsloading=!0,this.$apiCall("api.Product.findByUser",{name:t},(function(t){e.automaticSettingDialog.getProductsloading=!1,9999==t.ErrorCode&&(e.automaticSettingDialog.products=[],t.Data.Results.forEach((function(t){JSON.parse(t.imgsJson).length&&(t.img=JSON.parse(t.imgsJson)[0]),e.automaticSettingDialog.products.push(t)})))})))},getAutomaticSettingItems:function(t){var e=this;t||(this.automaticSettingDialog.loading=!0);var i={};this.$apiCall("api.DispatchOrderRule.findByCustomer",i,(function(t){e.automaticSettingDialog.loading=!1,9999==t.ErrorCode?(e.automaticSettingDialog.items=[],t.Data.Results.forEach((function(t){t.loading=!1,t.statusLoading=!1,t.delLoading=!1,t.editMode=null,e.automaticSettingDialog.items.push(t)})),e.ruleCnt=e.automaticSettingDialog.items.length):e.$elementMessage(t.Message,"error")}))},openAutomaticSetting:function(){var t=this;this.automaticSettingDialog=JSON.parse(this.automaticSettingDialogDefault),this.automaticSettingDialog.day=this.$store.state.userInfo.config&&this.$store.state.userInfo.config.matchDay?this.$store.state.userInfo.config.matchDay:30,this.automaticSettingDialog.isShow=!0,this.getAutomaticSettingItems(),this.$nextTick((function(){var e=t.$refs.autoSettingTable.$refs.bodyWrapper.childNodes[0].childNodes[1],i=t;r["default"].create(e,{onEnd:function(t){var e=t.newIndex,a=t.oldIndex,s={};a>e?(s.id=i.automaticSettingDialog.items[a].id,s.toId=i.automaticSettingDialog.items[e].id):(s.id=i.automaticSettingDialog.items[a].id,s.toId=e==i.automaticSettingDialog.items.length-1?"":i.automaticSettingDialog.items[e+1].id),i.$apiCall("api.DispatchOrderRule.changeSort",s,(function(t){i.getAutomaticSettingItems(!0),9999!=t.ErrorCode&&i.$elementMessage(t.Message,"error")}));var o=i.automaticSettingDialog.items.splice(a,1)[0];i.automaticSettingDialog.items.splice(e,0,o)}})}))},getStore:function(){var t=this;this.storeList=[],this.$apiCall("api.Invoice.findStores",{authStatus:1},(function(e){if(9999==e.ErrorCode){if(!e.Data.Results.length)return;e.Data.Results.forEach((function(e){t.storeList.push({shopifyAccountId:e.id,store:e.shopName})}))}else t.$message({message:e.Message,type:"error"})}))},exportOrders:function(){var t=this,e={email:this.$store.state.userInfo.email,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName},i={email:this.$store.state.userInfo.email};if(2==this.exportStatus&&(e.ids=this.selectData.length?this.selectData:[]),3==this.exportStatus&&(2==this.dispatchStatus&&(e.fulfillType=1),3==this.dispatchStatus)){e.fulfillType=2;var a=[];this.checkedSupplier.forEach((function(e){t.supplierList.forEach((function(t){e==t.id&&a.push(t.id)}))})),e.fulfillRelationshipIds=a}this.exportLoading=!0,this.$apiCall("api.Invoice.exportShopifyOrders",1==this.exportStatus?i:e,(function(e){t.exportLoading=!1,9999==e.ErrorCode?(t.exportDialog=!1,t.$message({offset:200,duration:0,dangerouslyUseHTMLString:!0,showClose:!0,message:"<strong>YourOrdersareexporting</strong><br/>Yourexportwillbedeliveredbyemailto:".concat(t.$store.state.userInfo.email,".<br/>DependingonhowmanyOrdersyoureexporting,thiscouldtakesometime."),type:"success"})):(t.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||t.$userFailure())}))},exportDialogOpen:function(){this.exportDialog=!0,this.exportStatus="",this.exportLoading=!1},openAddVendor:function(){this.addVendorDialog=JSON.parse(this.addVendorDialogDefault),this.addVendorDialog.name=this.vendorName,this.addVendorDialog.isShow=!0},saveVendor:function(t){var e=this;if(this.addVendorDialog.name){this.addVendorDialog.loading=!0;var i="api.Relationship.addByCustomer",a={name:this.addVendorDialog.name,email:this.addVendorDialog.email,remark:this.addVendorDialog.remark};this.$apiCall(i,a,(function(i){e.addVendorDialog.loading=!1,9999==i.ErrorCode?(e.vendorName="",e.addVendorDialog.isShow=!1,e.$elementMessage(e.$t("Customers successfully added"),"success"),2==t?(e.dynamicTags.push({id:i.Data.Results,vendorName:e.addVendorDialog.name}),e.inputVisible=!1,e.vendorName=""):e.showInput(),e.getVendor()):(e.$elementMessage(i.Message,"error"),"1002"!=i.ErrorCode&&"1003"!=i.ErrorCode||e.$userFailure())}))}else this.$elementMessage(this.$t("Customer name required"),"error")},getInvocie:function(){var t=this,e=this.$refs.treeData.getCheckedNodes(),i=[],a=[];this.dynamicTags.length?e.length?(e.forEach((function(t){t.items||i.push(t.oldid)})),this.dynamicTags.forEach((function(t){a.push(t.id)})),this.$showLoading(),this.$apiCall("api.Invoice.genInvoice",{skus:i,relationshipId:a},(function(e){t.$hideLoading(),"9999"==e.ErrorCode?(t.$elementMessage(t.$t("A new order successfully created"),"success"),sessionStorage.setItem("c_selectedSaveInfo",JSON.stringify(e.Data.Results)),setTimeout((function(){t.$router.push({name:"invoices",params:{saveCode:!0}})}),1e3)):(t.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||t.$userFailure())}))):this.$elementMessage(this.$t("Please choose an item"),"error"):this.$elementMessage(this.$t("Please choose an vendor"),"error")},changeCustomerName:function(){var t=this;window.lazy&&window.clearTimeout(window.lazy),window.lazy=setTimeout((function(){t.$apiCall("api.Relationship.findByCustomer",{name:t.vendorName},(function(e){"9999"==e.ErrorCode?t.vendorData=e.Data.Results:(t.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||t.$userFailure())}))}),400)},getVendor:function(){var t=this;this.$apiCall("api.Relationship.findByCustomer",{},(function(e){"9999"==e.ErrorCode?(t.vendorData=e.Data.Results,1==e.Data.Results.length&&t.dynamicTags.push(e.Data.Results[0])):(t.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||t.$userFailure())}))},selectCustomer:function(t){var e=this;this.dynamicTags=[],setTimeout((function(){e.inputVisible=!1,e.inputVisible2=!1,e.vendorName="",e.dynamicTags.push(t)}),300)},handleClose:function(t){this.dynamicTags.splice(t,1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},hidepopoverCustomer:function(){var t=this;setTimeout((function(){t.inputVisible=!1,t.inputVisible2=!1}),100)},handleCheckAllChange:function(t){var e=this,i=[];if(this.supplierList.forEach((function(t){i.push(t.id)})),this.checkedSupplier=t?i:[],this.isIndeterminate=!1,1==this.checkedSupplier.length)this.supplierList.forEach((function(t){t.id==e.checkedSupplier[0]&&e.changeSupplierTag(t)}));else{var a=[];this.checkedSupplier.forEach((function(t){e.supplierList.forEach((function(e){t==e.id&&"999e"!=t&&e.listInfo.length&&e.listInfo.forEach((function(t){a.push(t.id),t.items&&t.items.length&&t.items.forEach((function(t){a.push(t.id)}))}))}))})),this.tableData=this.tableDataTab1;var s=JSON.parse(JSON.stringify(this.tableDataTab1));s.forEach((function(t,e){s[e].items=[]})),a.length&&(a.forEach((function(t){e.tableData.forEach((function(e,i){e.items.forEach((function(e,a){t==e.id&&s[i].items.push(e)}))}))})),this.tableData=[],s.forEach((function(t,i){t.items.length>0&&e.tableData.push(t)})))}},handleCheckedCitiesChange:function(t){var e=this,i=t.length;if(this.checkAll=i===this.supplierList.length-1,this.isIndeterminate=i>0&&i<this.supplierList.length-1,1==this.checkedSupplier.length)this.supplierList.forEach((function(t){t.id==e.checkedSupplier[0]&&e.changeSupplierTag(t)}));else{var a=[];this.checkedSupplier.forEach((function(t){e.supplierList.forEach((function(e){t==e.id&&e.listInfo.length&&e.listInfo.forEach((function(t){a.push(t.id),t.items&&t.items.length&&t.items.forEach((function(t){a.push(t.id)}))}))}))})),this.tableData=this.tableDataTab1;var s=JSON.parse(JSON.stringify(this.tableDataTab1));s.forEach((function(t,e){s[e].items=[]})),a.length&&(a.forEach((function(t){e.tableData.forEach((function(e,i){e.items.forEach((function(e,a){t==e.id&&s[i].items.push(e)}))}))})),this.tableData=[],s.forEach((function(t,i){t.items.length>0&&e.tableData.push(t)})))}},dateChange:function(){this.filterDate.length>1&&(this.dateFrom=moment(this.filterDate[0]).unix(),this.dateTo=moment(this.filterDate[1]).endOf("d").unix(),this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems())},changeSupplierTag:function(t){var e=this;this.$showLoading();var i=this.$refs.treeData.store.nodesMap;for(var a in i)i[a].expanded=!1;setTimeout((function(){e.expandedKeys=[],"999e"!=t.id&&(e.dynamicTags=[],e.dynamicTags.push({id:t.id,vendorName:t.vendorName})),e.supplierTag=t.id,e.storeTag="";var i=[];t.listInfo.length&&(t.listInfo.forEach((function(t){i.push(t.id),t.items&&t.items.length&&t.items.forEach((function(t){i.push(t.id)}))})),e.$hideLoading()),e.tableData=e.tableDataTab1;var a=JSON.parse(JSON.stringify(e.tableDataTab1));a.forEach((function(t,e){a[e].items=[]})),i.length&&(i.forEach((function(t){e.tableData.forEach((function(e,i){e.items.forEach((function(e,s){t==e.id&&a[i].items.push(e)}))}))})),e.tableData=[],a.forEach((function(t,i){t.items.length>0&&e.tableData.push(t)})))}),300)},filterItems2:function(t){this.isManage=t,this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems()},filterItems:function(t){var e=this;switch(t){case"dispatch":return this.checkedSupplier=[],this.checkAll=!1,void(1==this.dispatchStatus?(this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.getItems()):2==this.dispatchStatus&&this.supplierList.forEach((function(t){"999e"==t.id&&e.changeSupplierTag(t)})));case"store":break;case"date":if(this.filterDate=[],this.dateFrom="",this.dateTo="",6==this.timeFilter)return;break;case"fulfill":break;case"sort":break;default:break}this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems()},getCodeName:function(){var t=this;this.codeName&&(window.lazycodeName&&window.clearTimeout(window.lazycodeName),window.lazycodeName=setTimeout((function(){t.checked=!1,t.selectData=[],t.expandedKeys=[],t.expandAll=!1,t.checked=!1,t.$refs.treeData.setCheckedKeys([]),t.page=1,t.getItems()}),400))},clearFilterItems:function(t){switch((this.$route.params.id||"999e"==this.$route.params.vid)&&window.location.reload(),t){case"dispatch":this.dispatchStatus="",this.checkedSupplier=[],this.isIndeterminate=!1;break;case"store":this.shopifyStore=[];break;case"date":this.timeFilter="",this.filterDate=[],this.dateFrom="",this.dateTo="";break;case"fulfill":this.fulfillStatus=[];break;case"sort":this.sortBy="";break;default:this.codeName="";break}this.dynamicTags=[],this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.isShowFilter&&(this.timeFilter=3),this.getItems()},expandChange:function(){var t=this;this.$showLoading(),this.expandAll=!this.expandAll,this.$nextTick((function(){var e=t.$refs.treeData.store.nodesMap;for(var i in e)e[i].expanded=t.expandAll;t.$hideLoading()}))},gotoInvoice:function(t){var e=this.$router.resolve({path:"/i/"+t.uniCode});window.open(e.href,"_blank")},handleCheckChange:function(t){},handleCheck:function(){var t=this;this.$refs.treeData.getCheckedKeys();this.selectData=[];var e=this.$refs.treeData.getCheckedNodes().concat(this.$refs.treeData.getHalfCheckedNodes());e.forEach((function(e){e.items&&t.selectData.push(e.id)})),this.selectDataNoHalf=this.selectData;var i=this.$refs.treeData.getCheckedNodes();i.forEach((function(e){e.items&&t.selectDataNoHalf.push(e.id)}))},changeAllCheck:function(t){var e=this;console.log(t),this.checkLoading=!0;var i=0;this.tableData.length&&this.tableData.forEach((function(t){i++})),this.tableData.length==i&&setTimeout((function(){e.checkLoading=!1}),1600),setTimeout((function(){e.defaultChecked=[];if(t){var i=[];e.tableData.length&&e.tableData.forEach((function(t){i.push(t.id),e.defaultChecked.push(t.id),t.items&&t.items.length&&t.items.forEach((function(t){i.push(t.id)}))})),e.$refs.treeData.setCheckedKeys(i)}else e.$refs.treeData.setCheckedKeys([]);e.handleCheck()}),600)},checkedAll:function(){var t=this;this.selectData.length?this.checked=!0:this.checked=!1,this.checkLoading=!0;var e=0;this.tableData.length&&this.tableData.forEach((function(t){e++})),this.tableData.length==e&&setTimeout((function(){t.checkLoading=!1}),1600),setTimeout((function(){if(t.selectData.length?t.checked=!1:t.checked=!0,t.defaultChecked=[],t.checked){var e=[];t.tableData.length&&t.tableData.forEach((function(i){e.push(i.id),t.defaultChecked.push(i.id),i.items&&i.items.length&&i.items.forEach((function(t){e.push(t.id)}))})),t.$refs.treeData.setCheckedKeys(e)}else t.$refs.treeData.setCheckedKeys([]);t.handleCheck()}),600)},handleExpandChange:function(t,e,i){var a=this;this.$showLoading(),this.$apiCall("api.Invoice.getItemsInvoice",{id:t.id},(function(e){if(a.$hideLoading(),"9999"==e.ErrorCode)for(var i in e.Data.Results)t.items.forEach((function(t){i==t.id&&a.$set(t,"invoiceItems",e.Data.Results[i])}));else a.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||a.$userFailure()}))},getItems:function(){var t=this;this.loading=!0,this.tableData=[],this.tableDataTab1=[],this.page=1;var e={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName,isManage:this.isManage};this.$apiCall("api.Invoice.shopifyOrders",e,(function(e){if("9999"==e.ErrorCode){t.totalPage=e.Data.Pagination.totalPage,t.totalCount=e.Data.Pagination.totalCount,e.Data.Results.forEach((function(e){t.$set(e,"shippingJson",JSON.parse(e.shippingJson)),t.$set(e,"span",!0),e.items.length&&e.items.forEach((function(e){t.$set(e,"previewList",[]),t.$set(e,"disabled",0==e.unfulfillQuantity),e.imgUrl&&e.previewList.push(e.imgUrl)})),t.tableData.push(e),t.tableDataTab1.push(e)}));var i=t.$refs.treeData?t.$refs.treeData.store.nodesMap:"";if(i)for(var a in i)i[a].expanded=!1;t.page++,t.load(t.page,t.totalPage)}else t.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||t.$userFailure()}))},load:function(t,e){var i=this;if(t>e)setTimeout((function(){var t=[];if(i.tableData.length){if(i.tableData.forEach((function(e,a){e.items&&e.items.length&&e.items.forEach((function(e,s){i.$set(e,"oldid",e.id),i.$set(e,"id",e.id+a+s),t.push(e)}))})),i.supplierList=i.buildArrayGroup(t),i.supplierList.forEach((function(t,e){if(!t.id){i.$set(t,"id","999e"),i.$set(t,"vendorName","Unbound vendors");var a=t;i.supplierList.splice(e,1),i.supplierList.unshift(a)}})),"999e"==i.$route.params.vid&&(i.dispatchStatus=2),i.$route.params.id&&(i.checkedSupplier=[],i.dispatchStatus=3,i.supplierList.forEach((function(t){i.$route.params.id==t.id&&i.checkedSupplier.push(i.$route.params.id)}))),2==i.dispatchStatus)i.supplierList.forEach((function(t){"999e"==t.id&&i.changeSupplierTag(t)}));else if(3==i.dispatchStatus)if(0==i.checkedSupplier.length)i.tableData=[];else if(1==i.checkedSupplier.length)i.supplierList.forEach((function(t){t.id==i.checkedSupplier[0]&&i.changeSupplierTag(t)}));else{var e=[];i.checkedSupplier.forEach((function(t){i.supplierList.forEach((function(i){t==i.id&&i.listInfo.length&&i.listInfo.forEach((function(t){e.push(t.id),t.items&&t.items.length&&t.items.forEach((function(t){e.push(t.id)}))}))}))})),i.tableData=i.tableDataTab1;var a=JSON.parse(JSON.stringify(i.tableDataTab1));a.forEach((function(t,e){a[e].items=[]})),e.length&&(e.forEach((function(t){i.tableData.forEach((function(e,i){e.items.forEach((function(e,s){t==e.id&&a[i].items.push(e)}))}))})),i.tableData=[],a.forEach((function(t,e){t.items.length>0&&i.tableData.push(t)})))}}else i.supplierList=[];i.$getTableHeight(i),i.loading=!1}),300);else{var a={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName,isManage:this.isManage};this.$apiCall("api.Invoice.shopifyOrders",a,(function(t){"9999"==t.ErrorCode?(t.Data.Results.forEach((function(t,e){i.$set(t,"shippingJson",JSON.parse(t.shippingJson)),i.$set(t,"span",!0),t.items.length&&t.items.forEach((function(t){i.$set(t,"previewList",[]),t.imgUrl&&t.previewList.push(t.imgUrl)})),i.tableData.push(t),i.tableDataTab1.push(t)})),i.page++,i.load(i.page,i.totalPage)):(i.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||i.$userFailure(i))}))}},buildArrayGroup:function(t){var e,i=this,a=[],s=l(t);try{var o=function(){var t=e.value,i=t.relationshipId,s=t.vendorName,o=a.findIndex((function(t){return t.relationshipId===i})),l=-1!==o?a[o]:{};if(0===Object.keys(l).length){var r=[];r.push(t),l["relationshipId"]=i,l["vendorName"]=s,l["listInfo"]=r,a.push(l)}else{var n=a[o]||{},c=n["listInfo"];c.push(t)}};for(s.s();!(e=s.n()).done;)o()}catch(r){s.e(r)}finally{s.f()}return a.forEach((function(t){i.$set(t,"id",t.relationshipId)})),a},groupBySupplier:function(t){for(var e={},i=[],a=0;a<t.length;a++){var s=t[a];if(e[s.relationshipId])for(var o=0;o<i.length;o++){var l=i[o];if(l.relationshipId==s.relationshipId){l.listInfo.push(s);break}}else i.push({id:s.relationshipId,vendorName:s.vendorName,listInfo:[s]}),e[s.relationshipId]=s}return i},groupBy:function(t){for(var e={},i=[],a=0;a<t.length;a++){var s=t[a];if(e[s.shopifyAccountId])for(var o=0;o<i.length;o++){var l=i[o];if(l.shopifyAccountId==s.shopifyAccountId){l.listInfo.push(s);break}}else i.push({shopifyAccountId:s.shopifyAccountId,store:s.store,listInfo:[s]}),e[s.shopifyAccountId]=s}return i},formatminute:function(t){return moment.duration(t/60,"minutes").locale("en").humanize()},updateOrder:function(){var t=this;this.updateOrderLoading=!0,this.$apiCall("api.ShopifyAccount.getOrderByHand",{},(function(e){t.updateOrderLoading=!1,"9999"==e.ErrorCode?(t.updateTime=e.Data.Results,localStorage.setItem("c_orders-updateTime",e.Data.Results),t.$elementMessage("Update Order Success","success")):t.$elementMessage(e.Message,"error")}))}}},c=n,d=(i("b288"),i("d733"),i("2877")),u=Object(d["a"])(c,a,s,!1,null,"4264a4cc",null);e["default"]=u.exports},"9ad6":function(t,e,i){},"9bdd":function(t,e,i){var a=i("825a"),s=i("2a62");t.exports=function(t,e,i,o){try{return o?e(a(i)[0],i[1]):e(i)}catch(l){throw s(t),l}}},a630:function(t,e,i){var a=i("23e7"),s=i("4df4"),o=i("1c7e"),l=!o((function(t){Array.from(t)}));a({target:"Array",stat:!0,forced:l},{from:s})},b288:function(t,e,i){"use strict";i("4f6d")},c740:function(t,e,i){"use strict";var a=i("23e7"),s=i("b727").findIndex,o=i("44d2"),l="findIndex",r=!0;l in[]&&Array(1)[l]((function(){r=!1})),a({target:"Array",proto:!0,forced:r},{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),o(l)},d733:function(t,e,i){"use strict";i("9ad6")},fb6a:function(t,e,i){"use strict";var a=i("23e7"),s=i("861d"),o=i("e8b5"),l=i("23cb"),r=i("50c4"),n=i("fc6a"),c=i("8418"),d=i("b622"),u=i("1dde"),h=u("slice"),p=d("species"),g=[].slice,f=Math.max;a({target:"Array",proto:!0,forced:!h},{slice:function(t,e){var i,a,d,u=n(this),h=r(u.length),m=l(t,h),v=l(void 0===e?h:e,h);if(o(u)&&(i=u.constructor,"function"!=typeof i||i!==Array&&!o(i.prototype)?s(i)&&(i=i[p],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return g.call(u,m,v);for(a=new(void 0===i?Array:i)(f(v-m,0)),d=0;m<v;m++,d++)m in u&&c(a,d,u[m]);return a.length=d,a}})}}]);
//# sourceMappingURL=shopify-orders.c24ffea9.js.map