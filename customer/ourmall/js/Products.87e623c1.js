(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Products"],{"0da5":function(e,t,a){},d613:function(e,t,a){"use strict";a("0da5")},e6dc:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"contentpanel products-page"},[t("div",{ref:"pageHeader",staticClass:"pagetitle"},[e._m(0),t("div",{staticClass:"right"},[t("el-button",{attrs:{disabled:!!(e.updateTime&&e.updateTime>e.now),type:"primary",size:"medium",loading:e.updateProductLoading},on:{click:e.updateProducts}},[e.updateTime&&e.updateTime>e.now?t("span",{staticClass:"mg-r-10"},[e._v(" ("+e._s(e.formatminute(e.updateTime-e.now))+") ")]):e._e(),e._v(" Update Product ")])],1)]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"pagebody mg-b-20"},[t("el-card",[t("el-row",{attrs:{gutter:20}},[t("div",{ref:"pageFilter",staticClass:"page-filter"},[t("el-form",{attrs:{inline:!0,size:"mini"}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"Product name"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.name,callback:function(t){e.$set(e.filterParams,"name",t)},expression:"filterParams.name"}})],1),t("el-form-item",[t("el-select",{attrs:{filterable:"",remote:"","remote-method":e.remoteMethodStores,loading:e.selectLoading2,placeholder:"Enter Store name"},on:{change:e.filterGetItem},model:{value:e.filterParams.accountId,callback:function(t){e.$set(e.filterParams,"accountId",t)},expression:"filterParams.accountId"}},e._l(e.selectArr2,(function(e){return t("el-option",{key:e.id,attrs:{label:e.shopName?e.shopName:"---",value:e.id}})})),1)],1),t("el-form-item",{staticStyle:{"margin-right":"15px"}},[t("el-select",{attrs:{filterable:"",remote:"","remote-method":e.remoteMethodVendor,loading:e.selectLoading,placeholder:"Enter vendor name"},on:{change:e.filterGetItem},model:{value:e.filterParams.relationshipId,callback:function(t){e.$set(e.filterParams,"relationshipId",t)},expression:"filterParams.relationshipId"}},e._l(e.selectArr,(function(e){return t("el-option",{key:e.id,attrs:{label:e.vendorName,value:e.id}})})),1)],1),t("el-form-item",{staticStyle:{width:"190px"},attrs:{label:"Price from"}},[t("el-input-number",{staticStyle:{width:"110px"},attrs:{"controls-position":"right",min:0,precision:2},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.priceFrom,callback:function(t){e.$set(e.filterParams,"priceFrom",t)},expression:"filterParams.priceFrom"}})],1),t("el-form-item",[e._v(" - ")]),t("el-form-item",{staticStyle:{width:"190px"},attrs:{label:"Price to"}},[t("el-input-number",{staticStyle:{width:"110px"},attrs:{"controls-position":"right",min:0,precision:2},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.priceTo,callback:function(t){e.$set(e.filterParams,"priceTo",t)},expression:"filterParams.priceTo"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.filterGetItem}},[e._v("Filter")]),t("el-button",{attrs:{type:"danger"},on:{click:e.clearFilter}},[e._v("Clear")])],1)],1)],1)]),t("el-row",{ref:"gridTable",staticStyle:{"padding-top":"15px","overflow-y":"auto"},style:{height:e.tableHeight+"px"},attrs:{gutter:10}},[e.items.length?e._e():t("el-col",[t("p",{staticStyle:{"margin-top":"25px","font-size":"16px",color:"#909399","text-align":"center"}},[e._v("no product")])]),e._l(e.items,(function(a){return t("el-col",{key:a.id,staticStyle:{"margin-bottom":"20px"},attrs:{sm:12,md:8,lg:6,xl:4}},[t("div",{staticClass:"product-box"},[t("div",{staticClass:"d-flex justify-content-between mg-b-10"},[t("el-dropdown",{attrs:{size:"mini"}},[t("span",{staticClass:"el-dropdown-link"},[e._v(" All Action"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a.adminUrl?t("el-dropdown-item",{staticStyle:{width:"80px","text-align":"center"}},[t("a",{attrs:{href:a.adminUrl,target:"_blank"}},[e._v("Edit")])]):e._e(),t("el-dropdown-item",{staticStyle:{width:"80px","text-align":"center"},nativeOn:{click:function(t){return e.delP(a)}}},[t("span",{staticClass:"tx-danger"},[e._v("Delete")])])],1)],1),a.productUrl?t("a",{staticStyle:{color:"#5c6ac4"},attrs:{href:a.productUrl,target:"_blank"}},[e._v(" Open in website "),t("i",{staticClass:"fa fa-share-square-o",attrs:{"aria-hidden":"true"}})]):e._e()],1),t("div",{staticStyle:{position:"relative","padding-bottom":"100%","margin-bottom":"15px"}},[t("el-image",{staticStyle:{position:"absolute",width:"100%",height:"100%"},attrs:{lazy:"",fit:"contain",src:a.imgUrl,"preview-src-list":[a.imgUrl]}})],1),t("div",{staticClass:"info"},[t("div",{staticClass:"p-name tx-ellipsis2"},[e._v(e._s(a.name))]),a.minShopPrice||a.maxShopPrice?t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Retail price:")]),a.minShopPrice==a.maxShopPrice?t("span",[e._v(e._s(a.currency)+" "+e._s(a.minShopPrice))]):t("span",[e._v(e._s(a.currency)+" "+e._s(a.ShopminPrice)+" - "+e._s(a.ShopmaxPrice))])]):t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Retail price:")]),t("span",[e._v(" NOT SET")])]),a.minPrice||a.maxPrice?t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Supplier price:")]),a.minPrice==a.maxPrice?t("span",[e._v(e._s(e.$store.state.country.symbol)+" "+e._s(e.$exchangeRate(a.minPrice)))]):t("span",[e._v(e._s(e.$store.state.country.symbol)+" "+e._s(e.$exchangeRate(a.minPrice))+" - "+e._s(e.$store.state.country.symbol)+" "+e._s(e.$exchangeRate(a.maxPrice)))])]):t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Supplier price:")]),t("span",[e._v(" NOT SET")])]),t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Shopify store:")]),e._v(" "+e._s(a.shopName?a.shopName:"Unknown")+" ")]),t("div",[t("span",{staticClass:"mg-r-10",staticStyle:{color:"#909399"}},[e._v("Vendors:")]),e._v(" "+e._s(a.vendorCnt)+" ")])])])])}))],2)],1)],1),e.items.length?t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[t("div",[t("el-pagination",{attrs:{"current-page":e.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":e.pageSizes,"page-size":e.rowsPerPage,total:Number(e.total)},on:{"current-change":e.toPage,"size-change":e.changePageSize}})],1)])],1):e._e(),t("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:120}})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"left"},[t("div",{staticClass:"title"},[t("i",{staticClass:"el-icon-shopping-bag-1"}),t("h2",[e._v("Products")])])])}],s=(a("149f"),{data(){return{loading:!1,tableHeight:800,reSizeTime:0,pageSizes:[12,24,48],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_productsPerPage")?Number(localStorage.getItem("c_productsPerPage")):12,items:[],total:0,totalPage:0,filterParams:{name:"",relationshipId:"",priceFrom:void 0,priceTo:void 0,accountId:""},filterParamsDefault:"{}",selectLoading:!1,selectArr:[],selectLoading2:!1,selectArr2:[],updateProductLoading:!1,cnow:0,now:Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff,updateTime:localStorage.getItem("c_products-updateTime")?Number(localStorage.getItem("c_products-updateTime")):0}},watch:{$route:"gotoPage"},mounted(){this.cnow=setInterval(()=>{this.now=Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff},1e3),this.filterParamsDefault=JSON.stringify(this.filterParams),this.getItem(),window.onresize=()=>{this.$getTableHeight(this)}},beforeDestroy(){window.onresize=()=>{}},methods:{formatminute(e){return moment.duration(e/60,"minutes").locale("en").humanize()},updateProducts(){this.updateProductLoading=!0,this.$apiCall("api.ShopifyAccount.getProductByHand",{},e=>{this.updateProductLoading=!1,"9999"==e.ErrorCode?(this.updateTime=e.Data.Results,localStorage.setItem("c_products-updateTime",e.Data.Results),this.$elementMessage("Update Product Success","success")):this.$elementMessage(e.Message,"error")})},delP(e){this.$confirm("Are you sure you want to delete it?","",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"error"}).then(()=>{this.$apiCall("api.Product.deleteByUser",{id:e.id},e=>{9999==e.ErrorCode?(this.$message({message:"deleted successfully",type:"success"}),this.getItem(!0)):this.$elementMessage(e.Message,"error")})}).catch(()=>{})},remoteMethodStores(e){this.selectArr2=[],e&&(this.selectLoading2=!0,this.$apiCall("api.Invoice.findStores",{shopName:e},e=>{this.selectLoading2=!1,9999==e.ErrorCode?this.selectArr2=e.Data.Results:this.$message({message:e.Message,type:"error"})}))},remoteMethodVendor(e){this.selectArr=[],e&&(this.selectLoading=!0,this.$apiCall("api.Relationship.findByCustomer",{name:e},e=>{this.selectLoading=!1,9999==e.ErrorCode?this.selectArr=e.Data.Results:this.$message({message:e.Message,type:"error"})}))},getItem(e){this.loading=!0,this.$apiCall("api.Product.findByUser",{page:this.page,rowsPerPage:this.rowsPerPage,name:this.filterParams.name,relationshipId:this.filterParams.relationshipId,priceFrom:this.filterParams.priceFrom,priceTo:this.filterParams.priceTo,accountId:this.filterParams.accountId},t=>{this.loading=!1,"9999"==t.ErrorCode?(this.items=[],t.Data.Results.forEach(e=>{e.imgUrl=JSON.parse(e.imgsJson).length?JSON.parse(e.imgsJson)[0]:"",e.adminUrl=e.adminUrl.replace(/\\/g,""),e.productUrl=e.productUrl.replace(/\\/g,""),this.items.push(e)}),this.total=Number(t.Data.Pagination.totalCount),this.totalPage=Number(t.Data.Pagination.totalPage),this.$getTableHeight(this),e||(this.$refs.gridTable.$el.scrollTop=0)):this.$elementMessage(t.Message,"error")})},clearFilter(){this.filterParams=JSON.parse(this.filterParamsDefault),this.selectLoading=!1,this.selectArr=[],this.selectLoading2=!1,this.selectArr2=[],1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},filterGetItem(){1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},toPage(e){e!=this.$route.query.page&&this.$router.push({query:{page:e}})},changePageSize(e){this.rowsPerPage=e,localStorage.setItem("c_productsPerPage",e),this.getItem()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()}}}),o=s,l=(a("d613"),a("e607")),n=Object(l["a"])(o,r,i,!1,null,"7e995031",null);t["default"]=n.exports}}]);
//# sourceMappingURL=Products.87e623c1.js.map