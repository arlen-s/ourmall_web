(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ListHistory"],{"0dac":function(t,e,a){},"66f6":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel listHistory"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody mg-b-20"},[e("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-card",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"All",name:"0"}},[e("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),e("el-tab-pane",{attrs:{label:"Waiting",name:"1"}},[e("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),e("el-tab-pane",{attrs:{label:"Processing",name:"2"}},[e("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,action:"2",doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),e("el-tab-pane",{attrs:{label:"Completed",name:"3"}},[e("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1),e("el-tab-pane",{attrs:{label:"Failed",name:"4"}},[e("ListTable",{attrs:{tableData:t.tableData,taskList:t.taskList,action:"4",doneCnt:t.doneCnt,allCnt:t.allCnt},on:{getItem:function(e){return t.getImportTaskDetail()}}})],1)],1)],1)],1),t.tableData.length?e("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",{staticStyle:{"margin-bottom":"30px"}},[e("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSizes,"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1)],1)],1)],1)])},l=[],n=(s("149f"),function(){var t=this,e=t._self._c;return e("div",[t.tableData.length>0?[t.action&&"4"!=t.action?e("div",{staticClass:"d-flex justify-content-between headView"},[this.doneCnt/this.allCnt*100>=0&&this.doneCnt/this.allCnt*100<=100?e("div",{staticClass:"d-flex"},[e("span",{staticClass:"mg-r-10"},[t._v("Upload Progress:")]),e("el-progress",{staticStyle:{width:"500px"},attrs:{"stroke-width":18,percentage:parseInt(this.doneCnt/this.allCnt*100)}})],1):t._e(),t.action&&"4"!=t.action?t._e():e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex"},[t.ids.length?e("div",[t._v(t._s(t.ids.length)+" Selected")]):t._e(),e("el-button",{staticClass:"del",attrs:{type:"primary"},on:{click:function(e){return t.delItems()}}},[t._v("Delete")])],1)])]):e("div",{staticClass:"d-flex headView",staticStyle:{"justify-content":"flex-end"}},[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex"},[t.ids.length?e("div",[t._v(t._s(t.ids.length)+" Selected")]):t._e(),e("el-button",{staticClass:"del",staticStyle:{"margin-bottom":"8px"},attrs:{type:"primary"},on:{click:function(e){return t.delItems()}}},[t._v("Delete")])],1)])])]:t._e(),e("el-table",{ref:"listTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:""},on:{"selection-change":t.handleSelectionChange}},[t.action&&"4"!=t.action?t._e():e("el-table-column",{attrs:{type:"selection",width:"55"}}),e("el-table-column",{attrs:{prop:"img",label:"Img",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.product?e("el-image",{staticClass:"list-img",attrs:{src:a.row.product.mainImg,"preview-src-list":[a.row.product.mainImg],fit:"cover"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})])]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"name",label:"Name",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.product?e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.product.name,placement:"top"}},[e("span",{staticClass:"tx-ellipsis2",staticStyle:{"word-break":"break-all","font-size":"12px"}},[t._v(t._s(a.row.product.name))])]):t._e()]}}])}),e("el-table-column",{attrs:{prop:"sku",label:"Sku",width:"250"},scopedSlots:t._u([{key:"default",fn:function(a){return a.row.stocks?t._l(a.row.stocks,(function(a){return e("div",{key:a.id},[t._v(" "+t._s(a.sku)+" ")])})):void 0}}],null,!0)}),e("el-table-column",{attrs:{prop:"shopname",label:"Store"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.shop?[t._v(" "+t._s(e.row.shop.shopName)+" ")]:void 0}}],null,!0)}),e("el-table-column",{attrs:{prop:"gdprice",label:"Cost Price"},scopedSlots:t._u([{key:"default",fn:function(a){return a.row.stocks?t._l(a.row.stocks,(function(a){return e("div",{key:a.id},[e("span",{staticStyle:{"font-size":"13px"}},[t._v("USD")]),t._v(" "+t._s(a.costPrice)+" ")])})):void 0}}],null,!0)}),e("el-table-column",{attrs:{prop:"price",label:"You Price"},scopedSlots:t._u([{key:"default",fn:function(a){return a.row.stocks?t._l(a.row.stocks,(function(s){return e("div",{key:s.id},[s.yourPrice?e("span",[e("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(a.row.shop.currency?a.row.shop.currency:"USD"))]),t._v(" "+t._s(s.yourPrice.price)+" ")]):e("span",[t._v("---")])])})):void 0}}],null,!0)}),e("el-table-column",{attrs:{prop:"state",label:"State"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("listStatus")(e.row.status))+" ")]}}])}),"4"==t.action?e("el-table-column",{attrs:{prop:"fail",label:"Fail reason"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.extra?[t._v(" "+t._s(e.row.extra.message)+" ")]:void 0}}],null,!0)}):t._e(),e("el-table-column",{attrs:{prop:"time",label:"Start Time"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.moment(1e3*e.row.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),e("el-table-column",{attrs:{prop:"action",label:"Action"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openDetail(a.row.id)}}},[t._v(" Detail")])],1),"2"!=a.row.status?e("div",[e("el-link",{attrs:{type:"danger"},on:{click:function(e){return t.delItems(a.row)}}},[t._v("Delete")])],1):t._e(),"3"==a.row.status?e("div",[e("el-link",{attrs:{type:"success",href:a.row.productUrl,target:"_blank"}},[t._v(" Open in Shopify")])],1):t._e()]}}])})],1),e("el-dialog",{attrs:{visible:t.ListDetail,title:"Product Message","close-on-click-modal":!1,width:"45%"},on:{"update:visible":function(e){t.ListDetail=e}}},[t.newList.product?e("div",{staticClass:"d-flex",staticStyle:{"align-items":"flex-start"}},[e("div",{staticClass:"listItem"},[e("el-image",{staticStyle:{width:"250px",height:"250px"},attrs:{src:t.newList.product.mainImg,fit:"cover"}})],1),e("div",{staticClass:"detail"},[e("div",{staticClass:"name"},[t._v(" "+t._s(t.newList.product.name)+" ")]),e("div",[e("span",[t._v("State: ")]),t._v(t._s(t._f("listStatus")(t.newList.status)))]),e("div",[e("span",[t._v("Store: ")]),t._v(t._s(t.newList.shop.shopName))]),e("div",[e("span",[t._v("Start Time: ")]),t._v(t._s(t.moment(1e3*t.newList.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")]),t.newList.extra.message?e("div",[e("span",[t._v("Fail Reason: ")]),t._v(t._s(t.newList.extra.message)+" ")]):t._e(),e("div",{staticStyle:{width:"100%"}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.newList.stocks,border:""}},[e("el-table-column",{attrs:{label:"SKU",prop:"sku"}}),e("el-table-column",{attrs:{label:"Cost Price"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticStyle:{"font-size":"13px"}},[t._v("USD")]),t._v(" "+t._s(a.row.costPrice)+" ")]}}],null,!1,2565226068)}),e("el-table-column",{attrs:{label:"You Price"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(t.newList.shop.currency?t.newList.shop.currency:"USD"))]),t._v(" "+t._s(a.row.yourPrice.price)+" ")]}}],null,!1,453076805)})],1)],1)])]):t._e()])],2)}),r=[],o={props:["action","status","tableData","taskList","allCnt","doneCnt"],data(){return{newList:{},ListDetail:!1,timer:null,checked:!1,AllChecked:!1,ids:[]}},filters:{listStatus:function(t){switch(t){case"1":return"Waiting";case"2":return"Processing";case"3":return"Succeeded";default:return"Failed"}}},mounted(){},methods:{openDetail(t){this.newList=[],this.tableData.forEach(e=>{t==e.id&&(this.newList=e,this.ListDetail=!0)})},handleSelectionChange(t){this.timer=null,this.ids=[],t.forEach(t=>{this.ids.push(t.id)})},delItems(t){if(t&&this.ids.push(t.id),0==this.ids.length)return this.$elementMessage("Select the task","error"),!1;this.$confirm("Do you want to delete tish task?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.$apiCall("api.Product.delImportTaskDetail",{ids:this.ids},t=>{9999==t.ErrorCode?(this.ids=[],this.allChecked=!1,this.$emit("getItem"),this.$elementMessage("Delete Completed","success")):this.$elementMessage(t.Message,"error")})}).catch(()=>(this.ids=[],!1))}},components:{}},c=o,u=(s("90d1"),s("e607")),d=Object(u["a"])(c,n,r,!1,null,"bebd73b2",null),p=d.exports,m={data(){return{loading:!1,activeName:"2",status:"2",pageSizes:[12,24,48],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_importPerPage")?Number(localStorage.getItem("c_importPerPage")):12,total:0,totalPage:0,doneCnt:0,allCnt:0,tableData:[],taskList:[]}},watch:{$route:"gotoPage"},mounted(){this.getImportTaskDetail(),this.getImportTask(),clearInterval(this.timer),this.timer=setInterval(()=>{this.taskList.length>0?this.getImportTask():(clearInterval(this.timer),this.timer=null)},1e3)},beforeDestroy(){clearInterval(this.timer),this.timer=null},methods:{getImportTask(){this.$apiCall("api.Product.findsImportTask",{},t=>{if(9999==t.ErrorCode){this.taskList=t.Data.Results;let e=0;this.taskList.forEach(t=>{this.doneCnt=e+=Number(t.doneCnt),this.allCnt=e+=Number(t.allCnt)}),this.getImportTaskDetail(a)}}),this.taskList=[...this.taskList]},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t}}):this.getImportTaskDetail()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem("c_importPerPage",t),this.getImportTaskDetail()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getImportTaskDetail()},getImportTaskDetail(t){t||(this.loading=!0),this.$apiCall("api.Product.findsImportTaskDetail",{status:"0"==this.status?null:this.status,page:this.page,rowsPerPage:this.rowsPerPage},e=>{setTimeout(()=>{this.loading=!1},500),9999==e.ErrorCode?t?this.tableData.length!=e.Data.Results.length&&(this.tableData=e.Data.Results):(this.tableData=e.Data.Results,this.total=Number(e.Data.Pagination.totalCount),this.totalPage=Number(e.Data.Pagination.totalPage),this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0):this.$elementMessage(e.Message,"error")})},handleClick(t,e){this.status==t.name?(this.loading=!0,setTimeout(()=>{this.loading=!1},500)):(this.status=t.name,this.getImportTaskDetail())}},components:{ListTable:p}},h=m,g=Object(u["a"])(h,i,l,!1,null,"bdfddb74",null);e["default"]=g.exports},"90d1":function(t,e,a){"use strict";a("0dac")}}]);
//# sourceMappingURL=ListHistory.3a0ab92e.js.map