(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shopify-orders"],{"0526":function(t,e,i){"use strict";i("46ee")},"3b5c":function(t,e,i){"use strict";i("b1e8")},"46ee":function(t,e,i){},"8eb6":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"contentpanel orders-page",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)"}},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-shopify"}),e("h2",[t._v(" "+t._s(1==t.isManage?"All Unfulfilled Shopify Orders":"All Hidden Shopify Orders")+" "),e("em",{staticStyle:{"font-size":"22px"}},[t._v("("+t._s(this.tableData.length)+")")])])])]),e("div",{staticClass:"right"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.exportDialogOpen}},[e("i",{staticClass:"fa fa-download"}),t._v("Export ")]),t.updateTime&&t.updateTime>t.now?[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"The update process has started, it will take a while to finish.",placement:"bottom"}},[e("el-button",{staticStyle:{color:"#FFFFFF","background-color":"#aeb5e2","border-color":"#aeb5e2"},attrs:{type:"primary",size:"medium"}},[e("i",{staticClass:"el-icon-refresh"}),t._v("Update Order ")])],1)]:[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Use this button to update your Order List if missing orders.The process may take a while to finish.",placement:"bottom"}},[e("el-button",{attrs:{disabled:!!(t.updateTime&&t.updateTime>t.now),type:"primary",size:"medium",loading:t.updateOrderLoading},on:{click:t.updateOrder}},[e("i",{staticClass:"el-icon-refresh"}),t._v("Update Order ")])],1)],e("el-button",{attrs:{type:"success"},on:{click:t.openAutomaticSetting}},[e("i",{staticClass:"el-icon-setting el-icon--right"}),t._v(" Automatic dispatch orders setting "),t.ruleCnt?e("span",[t._v("("+t._s(t.ruleCnt)+")")]):t._e()])],2)]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.selectLoading,expression:"selectLoading"}],staticClass:"pagebody"},[e("div",{staticClass:"design-tab-content"},[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"mg-r-10"},[e("el-input",{attrs:{size:"small","prefix-icon":"el-icon-search",placeholder:"Filter orders",clearable:""},on:{input:t.getCodeName,clear:t.clearFilterItems},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getCodeName.apply(null,arguments)}},model:{value:t.codeName,callback:function(e){t.codeName=e},expression:"codeName"}})],1),e("el-button-group",[e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-radio-group",{on:{change:function(e){return t.filterItems("dispatch")}},model:{value:t.dispatchStatus,callback:function(e){t.dispatchStatus=e},expression:"dispatchStatus"}},t._l(t.dispatchArr,(function(i,s){return e("el-radio",{key:s,attrs:{label:s}},[t._v(t._s(i))])})),1),3==t.dispatchStatus&&t.supplierList.length?e("div",[e("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("All vendors")]),e("div",{staticStyle:{margin:"-8px 0 0","padding-left":"22px"}},[t._v("(You could select multiple vendors)")]),e("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedSupplier,callback:function(e){t.checkedSupplier=e},expression:"checkedSupplier"}},t._l(t.supplierList,(function(i){return"999e"!=i.id?e("el-checkbox",{key:i.id,attrs:{label:i.id}},[t._v(t._s(i.vendorName))]):t._e()})),1)],1):t._e(),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.dispatchStatus},on:{click:function(e){return t.clearFilterItems("dispatch")}}},[t._v("Clear")])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("Dispatch Status"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-checkbox-group",{on:{change:function(e){return t.filterItems("store")}},model:{value:t.shopifyStore,callback:function(e){t.shopifyStore=e},expression:"shopifyStore"}},t._l(t.storeList,(function(i){return e("el-checkbox",{key:i.shopifyAccountId,attrs:{label:i.shopifyAccountId}},[t._v(t._s(i.store))])})),1),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.shopifyStore.length},on:{click:function(e){return t.clearFilterItems("store")}}},[t._v("Clear")])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("Shopify Stores"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-radio-group",{on:{change:function(e){return t.filterItems("date")}},model:{value:t.timeFilter,callback:function(e){t.timeFilter=e},expression:"timeFilter"}},t._l(t.dateArr,(function(i,s){return e("el-radio",{key:s,attrs:{label:s}},[t._v(t._s(i))])})),1),6==t.timeFilter?e("div",[e("el-date-picker",{attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"Start","end-placeholder":"End"},on:{change:t.dateChange},model:{value:t.filterDate,callback:function(e){t.filterDate=e},expression:"filterDate"}})],1):t._e(),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.timeFilter},on:{click:function(e){return t.clearFilterItems("date")}}},[t._v("Clear")])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("Date Ranges"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-checkbox-group",{on:{change:function(e){return t.filterItems("fulfill")}},model:{value:t.fulfillStatus,callback:function(e){t.fulfillStatus=e},expression:"fulfillStatus"}},[e("el-checkbox",{attrs:{label:"1"}},[t._v("Unfulfilled")]),e("el-checkbox",{attrs:{label:"2"}},[t._v("Partially fulfilled")])],1),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.fulfillStatus.length},on:{click:function(e){return t.clearFilterItems("fulfill")}}},[t._v("Clear")])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("Fulfillment Status"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-radio-group",{on:{change:function(e){return t.filterItems("sort")}},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},t._l(t.sortArr,(function(i,s){return e("el-radio",{key:s,attrs:{label:s}},[t._v(t._s(i))])})),1),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.sortBy},on:{click:function(e){return t.clearFilterItems("sort")}}},[t._v("Clear")])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v("SortBy"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1)],1),e("div",{staticStyle:{"margin-left":"auto","margin-right":"15px"}},[1==t.isManage?e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.filterItems2(2)}}},[t._v("Show hidden orders")]):t._e(),2==t.isManage?e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.filterItems2(1)}}},[t._v("Show all valid orders")]):t._e()],1)],1),e("div",{ref:"sortWrap",staticClass:"mg-t-20"},[t.dispatchStatus?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("dispatch")}}},[t._v(" "+t._s(t.dispatchArr[t.dispatchStatus])+" "),3==t.dispatchStatus&&t.checkedSupplierName?e("span",[t._v(" "+t._s(t.checkedSupplierName)+" ")]):t._e()]):t._e(),t.shopifyStore.length?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("store")}}},[t._v(t._s(t.shopifyStoreName))]):t._e(),t.timeFilter?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:!t.isShowFilter},on:{close:function(e){return t.clearFilterItems("date")}}},[t._v(" "+t._s(t.dateArr[t.timeFilter])+" "),6==t.timeFilter&&t.filterDate.length?e("span",[t._v(" "+t._s(t.filterDate[0])+"--"+t._s(t.filterDate[1])+" ")]):t._e()]):t._e(),t.fulfillStatus.length?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("fulfill")}}},[t._v(" "+t._s(1==t.fulfillStatus[0]?"Unfulfilled":"Partially fulfilled")),t.fulfillStatus.length>1?e("span",[t._v(","+t._s(1==t.fulfillStatus[1]?"Unfulfilled":"Partially fulfilled"))]):t._e()]):t._e(),t.sortBy?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("sort")}}},[t._v(t._s(t.sortArr[t.sortBy]))]):t._e()],1),e("div",{staticClass:"invoice-list mg-t-20"},[e("ul",{staticClass:"invoice-header"},[e("li",{staticClass:"invoice-item",staticStyle:{width:"63px","max-width":"63px","padding-left":"24px","border-left":"0",position:"relative"}},[t.checkLoading?e("i",{staticClass:"el-icon-loading",staticStyle:{position:"absolute",left:"5px",top:"8px"}}):t._e(),e("el-checkbox",{on:{change:t.checkedAll},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1),e("li",{staticClass:"invoice-item"},[e("a",{attrs:{href:"javascript:;"},on:{click:t.expandChange}},[e("i",{class:t.expandAll?"el-icon-minus":"el-icon-plus"})]),t._v(" Order ID ")]),e("li",{staticClass:"invoice-item"},[t._v("Shopify store")]),e("li",{staticClass:"invoice-item"},[t._v("Date")]),e("li",{staticClass:"invoice-item"},[t._v("Customer")]),e("li",{staticClass:"invoice-item tx-right pd-r-15"},[t._v("Shopify order total")]),e("li",{staticClass:"invoice-item"},[t._v("Fulfillment")]),e("li",{staticClass:"invoice-item"},[t._v("Items")])]),t.tableData?e("div",{ref:"treeWrap",staticClass:"tree-wrap",staticStyle:{"overflow-y":"scroll"},style:{height:t.tableHeight>0?t.tableHeight+"px":"0"}},[e("el-tree",{ref:"treeData",attrs:{props:t.props,data:t.tableData,"show-checkbox":"","node-key":"id","default-expand-all":t.expandAll,"default-expanded-keys":t.expandedKeys,"default-checked-keys":t.defaultChecked},on:{"node-expand":t.handleExpandChange,"check-change":t.handleCheckChange,check:t.handleCheck},scopedSlots:t._u([{key:"default",fn:function({node:i,data:s}){return e("div",{staticClass:"custom-tree-node",attrs:{id:"customTreeNode"+s.id}},[s.span?e("div",{staticClass:"table_info_node table_info_top"},[e("div",{staticClass:"table_info_item"},[s.items&&s.items.length?e("span",{staticStyle:{"font-size":"12px",cursor:"pointer"}},[e("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"700"}}),t._v(" "+t._s(s.codeName)+" ")]):e("span",[e("i",{staticClass:"el-icon-plus",staticStyle:{opacity:"0"}}),t._v(" "+t._s(s.codeName)+" ")])]),e("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[t._v(t._s(s.store))]),e("div",{staticClass:"table_info_item"},[t._v(" "+t._s(t.moment(s.timeCreated).format("ll [at] LTS"))+" ")]),e("div",{staticClass:"table_info_item"},[e("el-popover",{attrs:{"popper-class":"customer-popover",placement:"bottom",title:"Shopify Order "+s.codeName,width:"500",trigger:"hover"}},[e("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.name?s.shippingJson.name:"")+" "),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e("div",{staticClass:"mg-y-15 mg-t-20"},[e("div",{staticClass:"d-flex mg-b-10"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v("Order Date :")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(s.timeCreated?s.timeCreated:"---"))])])]),e("div",{staticClass:"d-flex mg-b-10"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v("Customer :")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.name?s.shippingJson.name:"---")+" ")])])]),e("div",{staticClass:"d-flex mg-b-10"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v("Phone :")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.phone?s.shippingJson.phone:"---")+" ")])])]),e("div",{staticClass:"d-flex mg-b-10"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v("Address:")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.address1?s.shippingJson.address1:"")+" "+t._s(s.shippingJson&&s.shippingJson.city?s.shippingJson.city:"")+" "+t._s(s.shippingJson&&s.shippingJson.province?s.shippingJson.province:"")+" "),e("br"),t._v(" "+t._s(s.shippingJson&&s.shippingJson.country?s.shippingJson.country:"")+" ")])])])])])],1),e("div",{staticClass:"table_info_item tx-right pd-r-15 d-flex"},[s.currency?e("span",[t._v(t._s(t.ce[s.currency]?t.ce[s.currency].symbol:s.currency)+" ")]):t._e(),t._v(" "+t._s(s.totalPrice)+" ")]),e("div",{staticClass:"table_info_item"},[s.fulfillmentStatus?"partial"==s.fulfillmentStatus?e("el-tag",{attrs:{size:"small",type:"partial"==s.fulfillmentStatus?"danger":""}},[e("span",{staticClass:"-EFlq"}),t._v(" "+t._s("partial"==s.fulfillmentStatus?"Partially fulfilled":"Fulfilled")+" ")]):t._e():e("el-tag",{attrs:{size:"small",type:"warning"}},[e("span",{staticClass:"-EFlq"}),t._v(" Unfulfilled ")])],1),e("div",{staticClass:"table_info_item"},[t._v(" "+t._s(s.items?s.items.length:"0")+" Items "),e("el-link",{staticClass:"mg-l-20",staticStyle:{display:"inline"},attrs:{underline:!1,type:"primary"},on:{click:function(e){return t.setOrderHide(s)}}},[t._v(t._s(1==t.isManage?"Hide":"Show")+" this order")])],1)]):e("div",{staticClass:"table_info_node"},[e("div",{staticClass:"table_info_item",staticStyle:{flex:"2",overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("el-image",{staticStyle:{"min-width":"40px",width:"40px",height:"40px",margin:"5px 15px 5px 0",border:"1px solid #ddd"},attrs:{src:s.imgUrl,"preview-src-list":s.previewList}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})])]),e("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[e("p",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"},style:s.disabled?"text-decoration:line-through;":""},[t._v(t._s(s.name))]),e("p",[e("span",{staticStyle:{color:"#999"}},[t._v("SKU: ")]),t._v(t._s(s.sku))])])],1)]),e("div",{staticClass:"table_info_item"},[e("p",{class:s.unfulfillQuantity>0&&s.unfulfillQuantity<s.quantity?"line":""},[t._v(" x "+t._s(s.quantity)+" ")]),s.unfulfillQuantity>0&&s.unfulfillQuantity<s.quantity?e("p",[e("span",[t._v(" x "+t._s(s.unfulfillQuantity)+" ")]),e("span",{staticStyle:{color:"#c05717","margin-left":"20px"}},[t._v("("+t._s(s.fulfillQuantity)+" of "+t._s(s.quantity)+" purchased items are delivered)")])]):t._e(),0==s.unfulfillQuantity?e("p",[e("span",[t._v("("+t._s(s.fulfillQuantity)+" of "+t._s(s.quantity)+" fulfilled)")])]):t._e()]),e("div",{staticClass:"table_info_item"},[e("p",[e("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v("Vendor: ")]),t._v(" "+t._s(s.vendorName?s.vendorName:"---")+" ")]),e("p",[e("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v("Cost per unit: ")]),t._v(" "+t._s(s.costPrice?"US$ "+s.costPrice:"---")+" ")])]),s.invoiceItems?e("div",{staticClass:"table_info_item"},[s.invoiceItems.length>0?[e("el-popover",{attrs:{"popper-class":"items-popover",placement:"bottom",title:`Selected by ${s.invoiceItems.length} purchase Orders`,width:"500",trigger:"hover"}},[e("span",{staticStyle:{"margin-right":"10px",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v("# ("+t._s(s.invoiceItems.length)+")"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._l(s.invoiceItems,(function(i){return e("div",{staticClass:"mg-y-15 mg-t-20"},[e("div",{staticClass:"d-flex mg-b-15"},[e("span",{staticClass:"mg-r-10"},[t._v("# "+t._s(i.code))]),e("span",{staticClass:"mg-r-10"},[t._v(t._s(i.vendorName))]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.gotoInvoice(i)}}},[t._v("View the details")])],1)])}))],2)]:t._e()],2):t._e()])])}}],null,!1,851180723)})],1):t._e()])])]),e("div",{ref:"ordersFooter",staticClass:"alert-wrap d-flex justify-content-between"},[e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"is-bold"},[t._v(t._s(t.selectData.length)+" shopify orders have been selected and can now be dispatched to your vendors.")]),e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"d-flex"},[e("span",{staticStyle:{"margin-right":"10px"}},[t._v("Dispatch to the vendor:")]),e("div",{staticClass:"d-flex align-items-center"},[t._l(t.dynamicTags,(function(i,s){return t.dynamicTags.length>0?e("el-tag",{key:i.id,attrs:{size:"medium",closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(s)}}},[t._v(" "+t._s(i.vendorName)+" ")]):t._e()})),t.inputVisible?e("div",[e("el-popover",{ref:"popoverCustomer",attrs:{"popper-class":"with-shadow with-shadow2",trigger:"manual",width:"300",placement:"bottom"},on:{hide:t.hidepopoverCustomer},model:{value:t.inputVisible2,callback:function(e){t.inputVisible2=e},expression:"inputVisible2"}},[e("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{slot:"reference",size:"medium"},on:{focus:function(e){t.inputVisible2=!t.inputVisible2}},slot:"reference",model:{value:t.vendorName,callback:function(e){t.vendorName=e},expression:"vendorName"}}),e("div",{staticClass:"tx-center change-customer"},[e("div",{staticStyle:{height:"280px","overflow-y":"scroll"}},[t.vendorData.length?e("div",{staticClass:"mg-t-10"},t._l(t.vendorData,(function(i,s){return e("div",{key:s+i.id+i.customerName,staticClass:"text customer-item",class:{active:i.active},on:{click:function(e){return t.selectCustomer(i)}}},[e("div",[e("i",{staticClass:"el-icon-s-custom mg-r-5"}),t._v(t._s(i.vendorName?i.vendorName:"---")+" ")]),e("el-link",{staticStyle:{"font-weight":"normal"},attrs:{type:"primary",underline:!1}},[t._v("Select")])],1)})),0):e("div",{staticClass:"tx-center"},[t._v("No data")])]),e("el-divider"),""==t.vendorName||t.vendorData.length>0?[e("el-button",{attrs:{type:"primary",plain:""},on:{click:t.openAddVendor}},[e("i",{staticClass:"fa fa-user-plus mg-r-10"}),t._v("Add a new vendor")])]:t._e(),t.vendorName&&0==t.vendorData.length?[e("el-button",{attrs:{type:"primary",plain:""},on:{click:t.openAddVendor}},[e("i",{staticClass:"fa fa-user-plus mg-r-10"}),t._v('Add "'+t._s(t.vendorName)+'"')])]:t._e(),e("el-button",{on:{click:t.hidepopoverCustomer}},[t._v("Close")])],2)],1)],1):t._e(),t.inputVisible?t._e():e("div",[e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ "+t._s((t.dynamicTags.length,"Choose a vendor")))])],1)],2)])]),e("div",[e("el-button",{staticClass:"button-new-tag",attrs:{type:"primary",size:"small"},on:{click:t.setOrderHideChecked}},[t._v(t._s(1==t.isManage?"Hide":"Show")+" selected orders")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"button-new-tag mg-l-10",attrs:{type:"success",size:"small"},on:{click:t.getInvocie}},[t._v("Make a purchase order")])],1)]),e("el-dialog",{staticClass:"add-vendor-dialog",attrs:{title:"Add a new vendor",visible:t.addVendorDialog.isShow,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addVendorDialog,"isShow",e)}}},[e("el-divider"),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form",[e("el-form-item",{attrs:{label:"Name","label-width":t.addVendorDialog.labelW,required:""}},[e("el-input",{attrs:{placeholder:"Name","auto-complete":"off"},model:{value:t.addVendorDialog.name,callback:function(e){t.$set(t.addVendorDialog,"name",e)},expression:"addVendorDialog.name"}})],1),e("el-form-item",{attrs:{label:"Email","label-width":t.addVendorDialog.labelW}},[e("el-input",{attrs:{placeholder:"Email","auto-complete":"off"},model:{value:t.addVendorDialog.email,callback:function(e){t.$set(t.addVendorDialog,"email",e)},expression:"addVendorDialog.email"}})],1),e("el-form-item",{attrs:{label:"Remark","label-width":t.addVendorDialog.labelW}},[e("el-input",{attrs:{placeholder:"Remark","auto-complete":"off"},model:{value:t.addVendorDialog.remark,callback:function(e){t.$set(t.addVendorDialog,"remark",e)},expression:"addVendorDialog.remark"}})],1)],1)],1)],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.addVendorDialog.isShow=!1}}},[t._v("Close")]),e("el-button",{attrs:{size:"small",type:"primary",loading:t.addVendorDialog.loading},on:{click:function(e){return t.saveVendor(2)}}},[t._v("Save")])],1)],1),e("el-dialog",{staticClass:"d-block",attrs:{title:"Export orders",visible:t.exportDialog,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){t.exportDialog=e}}},[e("el-divider"),e("div",{staticStyle:{padding:"20px"}},[e("p",{staticClass:"mg-b-10"},[t._v("Export to "+t._s(t.$store.state.userInfo.email))]),e("el-radio-group",{model:{value:t.exportStatus,callback:function(e){t.exportStatus=e},expression:"exportStatus"}},[e("el-radio",{attrs:{label:"1"}},[t._v("All orders")]),e("el-radio",{attrs:{label:"2",disabled:!t.selectData.length}},[t._v("Selected: "+t._s(t.selectData.length)+" orders")]),e("el-radio",{attrs:{label:"3"}},[t._v(t._s(t.totalCount)+" orders matching your search")])],1)],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.exportDialog=!1}}},[t._v("Cancel")]),e("el-button",{attrs:{size:"small",type:"primary",disabled:!t.exportStatus,loading:t.exportLoading},on:{click:t.exportOrders}},[t._v("Export orders")])],1)],1),e("el-dialog",{staticClass:"dialog-automatic",attrs:{visible:t.automaticSettingDialog.isShow,title:"Automatic dispatch orders setting"},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShow",e)}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.automaticSettingDialog.loading,expression:"automaticSettingDialog.loading"}],staticClass:"automatic-body"},[e("div",{staticStyle:{"margin-bottom":"15px"}},[e("el-alert",{attrs:{title:"The unfulfilled shopify order will be dispatched to the vendor according to the optimization apportion rules which you made. You can set up an automatic advice to your vendor to check order and offer quotation.",type:"warning","show-icon":"",closable:!1}})],1),t.automaticSettingDialog.openRulestatus?[e("div",{staticStyle:{"margin-bottom":"15px",padding:"15px",border:"1px #DCDFE6 solid"}},[e("div",{staticClass:"d-flex",staticStyle:{"margin-bottom":"10px"}},[e("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:t.automaticSettingDialog.allProducts},model:{value:t.automaticSettingDialog.productIds,callback:function(e){t.$set(t.automaticSettingDialog,"productIds",e)},expression:"automaticSettingDialog.productIds"}},t._l(t.automaticSettingDialog.products,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name.substring(0,18),value:i.id}},[e("div",{staticClass:"product-select-opt"},[e("div",{staticClass:"img-wrap",style:{backgroundImage:`url(${i.img})`}}),e("div",{staticClass:"info"},[e("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(i.name))]),e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v(t._s(i.currency))]),i.minShopPrice==i.maxShopPrice?e("span",[t._v(t._s(i.minShopPrice))]):e("span",[t._v(t._s(i.minShopPrice)+" - "+t._s(i.maxShopPrice))])])])])])})),1),e("el-checkbox",{staticStyle:{"margin-right":"25px","margin-bottom":"0"},model:{value:t.automaticSettingDialog.allProducts,callback:function(e){t.$set(t.automaticSettingDialog,"allProducts",e)},expression:"automaticSettingDialog.allProducts"}},[t._v(" Choose my all Shopify products ")]),e("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:t.automaticSettingDialog.vendorId,callback:function(e){t.$set(t.automaticSettingDialog,"vendorId",e)},expression:"automaticSettingDialog.vendorId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return e("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1),e("div",[t._v(" Every "),e("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"circle period"},model:{value:t.automaticSettingDialog.period,callback:function(e){t.$set(t.automaticSettingDialog,"period",e)},expression:"automaticSettingDialog.period"}},t._l(15,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t+""}})})),1),t._v(" day(s) ")],1)],1),e("div",[e("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:t.automaticSettingDialog.visibilityType,callback:function(e){t.$set(t.automaticSettingDialog,"visibilityType",e)},expression:"automaticSettingDialog.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1),e("el-select",{staticStyle:{"margin-right":"25px",width:"100px"},attrs:{size:"mini"},model:{value:t.automaticSettingDialog.status,callback:function(e){t.$set(t.automaticSettingDialog,"status",e)},expression:"automaticSettingDialog.status"}},[e("el-option",{attrs:{label:"Enabled",value:"1"}}),e("el-option",{attrs:{label:"Disabled",value:"2"}})],1),e("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,loading:t.automaticSettingDialog.saveRuleLoading,type:"primary",size:"mini"},on:{click:function(e){return t.saveRule()}}},[t._v("Save Rule")]),e("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!1)}}},[t._v("Cancel")])],1)])]:e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!0)}}},[t._v("+ Add a dispatch rule")])],1),e("div",[e("el-table",{ref:"autoSettingTable",staticClass:"auto-setting-table",staticStyle:{width:"100%"},attrs:{data:t.automaticSettingDialog.items,"row-key":"id",stripe:"",height:"300"}},[e("el-table-column",{attrs:{label:"Priority",width:"110"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"el-icon-d-caret"}),t._v(" "+t._s(i.$index+1)+" "),i.$index?t._e():e("span",{staticStyle:{color:"#C0C4CC"}},[t._v("(Highest)")])]}}])}),e("el-table-column",{attrs:{label:"Products in Shopify",width:"240"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("div",{staticClass:"d-flex"},[e("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:i.row.editMode.allProducts},model:{value:i.row.editMode.productIds,callback:function(e){t.$set(i.row.editMode,"productIds",e)},expression:"scope.row.editMode.productIds"}},t._l(t.automaticSettingDialog.products,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name.substring(0,18),value:i.id}},[e("div",{staticClass:"product-select-opt"},[e("div",{staticClass:"img-wrap",style:{backgroundImage:`url(${t.stockImg(i)})`}}),e("div",{staticClass:"info"},[e("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(i.name))]),e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v(t._s(i.currency))]),i.minPrice==i.maxPrice?e("span",[t._v(t._s(i.minPrice))]):e("span",[t._v(t._s(i.minPrice)+" - "+t._s(i.maxPrice))])])])])])})),1),e("el-checkbox",{staticStyle:{"margin-bottom":"0"},model:{value:i.row.editMode.allProducts,callback:function(e){t.$set(i.row.editMode,"allProducts",e)},expression:"scope.row.editMode.allProducts"}},[t._v(" all ")])],1):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!i.row.editMode,expression:"!scope.row.editMode"}],staticClass:"d-flex",on:{click:function(e){return t.showProducts(i.row)}}},[i.row.products.length?[t._l(i.row.products,(function(i,s){return[s<5?e("el-image",{key:i.id,staticStyle:{width:"26px",height:"26px","margin-right":"5px"},attrs:{src:t.stockImg(i),fit:"contain",lazy:""}},[e("div",{staticClass:"image-slot",staticStyle:{color:"#C0C4CC","text-align":"center"},attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e()]})),i.row.productCnt>5?[e("span",{staticStyle:{color:"#909399"}},[t._v(" ... ("),e("span",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(i.row.productCnt))]),t._v(") ")])]:t._e()]:[t._v("My all Shopify products")]],2)]}}])}),e("el-table-column",{attrs:{label:"Dispatch to vendor",width:"180",prop:"vendorName"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"170px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:i.row.editMode.relationshipId,callback:function(e){t.$set(i.row.editMode,"relationshipId",e)},expression:"scope.row.editMode.relationshipId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return e("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1):e("span",[t._v(t._s(i.row.vendorName))])]}}])}),e("el-table-column",{attrs:{label:"Cycle Time",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("div",[e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"period"},model:{value:i.row.editMode.period,callback:function(e){t.$set(i.row.editMode,"period",e)},expression:"scope.row.editMode.period"}},t._l(15,(function(i){return e("el-option",{key:i,attrs:{label:i,value:i+""}},[e("span",[t._v(t._s(i))]),t._v(" "),e("span",{staticStyle:{color:"#C0C4CC"}},[t._v("day(s)")])])})),1)],1):e("span",[t._v(" Every "+t._s(i.row.period)+" day(s) ")])]}}])}),e("el-table-column",{attrs:{label:"Vendor visibility",width:"170"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:i.row.editMode.visibilityType,callback:function(e){t.$set(i.row.editMode,"visibilityType",e)},expression:"scope.row.editMode.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1):e("span",[t._v(t._s(t.visibilityTypeArr[i.row.visibilityType]))])]}}])}),e("el-table-column",{attrs:{label:"Rule status",width:"110"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:i.row.editMode.status,callback:function(e){t.$set(i.row.editMode,"status",e)},expression:"scope.row.editMode.status"}},[e("el-option",{attrs:{label:"Enabled",value:"1"}}),e("el-option",{attrs:{label:"Disabled",value:"2"}})],1):e("el-tag",{attrs:{type:1==i.row.status?"success":"danger","disable-transitions":!0}},[t._v(" "+t._s(1==i.row.status?"Enabled":"Disabled")+" ")])]}}])}),e("el-table-column",{attrs:{label:"Action"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?[e("el-button",{attrs:{loading:i.row.loading,disabled:i.row.loading,size:"mini",type:"primary"},on:{click:function(e){return t.saveEditRule(i.row)}}},[t._v("Save Rule")]),e("el-button",{attrs:{disabled:i.row.loading,size:"mini"},on:{click:function(e){return t.cancelEditRule(i.row)}}},[t._v("Cancel")])]:[e("el-link",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.editRule(i.row)}}},[t._v("Edit")]),e("el-link",{staticStyle:{"margin-right":"10px"},attrs:{disabled:i.row.statusLoading,type:1==i.row.status?"danger":"success"},on:{click:function(e){return t.changeRuleStatus(i.row)}}},[t._v(" "+t._s(1==i.row.status?"Disable":"Enable")+" ")]),e("el-popconfirm",{attrs:{title:"Do you want to delete it",iconColor:"red",confirmButtonText:"Delete",cancelButtonText:"Cancel"},on:{onConfirm:function(e){return t.delRuleStatus(i.row,i.$index)}}},[e("el-link",{attrs:{slot:"reference",disabled:i.row.delLoading,type:"danger"},slot:"reference"},[t._v("Delete")])],1)]]}}])})],1)],1)],2),e("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"footer"},slot:"footer"},[e("div",[t._v(" Only matching last "),e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},on:{change:t.changeDay},model:{value:t.automaticSettingDialog.day,callback:function(e){t.$set(t.automaticSettingDialog,"day",e)},expression:"automaticSettingDialog.day"}},t._l(t.automaticSettingDialog.dayArr,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1),t._v(" days unfulfilled orders ")],1),e("div",[e("el-button",{attrs:{disabled:t.automaticSettingDialog.loading},on:{click:function(e){t.automaticSettingDialog.isShow=!1}}},[t._v("Close")]),e("el-button",{attrs:{type:"primary",loading:t.automaticSettingDialog.loading},on:{click:t.dispatchRuleTest}},[t._v(" Dispatch rule TEST ")])],1)]),e("el-dialog",{attrs:{width:"30%",title:"Dispatch rule Test Preview",visible:t.automaticSettingDialog.previewShow,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"previewShow",e)}}},[e("div",{staticStyle:{padding:"20px"}},[e("p",{staticStyle:{"margin-bottom":"10px"}},[t._v(" According to your settings, we found some data for you: ")]),e("p",[t._v(" Shopify order: "),e("b",{staticStyle:{"margin-right":"15px",color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.orderCnt))]),t._v(" (Dispatch to "),e("b",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.vendorCnt))]),t._v(" vendor(s)) ")])]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{disabled:t.automaticSettingDialog.runLoading},on:{click:function(e){t.automaticSettingDialog.previewShow=!1}}},[t._v(" Dispatch in the Next Cycle ")]),e("el-button",{attrs:{loading:t.automaticSettingDialog.runLoading,disabled:t.automaticSettingDialog.runLoading,type:"primary"},on:{click:t.runDispatchRule}},[t._v("Dispatch Immediately")])],1)]),e("el-dialog",{attrs:{width:"50%",title:"Products",visible:t.automaticSettingDialog.isShowProducts,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShowProducts",e)}}},[e("div",{staticClass:"preview-product-list"},t._l(t.automaticSettingDialog.showProductsItems,(function(i){return e("div",{key:i.id,staticClass:"pro"},[e("el-image",{staticStyle:{width:"160px",height:"160px"},attrs:{src:t.stockImg(i),fit:"contain"}}),e("div",{staticClass:"name tx-ellipsis2",attrs:{title:i.name}},[t._v(" "+t._s(i.name)+" ")])],1)})),0),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.automaticSettingDialog.isShowProducts=!1}}},[t._v("Close")])],1)])],1)],1)},a=[],o=(i("149f"),i("fef2"),i("2480")),l={data(){return{dynamicTags:[],inputVisible:!1,inputVisible2:!1,vendorName:"",loading:!1,tableHeight:400,page:1,rowsPerPage:100,items:[],totalCount:0,totalPage:0,updateOrderLoading:!1,cnow:0,now:Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff,updateTime:localStorage.getItem("c_orders-updateTime")?Number(localStorage.getItem("c_orders-updateTime")):0,dispatchStatus:"",sortBy:"",fulfillStatus:[],timeFilter:"",shopifyStore:[],dateRangeValue:"",codeName:"",dateArr:{1:"Today",2:"Last 7 days",3:"Last 30 days",4:"Last 90 days",5:"Last 12 months",6:"Custom"},sortArr:{1:"Order number (ascending)",2:"Order number (descending)",3:"Date (oldest first)",4:"Date (newest first)"},dispatchArr:{1:"All",2:"Not dispatched to vendor",3:"Dispatched to vendor"},tableData:[],tableDataTab1:[],multipleSelection:[],multipleSelectionSub:[],getRowKey(t){return t.id},getRowKeyChild(t){return t.id},props:{label:"id",children:"items"},checked:!1,filterDate:[],dateFrom:"",dateTo:"",storeList:[],shopifyStoreName:"",supplierList:[],isIndeterminate:!1,checkedSupplier:[],checkedSupplierName:"",checkAll:!1,vendorData:[],addVendorDialog:{isShow:!1,loading:!1,labelW:"120px",name:"",remark:"",email:"",id:""},addVendorDialogDefault:"{}",selectData:[],selectDataNoHalf:[],expandedKeys:[],expandAll:!1,exportDialog:!1,exportStatus:"",exportLoading:!1,automaticSettingDialog:{loading:!1,isShow:!1,getProductsloading:!1,allProducts:!1,products:[],productIds:[],getVendorsloading:!1,vendorId:"",vendors:[],period:"",visibilityType:"",status:"1",saveRuleLoading:!1,openRulestatus:!1,page:1,rowsPerPage:10,total:0,totalPage:0,items:[],previewShow:!1,vendorCnt:0,orderCnt:0,isShowProducts:!1,showProductsItems:[],day:30,dayArr:[7,10,15,20,30,45,60],runLoading:!1},automaticSettingDialogDefault:"{}",visibilityTypeArr:{1:"Auto dispatch",2:"After my reconfirm"},ruleCnt:0,isManage:1,defaultChecked:[],selectLoading:!1,checkLoading:!1,ce:this.$CE}},components:{},watch:{"$store.state.userInfo"(){this.$store.state.userInfo.ruleCnt&&(this.ruleCnt=this.$store.state.userInfo.ruleCnt)},shopifyStore(){if(!this.shopifyStore.length)return;let t=[];this.shopifyStore.forEach(e=>{this.storeList.forEach(i=>{e==i.shopifyAccountId&&t.push(i.store)})}),this.shopifyStoreName=t.join(",")},checkedSupplier(){if(!this.checkedSupplier.length)return;let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&"999e"!=i.id&&t.push(i.vendorName)})}),this.checkedSupplierName=t.join(",")},isShowFilter(){this.isShowFilter&&(this.timeFilter=3)}},computed:{isShowFilter(){return!(this.sortBy||this.fulfillStatus.length||this.shopifyStore.length||this.codeName||this.dispatchStatus)},isAll(){return this.selectData.length==this.tableData.length&&this.tableData.length>0}},mounted(){this.automaticSettingDialogDefault=JSON.stringify(this.automaticSettingDialog),this.addVendorDialogDefault=JSON.stringify(this.addVendorDialog),window.onresize=()=>{this.$getTableHeight(this)},this.$nextTick(()=>{this.getItems(),this.getStore(),this.getVendor()}),this.cnow=setInterval(()=>{this.now=Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff},1e3),this.timeFilter=3,"999e"==this.$route.params.vid&&(this.timeFilter=""),this.$route.params.id&&(this.timeFilter=""),this.checkedSupplier=[]},beforeRouteEnter(t,e,i){i(t=>{t.loading=!0})},beforeDestroy(){clearInterval(this.cnow)},methods:{setOrderHideChecked(){this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHide",{orderIds:this.selectDataNoHalf,type:1==this.isManage?2:1},t=>{this.$hideLoading(),9999==t.ErrorCode?this.getItems():(this.$hideLoading(),this.$elementMessage(t.Message,"error"))})},setOrderHide(t){let e=[];e.push(t.id),this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHide",{orderIds:e,type:1==this.isManage?2:1},t=>{9999==t.ErrorCode?this.getItems():(this.$hideLoading(),this.$elementMessage(t.Message,"error"))})},changeDay(){this.$apiCall("api.DispatchOrderRule.setMatchTime",{day:this.automaticSettingDialog.day},t=>{9999==t.ErrorCode?this.$root.$children[0].checkLogin():this.$elementMessage(t.Message,"error")})},showProducts(t){if(!t.products.length)return;let e=()=>{this.automaticSettingDialog.showProductsItems=t.products,this.automaticSettingDialog.isShowProducts=!0};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},i=>{this.automaticSettingDialog.loading=!1,9999==i.ErrorCode?(t.products=i.Data.Results,e()):this.$elementMessage(i.Message,"error")})):e()},runDispatchRule(){this.automaticSettingDialog.runLoading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{isGenerate:1},t=>{this.automaticSettingDialog.runLoading=!1,9999==t.ErrorCode?(this.$elementMessage("success","success"),this.automaticSettingDialog.isShow=!1,this.automaticSettingDialog.previewShow=!1,this.getItems()):this.$elementMessage(t.Message,"error")})},dispatchRuleTest(){this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{},t=>{this.automaticSettingDialog.loading=!1,9999==t.ErrorCode?(this.automaticSettingDialog.vendorCnt=t.Data.Results.vendorCnt,this.automaticSettingDialog.orderCnt=t.Data.Results.orderCnt,this.automaticSettingDialog.previewShow=!0):this.$elementMessage(t.Message,"error")})},delRuleStatus(t,e){t.delLoading=!0,this.$apiCall("api.DispatchOrderRule.deleteRule",{id:t.id},i=>{t.delLoading=!1,9999==i.ErrorCode?(this.automaticSettingDialog.items.splice(e,1),this.ruleCnt=this.automaticSettingDialog.items.length):this.$elementMessage(i.Message,"error")})},changeRuleStatus(t){t.statusLoading=!0,this.$apiCall("api.DispatchOrderRule.setStatus",{id:t.id},e=>{t.statusLoading=!1,9999==e.ErrorCode?this.$set(t,"status",1==t.status?"2":"1"):this.$elementMessage(e.Message,"error")})},editRule(t){let e=()=>{this.automaticSettingDialog.getProductsloading=!1,this.automaticSettingDialog.getVendorsloading=!1,this.automaticSettingDialog.items.forEach(t=>{this.$set(t,"editMode",null)}),t.editMode={id:t.id,relationshipId:t.relationshipId,period:t.period,visibilityType:t.visibilityType,status:t.status,productIds:[],allProducts:!t.products.length},this.automaticSettingDialog.vendors=[{vendorName:t.vendorName,id:t.relationshipId}],this.automaticSettingDialog.products=t.products,this.$nextTick(()=>{this.automaticSettingDialog.products.forEach(e=>{t.editMode.productIds.push(e.id)})})};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},i=>{this.automaticSettingDialog.loading=!1,9999==i.ErrorCode?(t.products=i.Data.Results,e()):this.$elementMessage(i.Message,"error")})):e()},stockImg(t){return JSON.parse(t.imgsJson)[0]},cancelEditRule(t){this.$set(t,"editMode",null)},saveEditRule(t){if(!t.editMode.allProducts&&!t.editMode.productIds.length)return void this.$elementMessage("Please select the products","error");if(!t.editMode.relationshipId)return void this.$elementMessage("Please select the vendor","error");if(!t.editMode.period)return void this.$elementMessage("Please select the circle period","error");if(!t.editMode.visibilityType)return void this.$elementMessage("Please select the vendow visibility","error");t.loading=!0;const e={id:t.editMode.id,relationshipId:t.editMode.relationshipId,period:t.editMode.period,visibilityType:t.editMode.visibilityType,productIds:t.editMode.productIds,status:t.editMode.status};t.editMode.allProducts&&(e.productIds=[]),this.$apiCall("api.DispatchOrderRule.changeByCustomer",e,e=>{t.loading=!1,9999==e.ErrorCode?(this.$set(t,"editMode",null),this.getAutomaticSettingItems()):this.$elementMessage(e.Message,"error")})},saveRule(){if(!this.automaticSettingDialog.allProducts&&!this.automaticSettingDialog.productIds.length)return void this.$elementMessage("Please select the products","error");if(!this.automaticSettingDialog.vendorId)return void this.$elementMessage("Please select the vendor","error");if(!this.automaticSettingDialog.period)return void this.$elementMessage("Please select the Period","error");if(!this.automaticSettingDialog.visibilityType)return void this.$elementMessage("Please select the vendow visibility","error");this.automaticSettingDialog.saveRuleLoading=!0;const t={relationshipId:this.automaticSettingDialog.vendorId,period:this.automaticSettingDialog.period,visibilityType:this.automaticSettingDialog.visibilityType,productIds:this.automaticSettingDialog.productIds,status:this.automaticSettingDialog.status};this.automaticSettingDialog.allProducts&&(t.productIds=[]),this.$apiCall("api.DispatchOrderRule.addByCustomer",t,t=>{this.automaticSettingDialog.saveRuleLoading=!1,9999==t.ErrorCode?(this.changeOpenAddRule(!1),this.getAutomaticSettingItems()):this.$elementMessage(t.Message,"error")})},changeOpenAddRule(t){this.automaticSettingDialog.openRulestatus=t,t&&(this.automaticSettingDialog.getProductsloading=!1,this.automaticSettingDialog.allProducts=!1,this.automaticSettingDialog.products=[],this.automaticSettingDialog.productIds=[],this.automaticSettingDialog.getVendorsloading=!1,this.automaticSettingDialog.vendorId="",this.automaticSettingDialog.vendors=[],this.automaticSettingDialog.period="",this.automaticSettingDialog.visibilityType="",this.automaticSettingDialog.status="1")},remoteMethodGetVendors(t){t&&(this.automaticSettingDialog.getVendorsloading=!0,this.$apiCall("api.Relationship.findByCustomer",{name:t},t=>{this.automaticSettingDialog.getVendorsloading=!1,9999==t.ErrorCode&&(this.automaticSettingDialog.vendors=t.Data.Results)}))},remoteMethodGetProducts(t){t&&(this.automaticSettingDialog.getProductsloading=!0,this.$apiCall("api.Product.findByUser",{name:t},t=>{this.automaticSettingDialog.getProductsloading=!1,9999==t.ErrorCode&&(this.automaticSettingDialog.products=[],t.Data.Results.forEach(t=>{JSON.parse(t.imgsJson).length&&(t.img=JSON.parse(t.imgsJson)[0]),this.automaticSettingDialog.products.push(t)}))}))},getAutomaticSettingItems(t){t||(this.automaticSettingDialog.loading=!0);const e={};this.$apiCall("api.DispatchOrderRule.findByCustomer",e,t=>{this.automaticSettingDialog.loading=!1,9999==t.ErrorCode?(this.automaticSettingDialog.items=[],t.Data.Results.forEach(t=>{t.loading=!1,t.statusLoading=!1,t.delLoading=!1,t.editMode=null,this.automaticSettingDialog.items.push(t)}),this.ruleCnt=this.automaticSettingDialog.items.length):this.$elementMessage(t.Message,"error")})},openAutomaticSetting(){this.automaticSettingDialog=JSON.parse(this.automaticSettingDialogDefault),this.automaticSettingDialog.day=this.$store.state.userInfo.config&&this.$store.state.userInfo.config.matchDay?this.$store.state.userInfo.config.matchDay:30,this.automaticSettingDialog.isShow=!0,this.getAutomaticSettingItems(),this.$nextTick(()=>{const t=this.$refs.autoSettingTable.$refs.bodyWrapper.childNodes[0].childNodes[1],e=this;o["default"].create(t,{onEnd({newIndex:t,oldIndex:i}){let s={};i>t?(s.id=e.automaticSettingDialog.items[i].id,s.toId=e.automaticSettingDialog.items[t].id):(s.id=e.automaticSettingDialog.items[i].id,s.toId=t==e.automaticSettingDialog.items.length-1?"":e.automaticSettingDialog.items[t+1].id),e.$apiCall("api.DispatchOrderRule.changeSort",s,t=>{e.getAutomaticSettingItems(!0),9999!=t.ErrorCode&&e.$elementMessage(t.Message,"error")});const a=e.automaticSettingDialog.items.splice(i,1)[0];e.automaticSettingDialog.items.splice(t,0,a)}})})},getStore(){this.storeList=[],this.$apiCall("api.Invoice.findStores",{authStatus:1},t=>{if(9999==t.ErrorCode){if(!t.Data.Results.length)return;t.Data.Results.forEach(t=>{this.storeList.push({shopifyAccountId:t.id,store:t.shopName})})}else this.$message({message:t.Message,type:"error"})})},exportOrders(){let t={email:this.$store.state.userInfo.email,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName},e={email:this.$store.state.userInfo.email};if(2==this.exportStatus&&(t.ids=this.selectData.length?this.selectData:[]),3==this.exportStatus&&(2==this.dispatchStatus&&(t.fulfillType=1),3==this.dispatchStatus)){t.fulfillType=2;let e=[];this.checkedSupplier.forEach(t=>{this.supplierList.forEach(i=>{t==i.id&&e.push(i.id)})}),t.fulfillRelationshipIds=e}this.exportLoading=!0,this.$apiCall("api.Invoice.exportShopifyOrders",1==this.exportStatus?e:t,t=>{this.exportLoading=!1,9999==t.ErrorCode?(this.exportDialog=!1,this.$message({offset:200,duration:0,dangerouslyUseHTMLString:!0,showClose:!0,message:`<strong>Your Orders are exporting</strong><br/>Your export will be delivered by email to: ${this.$store.state.userInfo.email}. <br/>Depending on how many Orders you’re exporting, this could take some time.`,type:"success"})):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})},exportDialogOpen(){this.exportDialog=!0,this.exportStatus="",this.exportLoading=!1},openAddVendor(){this.addVendorDialog=JSON.parse(this.addVendorDialogDefault),this.addVendorDialog.name=this.vendorName,this.addVendorDialog.isShow=!0},saveVendor(t){if(!this.addVendorDialog.name)return void this.$elementMessage("Customer name required","error");this.addVendorDialog.loading=!0;let e="api.Relationship.addByCustomer",i={name:this.addVendorDialog.name,email:this.addVendorDialog.email,remark:this.addVendorDialog.remark};this.$apiCall(e,i,e=>{this.addVendorDialog.loading=!1,9999==e.ErrorCode?(this.vendorName="",this.addVendorDialog.isShow=!1,this.$elementMessage("Customers successfully added","success"),2==t?(this.dynamicTags.push({id:e.Data.Results,vendorName:this.addVendorDialog.name}),this.inputVisible=!1,this.vendorName=""):this.showInput(),this.getVendor()):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},getInvocie(){let t=this.$refs.treeData.getCheckedNodes(),e=[],i=[];this.dynamicTags.length?t.length?(t.forEach(t=>{t.items||e.push(t.oldid)}),this.dynamicTags.forEach(t=>{i.push(t.id)}),this.$showLoading(),this.$apiCall("api.Invoice.genInvoice",{skus:e,relationshipId:i},t=>{this.$hideLoading(),"9999"==t.ErrorCode?(this.$elementMessage("A new order successfully created","success"),sessionStorage.setItem("c_selectedSaveInfo",JSON.stringify(t.Data.Results)),setTimeout(()=>{this.$router.push({name:"invoices",params:{saveCode:!0}})},1e3)):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})):this.$elementMessage("Please choose an item","error"):this.$elementMessage("Please choose an vendor","error")},changeCustomerName(){window.lazy&&window.clearTimeout(window.lazy),window.lazy=setTimeout(()=>{this.$apiCall("api.Relationship.findByCustomer",{name:this.vendorName},t=>{"9999"==t.ErrorCode?this.vendorData=t.Data.Results:(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})},400)},getVendor(){this.$apiCall("api.Relationship.findByCustomer",{},t=>{"9999"==t.ErrorCode?(this.vendorData=t.Data.Results,1==t.Data.Results.length&&this.dynamicTags.push(t.Data.Results[0])):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})},selectCustomer(t){this.dynamicTags=[],setTimeout(()=>{this.inputVisible=!1,this.inputVisible2=!1,this.vendorName="",this.dynamicTags.push(t)},300)},handleClose(t){this.dynamicTags.splice(t,1)},showInput(){this.inputVisible=!0,this.$nextTick(t=>{this.$refs.saveTagInput.$refs.input.focus()})},hidepopoverCustomer(){setTimeout(()=>{this.inputVisible=!1,this.inputVisible2=!1},100)},handleCheckAllChange(t){let e=[];if(this.supplierList.forEach(t=>{e.push(t.id)}),this.checkedSupplier=t?e:[],this.isIndeterminate=!1,1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&"999e"!=e&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}},handleCheckedCitiesChange(t){let e=t.length;if(this.checkAll=e===this.supplierList.length-1,this.isIndeterminate=e>0&&e<this.supplierList.length-1,1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}},dateChange(){this.filterDate.length>1&&(this.dateFrom=moment(this.filterDate[0]).unix(),this.dateTo=moment(this.filterDate[1]).endOf("d").unix(),this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems())},changeSupplierTag(t){this.$showLoading();var e=this.$refs.treeData.store.nodesMap;for(var i in e)e[i].expanded=!1;setTimeout(()=>{this.expandedKeys=[],"999e"!=t.id&&(this.dynamicTags=[],this.dynamicTags.push({id:t.id,vendorName:t.vendorName})),this.supplierTag=t.id,this.storeTag="";let e=[];t.listInfo.length&&(t.listInfo.forEach(t=>{e.push(t.id),t.items&&t.items.length&&t.items.forEach(t=>{e.push(t.id)})}),this.$hideLoading()),this.tableData=this.tableDataTab1;let i=JSON.parse(JSON.stringify(this.tableDataTab1));i.forEach((t,e)=>{i[e].items=[]}),e.length&&(e.forEach(t=>{this.tableData.forEach((e,s)=>{e.items.forEach((e,a)=>{t==e.id&&i[s].items.push(e)})})}),this.tableData=[],i.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))},300)},filterItems2(t){this.isManage=t,this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems()},filterItems(t){switch(t){case"dispatch":return this.checkedSupplier=[],this.checkAll=!1,void(1==this.dispatchStatus?(this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.getItems()):2==this.dispatchStatus&&this.supplierList.forEach(t=>{"999e"==t.id&&this.changeSupplierTag(t)}));case"store":break;case"date":if(this.filterDate=[],this.dateFrom="",this.dateTo="",6==this.timeFilter)return;break;case"fulfill":break;case"sort":break;default:break}this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems()},getCodeName(){this.codeName&&(window.lazycodeName&&window.clearTimeout(window.lazycodeName),window.lazycodeName=setTimeout(()=>{this.checked=!1,this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.getItems()},400))},clearFilterItems(t){switch((this.$route.params.id||"999e"==this.$route.params.vid)&&window.location.reload(),t){case"dispatch":this.dispatchStatus="",this.checkedSupplier=[],this.isIndeterminate=!1;break;case"store":this.shopifyStore=[];break;case"date":this.timeFilter="",this.filterDate=[],this.dateFrom="",this.dateTo="";break;case"fulfill":this.fulfillStatus=[];break;case"sort":this.sortBy="";break;default:this.codeName="";break}this.dynamicTags=[],this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.isShowFilter&&(this.timeFilter=3),this.getItems()},expandChange(){this.$showLoading(),this.expandAll=!this.expandAll,this.$nextTick(()=>{let t=this.$refs.treeData.store.nodesMap;for(var e in t)t[e].expanded=this.expandAll;this.$hideLoading()})},gotoInvoice(t){let e=this.$router.resolve({path:"/i/"+t.uniCode});window.open(e.href,"_blank")},handleCheckChange(t){},handleCheck(){this.$refs.treeData.getCheckedKeys();this.selectData=[];let t=this.$refs.treeData.getCheckedNodes().concat(this.$refs.treeData.getHalfCheckedNodes());t.forEach(t=>{t.items&&this.selectData.push(t.id)}),this.selectDataNoHalf=this.selectData;let e=this.$refs.treeData.getCheckedNodes();e.forEach(t=>{t.items&&this.selectDataNoHalf.push(t.id)})},changeAllCheck(t){console.log(t),this.checkLoading=!0;let e=0;this.tableData.length&&this.tableData.forEach(t=>{e++}),this.tableData.length==e&&setTimeout(()=>{this.checkLoading=!1},1600),setTimeout(()=>{this.defaultChecked=[];if(t){let t=[];this.tableData.length&&this.tableData.forEach(e=>{t.push(e.id),this.defaultChecked.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})}),this.$refs.treeData.setCheckedKeys(t)}else this.$refs.treeData.setCheckedKeys([]);this.handleCheck()},600)},checkedAll(){this.selectData.length?this.checked=!0:this.checked=!1,this.checkLoading=!0;let t=0;this.tableData.length&&this.tableData.forEach(e=>{t++}),this.tableData.length==t&&setTimeout(()=>{this.checkLoading=!1},1600),setTimeout(()=>{if(this.selectData.length?this.checked=!1:this.checked=!0,this.defaultChecked=[],this.checked){let t=[];this.tableData.length&&this.tableData.forEach(e=>{t.push(e.id),this.defaultChecked.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})}),this.$refs.treeData.setCheckedKeys(t)}else this.$refs.treeData.setCheckedKeys([]);this.handleCheck()},600)},handleExpandChange(t,e,i){this.$showLoading(),this.$apiCall("api.Invoice.getItemsInvoice",{id:t.id},e=>{if(this.$hideLoading(),"9999"==e.ErrorCode)for(var i in e.Data.Results)t.items.forEach(t=>{i==t.id&&this.$set(t,"invoiceItems",e.Data.Results[i])});else this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure()})},getItems(){this.loading=!0,this.tableData=[],this.tableDataTab1=[],this.page=1;let t={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName,isManage:this.isManage};this.$apiCall("api.Invoice.shopifyOrders",t,t=>{if("9999"==t.ErrorCode){this.totalPage=t.Data.Pagination.totalPage,this.totalCount=t.Data.Pagination.totalCount,t.Data.Results.forEach(t=>{this.$set(t,"shippingJson",JSON.parse(t.shippingJson)),this.$set(t,"span",!0),t.items.length&&t.items.forEach(t=>{this.$set(t,"previewList",[]),this.$set(t,"disabled",0==t.unfulfillQuantity),t.imgUrl&&t.previewList.push(t.imgUrl)}),this.tableData.push(t),this.tableDataTab1.push(t)});var e=this.$refs.treeData?this.$refs.treeData.store.nodesMap:"";if(e)for(var i in e)e[i].expanded=!1;this.page++,this.load(this.page,this.totalPage)}else this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure()})},load(t,e){if(t>e)return void setTimeout(()=>{let t=[];if(this.tableData.length){if(this.tableData.forEach((e,i)=>{e.items&&e.items.length&&e.items.forEach((e,s)=>{this.$set(e,"oldid",e.id),this.$set(e,"id",e.id+i+s),t.push(e)})}),this.supplierList=this.buildArrayGroup(t),this.supplierList.forEach((t,e)=>{if(!t.id){this.$set(t,"id","999e"),this.$set(t,"vendorName","Unbound vendors");let i=t;this.supplierList.splice(e,1),this.supplierList.unshift(i)}}),"999e"==this.$route.params.vid&&(this.dispatchStatus=2),this.$route.params.id&&(this.checkedSupplier=[],this.dispatchStatus=3,this.supplierList.forEach(t=>{this.$route.params.id==t.id&&this.checkedSupplier.push(this.$route.params.id)})),2==this.dispatchStatus)this.supplierList.forEach(t=>{"999e"==t.id&&this.changeSupplierTag(t)});else if(3==this.dispatchStatus)if(0==this.checkedSupplier.length)this.tableData=[];else if(1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}}else this.supplierList=[];this.$getTableHeight(this),this.loading=!1},300);let i={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName,isManage:this.isManage};this.$apiCall("api.Invoice.shopifyOrders",i,t=>{"9999"==t.ErrorCode?(t.Data.Results.forEach((t,e)=>{this.$set(t,"shippingJson",JSON.parse(t.shippingJson)),this.$set(t,"span",!0),t.items.length&&t.items.forEach(t=>{this.$set(t,"previewList",[]),t.imgUrl&&t.previewList.push(t.imgUrl)}),this.tableData.push(t),this.tableDataTab1.push(t)}),this.page++,this.load(this.page,this.totalPage)):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure(this))})},buildArrayGroup(t){let e=[];for(let i of t){let t=i.relationshipId,s=i.vendorName,a=e.findIndex(e=>e.relationshipId===t),o=-1!==a?e[a]:{};if(0===Object.keys(o).length){let a=[];a.push(i),o["relationshipId"]=t,o["vendorName"]=s,o["listInfo"]=a,e.push(o)}else{let t=e[a]||{},s=t["listInfo"];s.push(i)}}return e.forEach(t=>{this.$set(t,"id",t.relationshipId)}),e},groupBySupplier(t){for(var e={},i=[],s=0;s<t.length;s++){var a=t[s];if(e[a.relationshipId])for(var o=0;o<i.length;o++){var l=i[o];if(l.relationshipId==a.relationshipId){l.listInfo.push(a);break}}else i.push({id:a.relationshipId,vendorName:a.vendorName,listInfo:[a]}),e[a.relationshipId]=a}return i},groupBy(t){for(var e={},i=[],s=0;s<t.length;s++){var a=t[s];if(e[a.shopifyAccountId])for(var o=0;o<i.length;o++){var l=i[o];if(l.shopifyAccountId==a.shopifyAccountId){l.listInfo.push(a);break}}else i.push({shopifyAccountId:a.shopifyAccountId,store:a.store,listInfo:[a]}),e[a.shopifyAccountId]=a}return i},formatminute(t){return moment.duration(t/60,"minutes").locale("en").humanize()},updateOrder(){this.updateOrderLoading=!0,this.$apiCall("api.ShopifyAccount.getOrderByHand",{},t=>{this.updateOrderLoading=!1,"9999"==t.ErrorCode?(this.updateTime=t.Data.Results,localStorage.setItem("c_orders-updateTime",t.Data.Results),this.$elementMessage("Update Order Success","success")):this.$elementMessage(t.Message,"error")})}}},r=l,n=(i("0526"),i("3b5c"),i("e607")),d=Object(n["a"])(r,s,a,!1,null,"0d8e3289",null);e["default"]=d.exports},b1e8:function(t,e,i){}}]);
//# sourceMappingURL=shopify-orders.16657863.js.map