(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["taskList"],{"35a9":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel listHistory"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody mg-b-20"},[e("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-card",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"d-flex justify-content-between headView"},[t.task&&t.task.doneCnt!=t.task.allCnt?e("div",{staticClass:"d-flex"},[e("span",{staticClass:"mg-r-10"},[t._v("Upload Progress:")]),t.task.doneCnt/t.task.allCnt*100>=0&&t.task.doneCnt/t.task.allCnt*100<=100?e("el-progress",{staticStyle:{width:"500px"},attrs:{"stroke-width":18,percentage:parseInt(t.task.doneCnt/t.task.allCnt*100)}}):e("el-progress",{staticStyle:{width:"500px"},attrs:{"stroke-width":18,percentage:0}})],1):e("div"),e("div",{staticClass:"d-flex"},[e("el-checkbox",{attrs:{value:t.AllChecked},on:{change:function(e){return t.allSelect(e)}}},[t._v("All")]),e("el-button",{staticClass:"del",attrs:{type:"primary"},on:{click:function(e){return t.delItems()}}},[t._v("Delete")])],1)]),e("el-row",{ref:"gridTable",attrs:{gutter:10}},[t.items.length?t._e():e("el-col",{attrs:{span:24}},[e("p",{staticStyle:{"margin-top":"25px","font-size":"16px",color:"#909399","text-align":"center"}},[t._v(" no product ")])]),t._l(t.items,(function(s){return e("el-col",{key:s.id,staticStyle:{"margin-bottom":"20px"},attrs:{sm:12,md:8,lg:6,xl:4}},[e("div",{staticClass:"product-box"},[e("div",{staticClass:"status"},[e("span",[t._v(t._s(t._f("listStatus")(s.status)))]),e("el-checkbox",{attrs:{checked:s.ischeck},model:{value:s.ischeck,callback:function(e){t.$set(s,"ischeck",e)},expression:"item.ischeck"}})],1),e("div",{staticClass:"img-wrap"},[e("el-image",{staticStyle:{position:"absolute",width:"100%",height:"100%"},attrs:{fit:"cover",src:s.product.mainImg,"preview-src-list":[s.product.mainImg]}})],1),e("div",{staticClass:"info"},[e("p",{staticClass:"name tx-ellipsis2"},[e("span",{attrs:{color:"#303133"}},[t._v(t._s(s.product.name))])]),e("div",{staticClass:"price tx-ellipsis1"},[t._v(" Cost price: "),e("span",[e("span",{staticStyle:{"font-size":"13px"}},[t._v(t._s(s.stocks[0].currency?s.stocks[0].currency:"USD"))]),t._v(" "+t._s(t.showPrice(s))+" ")])]),e("div",{staticClass:"push-warp"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.delItems(s)}}},[t._v("Delete Task")])],1)])])])}))],2)],1)],1)],1),t.items.length?e("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",{staticStyle:{"margin-bottom":"30px"}},[e("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSizes,"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1)],1)],1)])},r=[],o=(s("149f"),{data(){return{timer:null,taskList:[],task:{},loading:!1,allChecked:!1,items:[],ids:[],pageSizes:[12,24,48],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_importPerPage")?Number(localStorage.getItem("c_importPerPage")):12,total:0,totalPage:0}},watch:{$route:"gotoPage"},computed:{AllChecked(){let t=!0;return this.items.length?this.items.forEach(e=>{e.ischeck||(t=!1)}):t=!1,t}},filters:{listStatus:function(t){switch(t){case"1":return"Waiting";case"2":return"Processing";case"3":return"Succeeded";default:return"Failed"}}},mounted(){this.getImportTask(),this.timer=setInterval(()=>{this.task.allCnt==this.task.doneCnt?(clearInterval(this.timer),this.timer=null):this.getImportTask()},1e3),this.getImportTaskDetail()},beforeDestroy(){clearInterval(this.timer),this.timer=null},methods:{getImportTask(){this.$apiCall("api.Product.findsImportTask",{},t=>{9999==t.ErrorCode&&(this.taskList=t.Data.Results,this.taskList.forEach(t=>{t.id==this.$route.query.id&&(this.task=t)}),this.getImportTaskDetail(a))})},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t}}):this.getImportTaskDetail()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem("c_importPerPage",t),this.getImportTaskDetail()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getImportTaskDetail()},allSelect(t){this.items.forEach(e=>{this.$set(e,"ischeck",t)})},delItems(t){if(t?this.ids.push(t.id):this.items.forEach(t=>{1==t.ischeck&&this.ids.push(t.id)}),0==this.ids.length)return this.$elementMessage("Select the task","error"),!1;this.$confirm("Do you want to delete this task?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>{this.$apiCall("api.Product.delImportTaskDetail",{ids:this.ids},t=>{9999==t.ErrorCode?(this.ids=[],this.allChecked=!1,this.getImportTaskDetail(),this.$elementMessage("Delete Completed","success")):this.$elementMessage(t.Message,"error")})}).catch(()=>(this.ids=[],!1))},showPrice(t){let[e,s]=[0,0];return t.stocks.some(t=>{if(t.costPrice)return e=s=Number(t.costPrice),!0}),t.stocks.forEach(t=>{t.costPrice&&e>Number(t.costPrice)&&(e=Number(t.costPrice)),t.costPrice&&s<Number(t.costPrice)&&(s=Number(t.costPrice))}),e==s?e.toFixed(2):`${e} - ${s}`},getImportTaskDetail(t){t||(this.loading=!0),this.$apiCall("api.Product.findsImportTaskDetail",{taskId:this.$route.query.id,page:this.page,rowsPerPage:this.rowsPerPage},e=>{this.loading=!1,9999==e.ErrorCode?t?this.$set(this.items,"status",e.Data.Results.status):(this.items=e.Data.Results,this.$set(this.items,"ischeck",!1),this.total=Number(e.Data.Pagination.totalCount),this.totalPage=Number(e.Data.Pagination.totalPage),this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0):this.$elementMessage(e.Message,"error")})}},components:{}}),l=o,c=(s("d9fc"),s("e607")),n=Object(c["a"])(l,i,r,!1,null,"25b332bc",null);e["default"]=n.exports},"6d06":function(t,e,s){},d9fc:function(t,e,s){"use strict";s("6d06")}}]);
//# sourceMappingURL=taskList.718b5bc5.js.map