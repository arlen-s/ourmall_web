(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["OrdersProcessing"],{"577c":function(e,t,a){},"60f4":function(e,t,a){},6335:function(e,t,a){"use strict";a("ca02")},"664d":function(e,t,a){"use strict";a("577c")},7954:function(e,t,a){"use strict";a("60f4")},"7f4a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"contentpanel my-invoice-page",staticStyle:{padding:"0"}},[t("div",{ref:"pageHeader",staticClass:"pagetitle",staticStyle:{"flex-wrap":"wrap",height:"auto",display:"none"}},[t("div",{staticClass:"right"}),t("div",{staticStyle:{margin:"5px",width:"100%"}},[e.waitConfirmCnt&&!e.waitStatus?t("el-alert",{staticClass:"top-warning",attrs:{type:"warning",closable:!1}},[t("div",{attrs:{slot:"title"},slot:"title"},[t("p",{staticClass:"c-title",staticStyle:{color:"#e6a23c"}},[t("i",{staticClass:"el-icon-warning"}),t("b",[e._v("Notice: ")]),e._v(" You have "+e._s(e.waitConfirmCnt)+" purchase order(s) need your reconfirm, "),t("a",{attrs:{href:"javascript:;"},on:{click:e.filterWaitConfirm}},[e._v("click here")]),e._v(" to view details. ")])])]):e._e()],1)]),t("div",{staticClass:"pagebody"},[t("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[t("el-col",{attrs:{span:24}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("div",{ref:"tablefilter",staticClass:"page-filter"},[t("div",{staticClass:"show-cancel"},[e.isShowCancel?t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.filtergetItem("c_showCancel")}}},[e._v(" Show all valid orders ")]):t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.filtergetItem("c_showCancel")}}},[e._v(" Show cancelled orders ")])],1),t("el-form",{attrs:{inline:!0,size:"mini"}},[t("el-form-item",{staticClass:"mg-r-5",attrs:{label:"#"}},[t("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:"Order ID"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.codeName,callback:function(t){e.$set(e.filterParams,"codeName",t)},expression:"filterParams.codeName"}})],1),t("el-form-item",[t("el-cascader",{key:e.cascaderKey,attrs:{size:"mini",placeholder:"All my stores",options:e.options,props:{expandTrigger:"hover"}},on:{change:e.handleStoreCheckbox},model:{value:e.filterParams.accountId,callback:function(t){e.$set(e.filterParams,"accountId",t)},expression:"filterParams.accountId"}})],1),t("el-form-item",{staticClass:"mg-r-5"},[t("el-input",{staticStyle:{width:"130px"},attrs:{placeholder:"Invoice Number"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.code,callback:function(t){e.$set(e.filterParams,"code",t)},expression:"filterParams.code"}})],1),t("el-form-item",{staticClass:"mg-r-20"},[t("el-select",{staticClass:"mg-r-5",staticStyle:{width:"150px"},attrs:{placeholder:"Date type"},model:{value:e.filterParams.timeFilter,callback:function(t){e.$set(e.filterParams,"timeFilter",t)},expression:"filterParams.timeFilter"}},e._l(e.filterParams.timeOption,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e.filterParams.timeFilter?t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"Start","end-placeholder":"End"},on:{change:e.dateChange},model:{value:e.filterParams.date,callback:function(t){e.$set(e.filterParams,"date",t)},expression:"filterParams.date"}}):e._e()],1),e.waitStatus?e._e():t("el-form-item",[t("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"All status"},on:{change:e.filterGetItem},model:{value:e.filterParams.status,callback:function(t){e.$set(e.filterParams,"status",t)},expression:"filterParams.status"}},[t("el-option",{attrs:{label:"All status",value:""}}),e._l(e.$dict.invoiceStatusTwo,(function(a){return 9!=a.val?t("el-option",{key:a.val,attrs:{label:a.text,value:a.val}}):e._e()}))],2)],1),t("el-form-item",{staticClass:"mg-r-5"},[t("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"Track Number"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterGetItem.apply(null,arguments)}},model:{value:e.filterParams.trackNumber,callback:function(t){e.$set(e.filterParams,"trackNumber",t)},expression:"filterParams.trackNumber"}})],1),t("el-form-item",[t("el-select",{attrs:{clearable:"",placeholder:"All my vendors"},on:{change:e.handleVendorsSelect,"visible-change":e.getVendors},model:{value:e.vendorsSelect.selected,callback:function(t){e.$set(e.vendorsSelect,"selected",t)},expression:"vendorsSelect.selected"}},e._l(e.vendorsSelect.selectList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.vendorName,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.filterGetItem}},[e._v("Filter")]),t("el-button",{attrs:{type:"danger"},on:{click:e.clearFilter}},[e._v("Clear")])],1)],1)],1)])],1),t("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{data:e.items,"row-key":"id",stripe:"","row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{label:"Purchase Order",width:"250"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("span",[e._v("#"+e._s(a.code))]),t("el-popover",{attrs:{placement:"bottom",trigger:"hover"}},[t("div",{staticClass:"order-time-tips"},[a.timeCreated?t("p",[t("span",[e._v("Create:")]),e._v(" "+e._s(e.moment.unix(a.timeCreated).format("ll [at] LTS"))+" ")]):e._e(),a.timeRead?t("p",[t("span",[e._v("Paid:")]),e._v(" "+e._s(e.moment.unix(a.timeRead).format("ll [at] LTS"))+" ")]):e._e(),a.timeCreateOrder?t("p",[t("span",[e._v("Confrmed:")]),e._v(" "+e._s(e.moment.unix(a.timeCreateOrder).format("ll [at] LTS"))+" ")]):e._e()]),t("i",{staticClass:"el-icon-date mg-l-5",attrs:{slot:"reference"},slot:"reference"})])]}}])}),t("el-table-column",{attrs:{label:"Vendor",prop:"vendorName",width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[a.vendorId?t("span",{staticStyle:{color:"#303133"}},[e._v(" "+e._s(a.vendorName))]):t("span",{staticStyle:{color:"#303133"}},[e._v(" --- "),t("span",{staticStyle:{color:"#909399"}},[e._v("(NOT Joined)")])]),0==a.vendorId?t("div",[t("span",{staticStyle:{color:"#909399"}},[e._v("(NOT Joined)")])]):e._e()]}}])}),t("el-table-column",{attrs:{label:"Order Includes",width:"200"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Orders: ")]),t("span",{staticStyle:{color:"#303133"}},[e._v(e._s(a.orderStatusCnt?a.orderStatusCnt.orderCnt:0))])]),t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Products: ")]),t("span",{staticStyle:{color:"#303133"}},[e._v(e._s(a.totalCnt||"0"))])]),t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("My stores: ")]),t("span",{staticStyle:{color:"#303133"}},[e._v(e._s(a.shops.length||"0"))])])]}}])}),t("el-table-column",{attrs:{label:"Amount",prop:"realAmount",width:"235"},scopedSlots:e._u([{key:"default",fn:function({row:a}){return[t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Income: ")]),t("span",{staticStyle:{color:"#303133"}},[e._v(" "+e._s(a.orderStatusCnt&&a.orderStatusCnt.income.income?`${e.ce[a.orderStatusCnt.income.currency]?e.ce[a.orderStatusCnt.income.currency].symbol:a.orderStatusCnt.income.currency} ${a.orderStatusCnt.income.income}`:"---")+" ")])]),t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Cost: ")]),t("span",{staticClass:"tx-danger"},[e._v(" "+e._s(a.totalAmount?"US$ "+a.totalAmount:"Not set up")+" ")])]),t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Profit: ")]),t("span",{style:"color: "+(e.isProfit(a)?"#303133;":"#67C23A;")},[e._v(" "+e._s(a.orderStatusCnt&&a.orderStatusCnt.income.profit?"US$ "+a.orderStatusCnt.income.profit:"N/A")+" "),t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"About Profit = Income - Cost",placement:"bottom"}},[t("i",{staticClass:"el-icon-question",staticStyle:{color:"#5c6ac4"}})])],1)])]}}])}),t("el-table-column",{attrs:{label:"Statistics",width:"220"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Vendor shipped: ")]),t("span",[e._v(" "+e._s(a.row.itemShippedCnt)+" "),t("span",{staticStyle:{color:"#909399"}},[e._v("of "+e._s(a.row.itemCnt))])])]),t("div",{staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Fulflled: ")]),t("span",{staticStyle:{color:"#303133"}},[e._v(" "+e._s(a.row.itemSyncCnt)+" "),"0"!==a.row.itemSyncFailCnt?t("span",[e._v(" ("),t("span",{staticStyle:{color:"#f56c6c"}},[t("el-popover",{attrs:{placement:"bottom",title:"Download tracking information",width:"700",trigger:"hover"}},[t("div",{staticClass:"mg-t-15 mg-b-15",staticStyle:{"white-space":"nowrap"}},[t("span",{staticClass:"tx-gray-600"},[e._v("Vendor shipped: ")]),t("a",{attrs:{href:"javascript:void(0)"}},[e._v(" "+e._s(a.row.orderStatusCnt?a.row.orderStatusCnt.deliveredOrderCnt:"---")+" ")]),a.row.orderStatusCnt&&Number(a.row.orderStatusCnt.deliveredOrderCnt)-Number(a.row.orderStatusCnt.syncOrderCnt)>0?t("span",{staticClass:"mg-l-10"},[e._v(" (But "),t("a",{attrs:{href:"javascript:void(0)"}},[e._v(" "+e._s(a.row.orderStatusCnt?Number(a.row.orderStatusCnt.deliveredOrderCnt)-Number(a.row.orderStatusCnt.syncOrderCnt):"---")+" ")]),e._v(" unfulfilled / partially fulfilled) ")]):e._e()]),t("el-alert",{staticClass:"icon-color",attrs:{closable:!1,title:"You may download these tracking information and fulfilled these orders in your store manualy.",type:"info","show-icon":""}}),t("div",{staticClass:"mg-t-15 d-flex justify-content-center"},[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.exportDeliver(a.row.id,1)}}},[e._v("Download ALL tracking information")]),a.row.orderStatusCnt&&Number(a.row.orderStatusCnt.deliveredOrderCnt)-Number(a.row.orderStatusCnt.syncOrderCnt)>0?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.exportDeliver(a.row.id,2)}}},[e._v("Download NOT FULFILLED tracking information")]):e._e()],1),t("a",{attrs:{slot:"reference",href:"javascript:void(0)"},slot:"reference"},[e._v(" "+e._s(a.row.itemSyncFailCnt)+" ")])],1),e._v(" sync failed ")],1),e._v(") ")]):e._e()])])]}}])}),t("el-table-column",{attrs:{label:"Status",width:"220"},scopedSlots:e._u([{key:"default",fn:function(a){return["9"==a.row.status&&a.row.stopReason?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.stopReason,placement:"top"}},[t("span",{class:"s-label label-"+e.$dict.invoiceStatus[a.row.status].type},[e._v(e._s(e.$dict.invoiceStatus[a.row.status].text))])]):t("span",{class:"s-label label-"+e.$dict.invoiceStatus[a.row.status].type},[e._v(e._s(e.$dict.invoiceStatus[a.row.status].text))])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"Action",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[2!=a.row.status?t("el-dropdown",{on:{command:e.handleCommand}},[t("div",[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.gotoInvoice(a.row)}}},[e._v("View Details")]),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{disabled:""}},[t("b",{staticClass:"black"},[e._v(" More Action ")])]),1==a.row.status||2==a.row.status?t("el-dropdown-item",{attrs:{command:{type:"Change another vendor",data:a.row}}},[e._v("Change another vendor")]):e._e(),7!=a.row.status?t("el-dropdown-item",{attrs:{command:{type:"Invite vendor to process",data:a.row}}},[e._v("Invite vendor to process")]):e._e(),4==a.row.paymentType&&1==a.row.payStatus||6==a.row.paymentType?e._e():[a.row.status<5||7==a.row.status?t("el-dropdown-item",{staticStyle:{color:"#f56c6c"},attrs:{command:{type:"Cancel this order",data:a.row}}},[e._v("Cancel this order ")]):e._e()]],2)],1):t("el-dropdown",{on:{command:e.handleCommand}},[t("div",[t("el-link",{attrs:{type:"success"},on:{click:function(t){return e.confirmMoneyOnly(a.row)}}},[e._v("Confirm payment")]),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{disabled:""}},[t("b",{staticClass:"black"},[e._v(" More Action ")])]),e.isPay(a.row)?t("el-dropdown-item",{staticStyle:{color:"#67c23a"},attrs:{command:{type:"pay",data:a.row}}},[e._v(" Pay ")]):e._e(),t("el-dropdown-item",{attrs:{command:{type:"View Details",data:a.row}}},[e._v("View Details")]),t("el-dropdown-item",{attrs:{command:{type:"Invite vendor to process",data:a.row}}},[e._v("Invite vendor to process")])],1)],1)]}}])})],1)],1)],1),e.items.length?t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[t("div",{ref:"tableFooter"},[t("el-pagination",{attrs:{"current-page":Number(e.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":e.pageSizes,"page-size":e.rowsPerPage,total:Number(e.total)},on:{"current-change":e.toPage,"size-change":e.changePageSize}})],1)])],1):e._e()],1),t("el-dialog",{staticClass:"selected-save-dialog",attrs:{visible:e.selectedSaveDialog.isShow,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.selectedSaveDialog,"isShow",t)}}},[t("div",{staticStyle:{padding:"0 20px 20px","text-align":"center"}},[t("i",{staticClass:"el-message__icon el-icon-success",staticStyle:{color:"#67c23a","font-size":"50px"}}),t("p",{staticStyle:{color:"#67c23a","font-weight":"bold","font-size":"18px",margin:"10px 0px 20px"}},[e._v(" Selected saved! Now you can Check the purchase orders ")]),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectedSaveDialog.info,border:""}},[t("el-table-column",{attrs:{label:"#Invoice Number",prop:"code"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v("#"+e._s(a.row.code))])]}}])}),t("el-table-column",{attrs:{label:"Vendor",prop:"vendorName"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.vendorName?t("span",{staticStyle:{color:"#303133"}},[e._v(" "+e._s(a.row.vendorName))]):t("span",{staticStyle:{color:"#303133"}},[e._v(" --- "),t("span",{staticStyle:{color:"#909399"}},[e._v("(NOT Joined)")])])]}}])}),t("el-table-column",{attrs:{label:"Amount Due",prop:"realAmount"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.realAmount>0?t("span",{staticClass:"tx-danger"},[e._v("US$ "),t("span",[e._v(e._s(a.row.realAmount))])]):t("span",{staticClass:"tx-danger"},[e._v("Not set up")])]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"Action",width:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[t("el-link",{staticStyle:{"font-size":"12px","font-weight":"normal"},attrs:{type:"primary"},on:{click:function(t){return e.gotoInvoice(a.row)}}},[e._v("View Details")])],1),t("div",[t("el-link",{staticStyle:{"font-size":"12px","font-weight":"normal"},attrs:{type:"primary"},on:{click:function(t){return e.sendtoVendor(a.row)}}},[e._v("Send to vendor")])],1)]}}])})],1)],1)]),t("el-dialog",{attrs:{"custom-class":"sendInvoice",title:"Send to vendor",visible:e.sendInvoiceOpen,width:"50%"},on:{open:e.openSend,close:e.closeSend,"update:visible":function(t){e.sendInvoiceOpen=t}}},[[t("el-tabs",{staticStyle:{"margin-left":"20px","margin-top":"10px"},attrs:{type:"card"},model:{value:e.activeShareName,callback:function(t){e.activeShareName=t},expression:"activeShareName"}},[t("el-tab-pane",{attrs:{name:"shareLink"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"iconfont icon-link"}),e._v(" Share by link")]),t("div",{staticClass:"d-flex mg-y-20"},[t("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[e._v(" Share link: ")]),t("div",[t("span",[e._v(e._s(e.invoiceInfo.url))])])]),t("div",{staticClass:"d-flex mg-y-20"},[t("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}}),t("div",[t("div",[t("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.invoiceInfo.url,expression:"invoiceInfo.url",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{size:"mini",type:"success"}},[e._v("Copy Link")])],1)])])]),t("el-tab-pane",{attrs:{name:"shareWeixin"}},[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"iconfont icon-shejiao"}),e._v(" Share by APP")]),t("div",[t("div",{staticClass:"d-flex mg-y-20"},[t("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[e._v(" Title: ")]),t("div",{staticStyle:{width:"70%"}},[t("el-input",{attrs:{type:"text",size:"small"},on:{change:function(t){return e.saveRemark("2")}},model:{value:e.shareTitle,callback:function(t){e.shareTitle=t},expression:"shareTitle"}})],1)]),t("div",{staticClass:"d-flex mg-y-20 align-items-center"},[t("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[e._v(" Desc: ")]),t("div",{staticStyle:{width:"70%"}},[t("el-input",{attrs:{type:"textarea",resize:"none",autosize:{minRows:3,maxRows:6},size:"small"},on:{change:function(t){return e.saveRemark("2")}},model:{value:e.shareDesc,callback:function(t){e.shareDesc=t},expression:"shareDesc"}})],1)]),t("div",{staticClass:"d-flex mg-y-20"},[t("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[e._v(" Share: ")]),t("div",{staticClass:"d-flex",staticStyle:{width:"70%"}},[t("div",{staticClass:"skype-share",staticStyle:{"margin-right":"30px"},attrs:{"data-href":e.shareTitle+e.shareDesc,"data-lang":"en-US","data-text":e.invoiceInfo.url,"data-style":"large"}}),t("div",[t("el-tooltip",{attrs:{placement:"bottom"}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("p",{staticClass:"tx-center mg-b-10"},[e._v("Scan share to WeChat")]),t("img",{attrs:{src:e.invoiceInfo.qrcode,width:"130"}}),t("img",{staticStyle:{position:"absolute",left:"50%",top:"50%","margin-left":"-15px","margin-top":"-4px"},attrs:{src:"images/weixin.png",width:"30px"}})]),t("a",{staticClass:"share-weixin",attrs:{href:"javascript:;"}},[t("i",{staticClass:"fa fa-weixin"}),e._v(" Share ")])])],1)])])])])],1)],t("el-divider"),t("div",{staticClass:"dialog-footer d-flex justify-content-between",attrs:{slot:"footer"},slot:"footer"},[t("div",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"shareWeixin"==e.activeShareName,expression:"activeShareName == 'shareWeixin'"}],attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.saveRemark("1")}}},[e._v("Clear")])],1),t("div",[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.sendInvoiceOpen=!1}}},[e._v("Close")])],1)])],2),t("el-dialog",{attrs:{title:"Purchase Order Reconfirm",visible:e.DialogReconfirm.isShow,width:"450px"},on:{"update:visible":function(t){return e.$set(e.DialogReconfirm,"isShow",t)}}},[e.DialogReconfirm.item?[t("div",{staticStyle:{padding:"0 20px"}},[t("div",{staticStyle:{"margin-bottom":"10px"}},[e._v(" Vendor name: "),t("b",{staticStyle:{color:"#909399"}},[e._v(e._s(e.DialogReconfirm.item.vendorName))])]),t("div",[e._v(" Includes: "),t("b",{staticStyle:{color:"#5c6ac4"}},[e._v(e._s(e.DialogReconfirm.item.orderCnt?e.DialogReconfirm.item.orderCnt:0))]),e._v(" Shopify orders / "),t("b",{staticStyle:{color:"#5c6ac4"}},[e._v(e._s(e.DialogReconfirm.item.totalCnt?e.DialogReconfirm.item.totalCnt:0))]),e._v(" products ")])]),t("div",{staticClass:"dialog-footer d-flex",attrs:{slot:"footer"},slot:"footer"},[7==e.DialogReconfirm.item.status?t("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.runReconfirm(1)}}},[e._v(" Allow vendor to process these orders ")]):e._e(),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.runReconfirm(2)}}},[e._v("View details")])],1)]:e._e()],2),t("el-dialog",{attrs:{visible:e.cancelOrderDialog.visible,title:"Cancel purchase order",width:"600px","before-close":e.cancelOrderDialogClose}},[t("div",{staticStyle:{margin:"20px"}},[t("p",{staticClass:"mg-b-10"},[e._v("Do you want to cancel this order?")]),t("p",{staticStyle:{"word-break":"break-word"}},[e._v(' Don\'t worry, after cancelling this purchase order, you can still find your Shopify orders in the "Waiting for sourcing" menu and re-place the purchase order. ')]),t("el-form",{ref:"form",attrs:{"label-width":"80px"}},[t("el-form-item",{attrs:{label:"Reason"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.cancelOrderDialog.stopReason,callback:function(t){e.$set(e.cancelOrderDialog,"stopReason",t)},expression:"cancelOrderDialog.stopReason"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.cancelOrderDialog.loading,type:"primary"},on:{click:e.postCanceOrder}},[e._v("Confirm")]),t("el-button",{on:{click:e.cancelOrderDialogClose}},[e._v("Discard")])],1)]),t("el-dialog",{attrs:{visible:e.changeAnotherVendorDialog.visible,title:"Change purchase order to another vendor",width:"600px","before-close":e.closeCAVDialog}},[t("div",[t("el-form",{attrs:{"label-position":"right"}},[t("el-form-item",{attrs:{label:"Current vendor:"}},[t("p",[e._v(e._s(e.changeAnotherVendorDialog.currentVendor))])]),t("el-form-item",{attrs:{label:"Change to new vendor:"}},[t("el-select",{attrs:{clearable:"",placeholder:"All my vendors"},on:{"visible-change":e.getVendors},model:{value:e.changeAnotherVendorDialog.relationshipId,callback:function(t){e.$set(e.changeAnotherVendorDialog,"relationshipId",t)},expression:"changeAnotherVendorDialog.relationshipId"}},e._l(e.vendorsSelect.selectList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.vendorName,value:e.id}})})),1)],1)],1),t("div",{staticStyle:{margin:"0 20px"}},[t("el-checkbox",{model:{value:e.changeAnotherVendorDialog.changeDispatch,callback:function(t){e.$set(e.changeAnotherVendorDialog,"changeDispatch",t)},expression:"changeAnotherVendorDialog.changeDispatch"}},[e._v("Also allocate the products in this purchase order to the new supplier")])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{loading:e.changeAnotherVendorDialog.loading,type:"primary"},on:{click:e.postCAVDialog}},[e._v("Confirm")]),t("el-button",{on:{click:e.closeCAVDialog}},[e._v("Discard")])],1)]),t("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:120,bottom:20}})],1)},i=[],r=(a("149f"),{data(){return{options:[{id:1,label:"Shopify",children:[]},{id:2,label:"Woocommerce",children:[]},{id:3,label:"Lazada",children:[]},{id:4,label:"Shopee",children:[]}],cascaderKey:1,changeAnotherVendorDialog:{currentVendor:"",visible:!1,loading:!1,changeNewVnedor:[],changeDispatch:!1,relationshipId:"",invoiceId:""},cancelOrderDialog:{loading:!1,visible:!1,id:"",stopReason:""},ce:this.$CE,vendorsSelect:{selected:"",selectList:[]},storeCheckbox:{selected:[],checkList:[]},getShopNameInput:{loading:!1,shopList:[]},loading:!1,reSizeTime:0,tableHeight:400,pageSizes:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("c_customerInvoiceRowsPerPage")?Number(localStorage.getItem("c_customerInvoiceRowsPerPage")):10,items:[],total:0,totalPage:0,filterParams:{timeOption:[{label:"Order created",value:"timeCreated"},{label:"Order paid",value:"timePaid"},{label:"Order confirmed",value:"timeRead"}],timeFilter:"",date:[],dateFrom:"",dateTo:"",code:"",status:"",customerRead:"",payStatus:"",relationshipId:"",vendorName:"",vendorSelectArr:[],trackNumber:"",codeName:"",accountId:""},filterParamsDefault:"{}",selectedSaveDialog:{isShow:!1,info:""},selectedSaveDialogDefault:"{}",invoiceInfo:"",shareTitle:"",shareDesc:"",showDownloadInvoice:!1,sendInvoiceOpen:!1,activeShareName:"shareLink",saveCode:"",saveItem:"",vendorData:[],selectLoading:!1,selectArr:[],cancelStatus:1,waitConfirmCnt:0,waitStatus:0,DialogReconfirm:{isShow:!1,item:null},isShowCancel:!1}},watch:{items(){this.items.forEach((e,t)=>{e.isLoadOrderCnt=0}),setTimeout(()=>{this.loadCnt()},500)},$route:"gotoPage",saveCode(){this.saveCode&&(this.selectedSaveDialog=JSON.parse(this.selectedSaveDialogDefault),this.selectedSaveDialog.info=sessionStorage.getItem("c_selectedSaveInfo")?JSON.parse(sessionStorage.getItem("c_selectedSaveInfo")):[],this.selectedSaveDialog.info.length&&(this.selectedSaveDialog.isShow=!0))}},mounted(){this.getShopName(),this.filterParamsDefault=JSON.stringify(this.filterParams),this.filterParams.status=this.$route.query.status?Number(this.$route.query.status):"",this.$route.query.rid&&(this.vendorsSelect.selectList=[{id:this.$route.query.rid,vendorName:this.$route.query.name}],this.vendorsSelect.selected=this.$route.query.rid),this.$route.params.rid&&(this.filterParams.relationshipId=this.$route.params.rid,this.filterParams.vendorName=this.$route.params.name,this.selectArr=[{id:this.$route.params.rid,vendorName:this.$route.params.name}]),this.getItem(),this.getVendor(),this.selectedSaveDialogDefault=JSON.stringify(this.selectedSaveDialog),this.saveCode=this.$route.params.saveCode?this.$route.params.saveCode:"";let e,t=this.$refs.gridTable.bodyWrapper;t.onscroll=()=>{setTimeout(()=>{this.loadCnt()},100)},$(window).scroll(()=>{clearTimeout(e),e=setTimeout(()=>{this.loadCnt()},100)}).resize(()=>{clearTimeout(e),e=setTimeout(()=>{this.loadCnt()},100)})},beforeDestroy(){},methods:{confirmMoneyOnly(e){this.$confirm("After your confirmation for the payment, we will notify the vendor by email. You can also proactively notify the vendor to speed the delivery up.","Have you finished the payment?",{confirmButtonText:"Confirm the payment",cancelButtonText:"Discard",type:"info"}).then(()=>{this.$apiCall("api.Invoice.setRead",{uniCode:e.uniCode},t=>{"9999"==t.ErrorCode?(this.$message({type:"success",message:"Payment success"}),this.items=this.items.filter(t=>t.id!==e.id),--this.total,this.$emit("getNum")):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure(),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})}),setTimeout(()=>{document.querySelectorAll(".el-button--primary").forEach(e=>{e.blur()})},200)},handleCommand({type:e,data:t}){"Change another vendor"===e&&this.openCAVDialog(t),"Invite vendor to process"===e&&this.sendtoVendor(t),"Cancel this order"===e&&this.cancelInvoice(t),"View Details"===e&&this.gotoInvoice(t),"pay"==e&&this.gotoInvoice(t,"pay")},isProfit(e){return null==e.orderStatusCnt||(null==e.orderStatusCnt.income.profit||Number(e.orderStatusCnt.income.profit)>=0)},postCAVDialog(){this.changeAnotherVendorDialog.loading=!0,this.$apiCall("api.Invoice.changeVendor",{invoiceId:this.changeAnotherVendorDialog.invoiceId,relationshipId:this.changeAnotherVendorDialog.relationshipId,changeDispatch:this.changeAnotherVendorDialog.changeDispatch},e=>{9999==e.ErrorCode?(this.$message({message:e.Message,type:"success"}),this.changeAnotherVendorDialog.visible=!1,this.filterGetItem()):this.$message({message:e.Message,type:"error"}),this.changeAnotherVendorDialog.loading=!1})},closeCAVDialog(){this.changeAnotherVendorDialog.visible=!1},openCAVDialog(e){this.changeAnotherVendorDialog.currentVendor=e.vendorName,this.changeAnotherVendorDialog.changeDispatch=!1,this.changeAnotherVendorDialog.relationshipId="",this.changeAnotherVendorDialog.invoiceId=e.id,this.changeAnotherVendorDialog.visible=!0,this.changeAnotherVendorDialog.loading=!1},handleVendorsSelect(){this.filterGetItem()},handleStoreCheckbox(){this.filterGetItem()},handleCleatStore(){this.storeCheckbox.selected=[],this.filterGetItem()},getVendors(e){e&&this.vendorsSelect.selectList.length<=2&&this.$apiCall("api.Relationship.findByCustomer",{},e=>{9999==e.ErrorCode?(this.vendorsSelect.selectList=[],e.Data.Results.forEach(e=>{this.vendorsSelect.selectList.push({id:e.id,vendorName:e.vendorName})})):this.$message({message:e.Message,type:"error"})})},getShopName(){this.$apiCall("api.Invoice.findStores",{authStatus:1},e=>{9999==e.ErrorCode?(this.storeCheckbox.checkList=[],e.Data.Results.forEach(e=>{this.storeCheckbox.checkList.push({shopifyAccountId:e.id,store:e.shopName})}),this.options.map(t=>{e.Data.Results.filter(e=>{e.platform==t.id&&t.children.push({label:e.shopName,value:e.id})})})):this.$message({message:e.Message,type:"error"})})},runReconfirm(e){this.DialogReconfirm.isShow=!1,1==e&&this.confirmInvoice(this.DialogReconfirm.item),2==e&&this.gotoInvoice(this.DialogReconfirm.item)},openReconfirm(e){this.DialogReconfirm.isShow=!0,this.DialogReconfirm.item=e},confirmInvoice(e){this.$set(e,"confirmLoading",!0),this.$apiCall("api.Invoice.confirmInvoice",{invoiceId:e.id},t=>{this.$set(e,"confirmLoading",!1),"9999"==t.ErrorCode?(this.$elementMessage("success","success"),this.getItem(!0,!0)):this.$elementMessage(t.Message,"error")})},filterWaitConfirm(){this.cancelStatus=1,this.waitStatus=1,this.filterGetItem()},exportDeliver(e,t){this.$showLoading(),this.$apiCall("api.Invoice.exportDeliverTitle",{invoiceId:e},a=>{if("9999"==a.ErrorCode){let i=[];for(var s in a.Data.Results.titles){let e={};e.key=s,e.orName=a.Data.Results.titles[s],e.name=a.Data.Results.titles[s],i.push(e)}let r={};i.forEach(e=>{r[e.key]=e.name});let o={invoiceId:e,titles:r,onlyDelivered:!0};2==t&&(o.onlyNotSync=!0),0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>');let l=e=>{document.getElementById("ifilePro").src=e};this.$apiCall("api.Invoice.exportDeliver",o,e=>{this.$hideLoading(),"9999"==e.ErrorCode?(this.$elementMessage("Your request is been submitted, please wait one moment.","success"),l(e.Data.Results.file)):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})}else this.$elementMessage(a.Message,"error"),"1002"!=a.ErrorCode&&"1003"!=a.ErrorCode||this.$userFailure()})},tableRowClassName({row:e,rowIndex:t}){return"data-invocieid invocieid"+this.items[t].id},loadCnt(){if(!this.$refs.gridTable)return;let e=this.$refs.gridTable.bodyWrapper,t=e.scrollHeight,a=e.scrollTop;$(".el-table__body-wrapper .data-invocieid").each(e=>{$(".el-table__body-wrapper .data-invocieid").eq(e);let s=$(".el-table__body-wrapper .data-invocieid").eq(e).offset().top-$(".el-table__header-wrapper").offset().top-30;if(s<t+a&&s>a){let t=this.items[e].id;this.items.some(e=>{e.id==t&&(e.isLoadOrderCnt||this.getOrderCnt(t))})}})},getOrderCnt(e){let t,a=!1,s=!1;this.items.some(s=>{if(s.id==e)return s.isLoadOrderCnt?a=!0:t=s,!0}),s||(t.isLoadOrderCnt=1,this.$apiCall("api.Invoice.getSummary",{invoiceId:e},e=>{this.$hideLoading(),"9999"==e.ErrorCode?this.$set(t,"orderStatusCnt",e.Data.Results):(this.$elementMessage(e.Message,"error"),t.isLoadOrderCnt=2)}))},remoteMethodVendor(e){this.selectArr=[],e&&(this.selectLoading=!0,this.$apiCall("api.Relationship.findByCustomer",{name:e},e=>{this.selectLoading=!1,9999==e.ErrorCode?this.selectArr=e.Data.Results:this.$message({message:e.Message,type:"error"})}))},changeCustomerName(){window.lazy&&window.clearTimeout(window.lazy),window.lazy=setTimeout(()=>{this.$apiCall("api.Relationship.findByCustomer",{name:this.filterParams.vendorName},e=>{"9999"==e.ErrorCode?this.vendorData=e.Data.Results:(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},400)},showPopover(){setTimeout(()=>{$(".customer-input input").focus()},100)},selectCustomer(e){this.$refs.popoverCustomer.doClose(),this.filterParams.relationshipId=e.id,this.filterParams.vendorName=e.vendorName,this.filterGetItem()},getVendor(){this.$apiCall("api.Relationship.findByCustomer",{},e=>{"9999"==e.ErrorCode?this.vendorData=e.Data.Results:(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},onCopy(e){this.$elementMessage("Has been copied to the clipboard","success")},onError(e){this.$elementMessage("Copy to clipboard failed, please copy manually","error")},openSend(){let e=0,t=setInterval(()=>{(function(e,t,a){e.loadSkypeWebSdkAsync=e.loadSkypeWebSdkAsync||function(e){var s,i=t.getElementsByTagName(a)[0];t.getElementById(e.id)||(s=t.createElement(a),s.id=e.id,s.src=e.scriptToLoad,s.onload=e.callback,i.parentNode.insertBefore(s,i))};var s={scriptToLoad:"https://swx.cdn.skype.com/shared/v/latest/skypewebsdk.js",id:"skype_web_sdk"};e.loadSkypeWebSdkAsync(s)})(window,document,"script"),e++,e>10&&clearInterval(t)},300)},closeSend(){this.saveCode&&(this.selectedSaveDialog.isShow=!0)},saveRemark(e){this.$showLoading(),this.$apiCall("api.Invoice.saveRemark",{uniCode:this.invoiceInfo.uniCode,title:1==e?"":this.shareTitle,desc:1==e?"":this.shareDesc},e=>{this.$hideLoading(),"9999"==e.ErrorCode?(this.shareTitle=e.Data.Results.title,this.shareDesc=e.Data.Results.desc):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure(),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},sendtoVendor(e){this.selectedSaveDialog.isShow=!1,this.$showLoading(),this.$apiCall("api.Invoice.getShareUrl",{invoiceId:e.id},e=>{this.$hideLoading(),"9999"==e.ErrorCode?(this.invoiceInfo=e.Data.Results,this.shareTitle=this.invoiceInfo.remark?this.invoiceInfo.remark.title:"",this.shareDesc=this.invoiceInfo.remark?this.invoiceInfo.remark.desc:"",this.sendInvoiceOpen=!0,this.activeShareName="shareLink"):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},clearFilter(){this.selectArr=[],this.storeCheckbox.selected=[],this.vendorsSelect.selected="",this.filterParams=JSON.parse(this.filterParamsDefault),++this.cascaderKey,1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},filterGetItem(e){"showCancel"==e&&(this.isShowCancel=!this.isShowCancel),1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},filterGetItem2(e){3==e?(this.waitStatus=0,this.cancelStatus=1):this.cancelStatus=e,1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})},dateChange(){this.filterParams.date.length>1&&(this.filterParams.dateFrom=moment(this.filterParams.date[0]).format("YYYY-MM-DD"),this.filterParams.dateTo=moment(this.filterParams.date[1]).format("YYYY-MM-DD"),this.filterGetItem())},postCanceOrder(){this.cancelOrderDialog.stopReason?(this.cancelOrderDialog.loading=!0,this.$apiCall("api.Invoice.cancel",{invoiceId:this.cancelOrderDialog.id,stopReason:this.cancelOrderDialog.stopReason},e=>{9999==e.ErrorCode?(this.$message({message:"Success",type:"success"}),this.cancelOrderDialog.id="",this.cancelOrderDialog.visible=!1,this.getItem(!0,!0),this.$emit("getNum")):this.$message({message:e.Message,type:"error"})}),this.cancelOrderDialog.loading=!1):this.$message({message:"The reason must be entered",type:"error"})},cancelOrderDialogClose(){this.cancelOrderDialog.id="",this.cancelOrderDialog.visible=!1},cancelInvoice(e){this.cancelOrderDialog.stopReason="",this.cancelOrderDialog.id=e.id,this.cancelOrderDialog.visible=!0,this.cancelOrderDialog.loading=!1},getItem(e,t){this.$showLoading();let a={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.filterParams.timeFilter,dateFrom:this.filterParams.dateFrom,dateTo:this.filterParams.dateTo,code:this.filterParams.code,status:this.isShowCancel?9:this.filterParams.status,customerRead:this.filterParams.customerRead,payStatus:this.filterParams.payStatus,relationshipId:this.vendorsSelect.selected,trackNumber:this.filterParams.trackNumber,codeName:this.filterParams.codeName,accountId:this.filterParams.accountId[1],accountIds:this.storeCheckbox.selected};this.waitStatus&&(a.status=7),this.$apiCall("api.Invoice.findByCustomer",a,a=>{this.$hideLoading(),9999==a.ErrorCode?(this.items=[],a.Data.Results.forEach(e=>{e.confirmLoading=!1,this.items.push(e)}),this.total=Number(a.Data.Pagination.totalCount),this.totalPage=Number(a.Data.Pagination.totalPage),a.Data.Results.length&&a.Data.Results[0].confirmCnt&&(this.waitConfirmCnt=Number(a.Data.Results[0].confirmCnt)),t&&!this.items.length&&this.waitStatus&&(this.waitStatus=0,this.clearFilter()),e||(this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0)):this.$message({message:a.Message,type:"error"})})},toPage(e){e!=this.$route.query.page&&this.$router.push({query:{page:e}})},changePageSize(e){this.rowsPerPage=e,localStorage.setItem("c_customerInvoiceRowsPerPage",e),this.getItem()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()},gotoImport(){this.$router.push({name:"importData"})},gotoInvoice(e,t){let a=this.$router.resolve({path:"/i/"+e.uniCode+"?fromPage=1"+(t?"&type="+t:"")});window.open(a.href,"_blank")},isPay(e){return"/my"==this.$root.$children[0].baseUrl?!!e.walletOpen:!!e.walletOpen||!(1!=e.bonusStatus&&!e.hasPayBind)}}}),o=r,l=(a("6335"),a("7954"),a("664d"),a("e607")),n=Object(l["a"])(o,s,i,!1,null,"7aea149c",null);t["default"]=n.exports},ca02:function(e,t,a){}}]);
//# sourceMappingURL=OrdersProcessing.7f3164be.js.map