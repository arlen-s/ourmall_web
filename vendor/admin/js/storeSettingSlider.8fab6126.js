(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["storeSettingSlider"],{7973:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"setting-page"},[s("el-scrollbar",{staticClass:"left"},[s("div",{staticClass:"content"},[s("h1",[s("el-link",{attrs:{icon:"el-icon-arrow-left",underline:!1},on:{click:e.goBack}},[e._v(e._s(e.$t("storeSetting.轮播图")))])],1),s("div",{staticClass:"images-box"},[s("h2",[e._v(e._s(e.$t("storeSetting.轮播图片"))+" "+e._s(e.setting.images.length)+" / 6")]),s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading,expression:"uploadLoading"}],staticClass:"slider-img-card",attrs:{shadow:"hover","body-style":{padding:"0"}}},[s("ul",{staticClass:"slider-img-list"},[s("draggable",{attrs:{handle:".icon-draggable"},model:{value:e.setting.images,callback:function(t){e.$set(e.setting,"images",t)},expression:"setting.images"}},e._l(e.setting.images,(function(t,i){return s("li",{key:t.id,staticClass:"slider-img-item"},[s("div",{staticClass:"left"},[s("i",{staticClass:"iconfont icon-draggable"}),s("div",{staticClass:"img-wrap",style:{backgroundImage:"url("+t.src+")"}}),s("div",{staticClass:"index"},[e._v("("+e._s(i+1)+")")])]),s("el-link",{attrs:{icon:"el-icon-delete",underline:!1,type:"danger"},on:{click:function(t){return e.delSliderItem(i)}}})],1)})),0)],1),s("el-link",{staticClass:"add-img",attrs:{underline:!1,disabled:e.setting.images.length>5},on:{click:e.openUploadImg}},[s("i",{staticClass:"el-icon-circle-plus"}),e._v(" "+e._s(e.$t("storeSetting.添加图片"))+" ")]),s("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"uploadSliderImg",accept:"image/jpeg, image/png, image/gif, image/webp"},on:{change:function(t){return e.Base64(t)}}})],1),s("p",{staticStyle:{padding:"0 5px",color:"#909399","font-size":"12px"}},[e._v("建议尺寸 1920px * 720px")])],1),s("div",{staticClass:"setting-box"},[s("h2",[e._v(e._s(e.$t("storeSetting.设置")))]),s("el-card",{attrs:{shadow:"hover"}},[s("div",{staticClass:" mg-b-15"},[s("el-select",{attrs:{size:"small"},model:{value:e.setting.size,callback:function(t){e.$set(e.setting,"size",t)},expression:"setting.size"}},e._l(e.sizeArr,(function(t){return s("el-option",{key:t.value,attrs:{label:e.$t(t.label),value:t.value}})})),1)],1),s("el-row",[s("el-col",{attrs:{span:8}},[e._v(e._s(e.$t("storeSetting.自动轮播")))]),s("el-col",{staticClass:" tx-right",attrs:{span:16}},[s("el-switch",{model:{value:e.setting.auto,callback:function(t){e.$set(e.setting,"auto",t)},expression:"setting.auto"}})],1)],1)],1)],1)])]),s("el-scrollbar",{ref:"rightBox",staticClass:"right"},[s("div",{staticClass:"content"},[s("demoHeader",{attrs:{data:e.$store.state.configJson.header,headerMenu:e.headerMenu}}),s("demoBody",{attrs:{data:e.setting,header:e.$store.state.configJson.header}}),s("demoFooter",{attrs:{setting:e.$store.state.configJson.footer}})],1)]),s("div",{staticClass:"action"},[s("el-button",{attrs:{type:"danger",size:"medium"},on:{click:e.del}},[e._v(e._s(e.$t("storeSetting.删除该组件")))]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.save}},[e._v(e._s(e.$t("storeSetting.完成")))])],1)],1)},a=[],n=(s("2c45"),s("1fbe"),s("0baa"),s("390f"),s("abd8"),s("c12c"),s("3d7e"),s("ad3f"),s("2261"),s("3335")),o=s.n(n),r=s("826e"),l=s("8c3c"),c=s("db46"),g=(s("586c"),{data:function(){return{isSave:!1,uploadLoading:!1,headerMenu:[],exist:!1,setting:{cid:"",type:"slider",images:[],size:"1",auto:!0},sizeArr:this.$dict.storeSliderSizeArr}},components:{draggable:o.a,demoHeader:r["a"],demoBody:l["a"],demoFooter:c["a"]},created:function(){var e=this;this.$apiCall("api.VendorShop.getShopConfig",{},(function(t){9999==t.ErrorCode&&0!==t.Data.Results.length&&(t.Data.Results.header.activeMenu&&t.Data.Results.menu.forEach((function(s){s.id==t.Data.Results.header.activeMenu&&(e.headerMenu=s)})),e.$store.commit("getShopConfig",t.Data.Results),e.$store.state.configJson.sort.forEach((function(t){t.cid==e.$route.query.cid&&(e.exist=!0,e.setting=JSON.parse(JSON.stringify(t))),e.$nextTick((function(){e.$refs.rightBox.wrap.scrollTop=document.getElementById("row".concat(e.$route.query.cid)).offsetTop}))})),e.exist||(e.setting={cid:e.$route.query.cid,type:"slider",images:[],size:"1",auto:!0},e.exist=!0,e.$store.commit("addStoreComponent",e.setting)))}))},beforeRouteLeave:function(e,t,s){if(this.isSave)s();else{var i=confirm(this.$t("logistics.当前页面还未保存，确定要离开吗?"));i?s():s(!1)}},methods:{goBack:function(){this.$router.push({name:"storeSettingMain"})},del:function(){var e=this;this.isSave=!0,this.$store.commit("delComponent",this.setting.cid),this.setting=JSON.parse(JSON.stringify(this.$store.state.configJson)),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},(function(t){9999==t.ErrorCode?(e.$elementMessage("删除成功","success"),e.$router.replace({name:"storeSettingMain"})):e.$message({message:t.Message,type:"error"})}))},save:function(){var e=this;this.isSave=!0,this.exist?this.$store.commit("setStoreComponent",this.setting):this.$store.commit("addStoreComponent",this.setting),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},(function(t){9999==t.ErrorCode?e.$elementMessage(e.$t("storeSetting.保存成功"),"success"):e.$message({message:t.Message,type:"error"})}))},delSliderItem:function(e){this.setting.images.splice(e,1)},uploadImgBase64:function(e,t){var s=this;this.uploadLoading=!0,this.$apiCall("api.Comment.uploadImg",{imgUrlBase64:e,ext:t},(function(e){if(document.getElementById("uploadSliderImg").value="",9999==e.ErrorCode){var t=new Image;t.src=e.Data.Results.imgUrl,t.onload=function(){s.uploadLoading=!1,s.setting.images.push({id:(new Date).getTime(),src:e.Data.Results.imgUrl,width:t.width,height:t.height})}}else s.$message({message:e.Message,type:"error"})}))},Base64:function(e){var t=this;if(e.target.value){if(e.target.files[0].size/1024/1024>1)return this.$message({message:this.$t("category.上传文件不能大于1MB"),type:"error"}),void(e.target.value="");var s=new FileReader,i=new Image,a="";s.onload=function(e){i.src=e.target.result;var s=e.target.result.match(/data:image\/(.*);base64,.*/);a=s[1],t.uploadImgBase64(e.target.result.split(",").pop(),a)},s.readAsDataURL(e.target.files[0])}},openUploadImg:function(){document.getElementById("uploadSliderImg").click()}}}),d=g,u=(s("9681"),s("cba8")),m=Object(u["a"])(d,i,a,!1,null,"46ab7145",null);t["default"]=m.exports},9681:function(e,t,s){"use strict";s("dd8c")},dd8c:function(e,t,s){}}]);