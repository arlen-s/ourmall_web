(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["storeCode"],{1541:function(t,e,o){},"15ce":function(t,e,o){},1912:function(t,e,o){"use strict";o("1541")},2239:function(t,e,o){t.exports=o.p+"img/store-code.0687d2eb.png"},"243c":function(t,e,o){"use strict";o("a4f1")},"30d7":function(t,e,o){"use strict";o("15ce")},"4ad7":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"add-page"}},[o("div",[o("el-link",{attrs:{icon:"el-icon-arrow-left",underline:!1},on:{click:t.goBack}},[t._v(t._s(t.$t("storePage.返回菜单")))])],1),o("div",{staticClass:"page-title"},[o("h2",[t._v(t._s(t.$t("storePage.自定义页面")))])]),o("el-card",[o("h2",{staticClass:"title"},[t._v(t._s(t.$t("storePage.页面标题")))]),o("el-divider"),o("el-input",{attrs:{maxlength:50,"show-word-limit":""},model:{value:t.addForm.title,callback:function(e){t.$set(t.addForm,"title",e)},expression:"addForm.title"}})],1),o("el-card",{staticClass:"mg-t-30",staticStyle:{"padding-bottom":"20px"}},[o("h2",{staticClass:"title"},[t._v(t._s(t.$t("storePage.内容")))]),o("el-divider"),o("div",{staticStyle:{position:"relative"}},[o("quill-editor",{ref:"QuillEditor",staticClass:"editor",attrs:{options:t.editorOption},model:{value:t.addForm.content,callback:function(e){t.$set(t.addForm,"content",e)},expression:"addForm.content"}})],1),o("el-upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{action:"",limit:5,"list-type":"picture-card","before-upload":t.onBeforeUpload,"http-request":t.Upload}},[o("i",{staticClass:"el-icon-plus"})]),o("el-row",{staticClass:"btn-group"},[o("el-button",{staticClass:"btn-size",on:{click:t.onCancel}},[t._v(t._s(t.$t("storePage.取消")))]),o("el-button",{staticClass:"btn-size",attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v(t._s(t.$t("storePage.保存")))])],1)],1)],1)},a=[],i=(o("e456"),o("cf33"),o("d183"),o("8f10"),o("5ad0"),o("121a"),o("7e41"),o("96be"),o("b881")),n={data:function(){return{addForm:{title:"",content:""},type:"add",file:null,loading:!1,editorOption:{modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{script:"sub"},{script:"super"}],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{header:1},{header:2}],[{direction:"rtl"}],["link","image","video"],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}]],handlers:{image:function(t){t?(console.log(t),document.querySelector(".el-upload__input").click()):this.quill.format("image",!1)}}}}}}},components:{quillEditor:i["quillEditor"]},mounted:function(){this.getConfig();var t=this.$route.params.items;this.type=this.$route.params.type,"edit"==this.type&&(this.addForm.title=t.title,this.addForm.content=t.content)},methods:{onBeforeUpload:function(t){this.file=t,console.log(t)},Upload:function(){var t=this,e=this.file,o=function(t){return new Promise((function(e,o){var s=new FileReader;s.readAsDataURL(t),s.onload=function(t){e(this.result)}}))};o(e).then((function(e){var o=e,s=o.match(/data:image\/(.*);base64,.*/);t.ext=s[1],t.base64=o.split("base64,").pop(),t.$apiCall("api.User.uploadImgBase64",{imgUrlBase64:t.base64,ext:t.ext},(function(e){if(9999==e.ErrorCode){console.log(e);var o=t.$refs.QuillEditor.quill;if(e){var s=o.getSelection().index;o.insertEmbed(s,"image",e.Data.Results.imgUrl),o.setSelection(s+1)}else Message.error("图片插入失败")}}))}))},getConfig:function(){var t=this;this.$apiCall("api.VendorShop.getShopConfig",{},(function(e){9999==e.ErrorCode&&e.Data.Results.header&&(t.$store.commit("getShopConfig",e.Data.Results),e.Data.Results.hasOwnProperty("customPage")||t.$store.commit("noThenAdd",[]))}))},goBack:function(){this.$router.push({path:"/store-page"})},onCancel:function(){this.$router.go(-1)},onSubmit:function(){var t=this,e={id:this.$moment().unix(),title:this.addForm.title,content:this.addForm.content,updateTime:this.$moment().unix()};"edit"==this.type?(e.id=this.$route.params.id,this.$store.commit("editCustomPage",e),this.$store.commit("asyncChangeMenu",e)):this.$store.commit("addCustomPage",e),this.loading=!0,this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},(function(e){t.loading=!1,9999==e.ErrorCode?(t.$elementMessage(t.$t("storecode.success"),"success"),t.$router.go(-1)):t.$message({message:e.Message,type:"error"})}))}}},r=n,l=(o("243c"),o("cba8")),c=Object(l["a"])(r,s,a,!1,null,"d9f8d020",null);e["default"]=c.exports},"4f84":function(t,e,o){"use strict";var s=o("7e70"),a=o("71fe"),i=o("3db2"),n=o("1ef5"),r=o("8c6b"),l=o("4839"),c=o("07d2"),d=o("bed2"),u=o("42ce"),g=o("4cd7"),m=o("2574"),p=o("f432"),f=m("slice"),h=g("species"),$=a.Array,v=Math.max;s({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var o,s,a,g=d(this),m=c(g),f=l(t,m),b=l(void 0===e?m:e,m);if(i(g)&&(o=g.constructor,n(o)&&(o===$||i(o.prototype))?o=void 0:r(o)&&(o=o[h],null===o&&(o=void 0)),o===$||void 0===o))return p(g,f,b);for(s=new(void 0===o?$:o)(v(b-f,0)),a=0;f<b;f++,a++)f in g&&u(s,a,g[f]);return s.length=a,s}})},"699b":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"custom-page"}},[s("div",{staticClass:"page-title"},[s("h2",[t._v(t._s(t.$t("storePage.自定义页面")))]),t.items.length>0?s("el-button",{attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),size:"mini",type:"primary"},on:{click:t.addPage}},[t._v(t._s(t.$t("storePage.创建新页面")))]):t._e()],1),s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{minHeight:"200px"}},[t.loading||t.items.length||t.deleteStatus?t._e():s("div",{staticClass:"no-code"},[s("div",{staticClass:"image"},[s("img",{attrs:{src:o("7841"),alt:""}})]),s("div",{staticClass:"content"},[s("h3",[t._v(t._s(t.$t("storePage.定制专属页面")))]),s("p",[t._v(t._s(t.$t("storePage.快速创建")))]),s("button",{on:{click:t.addPage}},[t._v(t._s(t.$t("storePage.创建页面")))])])]),t.items.length>0?s("div",{staticClass:"list"},[s("el-table",{attrs:{data:t.items}},[s("el-table-column",{attrs:{type:"selection"}}),s("el-table-column",{attrs:{label:t.$t("storePage.页面标题"),prop:"title"}}),s("el-table-column",{attrs:{label:t.$t("storePage.最后修改日期")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(1e3*e.row.updateTime).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}],null,!1,643219435)}),s("el-table-column",{attrs:{label:t.$t("storePage.操作")},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-link",{attrs:{type:"primary",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(o){return t.onEditor(e.row)}}},[t._v(t._s(t.$t("storePage.编辑")))]),s("el-link",{staticClass:"mg-l-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"warning"},on:{click:function(o){return t.deleteFn(e.row.id)}}},[t._v(t._s(t.$t("storePage.删除")))])]}}],null,!1,3451165159)})],1),s("el-row",{staticClass:"pagination mg-t-20"},[s("el-pagination",{attrs:{"current-page":t.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"page-size":t.rowsPerPage,total:t.totalCount},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)],1):t._e()])],1)},a=[],i=(o("f203"),o("1baf"),o("4f84"),o("5ad0"),{data:function(){return{configJson:null,deleteStatus:!1,page:this.$route.query.page?Number(this.$route.query.page):1,pageSize:[10,20,50,100],rowsPerPage:localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))?Number(localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))):10}},computed:{items:function(){var t=(this.page-1)*this.rowsPerPage,e=this.page*this.rowsPerPage;return this.$store.state.configJson.customPage?this.$store.state.configJson.customPage.slice(t,e):[]},totalCount:function(){return this.$store.state.configJson.customPage.length},totalPage:function(){return Math.ceil(this.$store.state.configJson.customPage.length/this.rowsPerPage)}},created:function(){this.getItem()},methods:{changePageSize:function(t){this.rowsPerPage=t,localStorage.setItem("".concat(this.$route.name,"RowsPerPage"),t)},toPage:function(t){this.page=t,this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0},onEditor:function(t){this.$router.push({name:"addPage",params:{items:t||"",id:t&&t.id||"",type:t&&t.id>0?"edit":""}})},deleteFn:function(t){var e=this;this.$confirm(this.$t("storecode.delete1"),"",{confirmButtonText:this.$t("storecode.confirm"),cancelButtonText:this.$t("storecode.cancel"),type:""}).then((function(){e.loading=!0,e.deleteStatus=!0,e.$store.commit("deletetCustomPage",t),setTimeout((function(){e.loading=!0,e.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(e.$store.state.configJson)},(function(t){9999==t.ErrorCode?(setTimeout((function(){e.deleteStatus=!1}),500),e.page>e.totalPage&&(e.page=e.totalPage),e.$elementMessage(e.$t("storecode.success"),"success"),e.getItem()):e.$message({message:t.Message,type:"error"}),e.loading=!1}))}),300)})).catch((function(){}))},addPage:function(){this.$router.push({path:"/add-page"})},getItem:function(){var t=this;this.loading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},(function(e){t.loading=!1,9999==e.ErrorCode?(t.$store.commit("getShopConfig",e.Data.Results),e.Data.Results.hasOwnProperty("customPage")||t.$store.commit("noThenAdd",[]),t.configJson=e.Data.Results):t.$message({message:e.Message,type:"error"})}))}}}),n=i,r=(o("30d7"),o("cba8")),l=Object(r["a"])(n,s,a,!1,null,"2655050d",null);e["default"]=l.exports},7841:function(t,e,o){t.exports=o.p+"img/custom-page.c6f0bec3.png"},a4f1:function(t,e,o){},c99a:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"contentpanel transaction-page"},[t.items.length?s("div",{ref:"pageHeader",staticClass:"pagetitle"},[s("div",{staticClass:"left"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-zidingyidaima"}),s("h2",[t._v(t._s(t.$t("storecode.title")))])])]),s("div",{staticClass:"right"},[s("el-button",{attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary",size:"medium"},on:{click:t.addCode}},[t._v(t._s(t.$t("storecode.addtitle")))])],1)]):t._e(),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[s("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[s("el-col",{attrs:{span:24}},[s("el-card",[t.loading||t.items.length?s("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.items,"tooltip-effect":"dark","row-key":function(t){return t.id}}},[s("el-table-column",{attrs:{label:t.$t("storecode.codename")},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.name||"---"))])]}}])}),s("el-table-column",{attrs:{label:t.$t("storecode.tap")},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.pages||"---"))])]}}])}),s("el-table-column",{attrs:{label:t.$t("storecode.position")},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.position||"---"))])]}}])}),s("el-table-column",{attrs:{label:t.$t("storecode.action"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[s("el-link",{staticClass:"mg-r-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary"},on:{click:function(o){return t.addCode(e.row)}}},[t._v(" "+t._s(t.$t("storecode.edit"))+" ")]),s("el-link",{staticClass:"mg-r-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary"},on:{click:function(o){return t.deleteFn(e.row.id)}}},[t._v(" "+t._s(t.$t("storecode.delete"))+" ")])],1)]}}])})],1):s("div",{staticClass:"no-code"},[s("img",{attrs:{src:o("2239"),width:"800"}}),s("h3",[t._v(t._s(t.$t("storecode.title1")))]),s("p",[t._v(t._s(t.$t("storecode.title2")))]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.addCode}},[t._v(t._s(t.$t("storecode.addtitle")))])],1)],1)],1)],1)],1),s("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:20}})],1)},a=[],i=(o("f203"),o("5ad0"),{data:function(){return{loading:!1,pageSizes:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("storecodeRowsPerPage")?Number(localStorage.getItem("storecodeRowsPerPage")):10,items:[],configJson:[],total:0,totalPage:0,setting:null}},components:{},watch:{$route:"gotoPage"},mounted:function(){this.getItem()},methods:{deleteFn:function(t){var e=this;this.$confirm(this.$t("storecode.delete1"),"",{confirmButtonText:this.$t("storecode.confirm"),cancelButtonText:this.$t("storecode.cancel"),type:""}).then((function(){e.$store.commit("deletetCustomCode",t),setTimeout((function(){e.loading=!0,e.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(e.$store.state.configJson)},(function(t){e.loading=!1,9999==t.ErrorCode?(e.$elementMessage(e.$t("storecode.success"),"success"),e.getItem()):e.$message({message:t.Message,type:"error"})}))}),300)})).catch((function(){}))},addCode:function(t){this.$router.push({name:"addCode",params:{items:t||"",id:t&&t.id||"",type:t&&t.id>0?"edit":""}})},toPage:function(t){t!=this.$route.query.page&&this.$router.push({query:{page:t}})},changePageSize:function(t){this.rowsPerPage=t,localStorage.setItem("storecodeRowsPerPage",t),this.getItem()},gotoPage:function(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()},getItem:function(t){var e=this;this.loading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},(function(t){e.loading=!1,9999==t.ErrorCode?(e.$store.commit("getStoreComponent",t.Data.Results),e.configJson=t.Data.Results,e.items=e.configJson.customCode||[]):e.$message({message:t.Message,type:"error"})}))}}}),n=i,r=(o("1912"),o("cba8")),l=Object(r["a"])(n,s,a,!1,null,"2662e174",null);e["default"]=l.exports}}]);