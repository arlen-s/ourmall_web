(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["menuEditor"],{"069c":function(t,e,a){t.exports=a.p+"img/noData.46b81b49.png"},"0b37":function(t,e,a){},"332d":function(t,e,a){"use strict";a("ea98")},3964:function(t,e,a){"use strict";a("0b37")},"3ca4":function(t,e,a){},"88a7":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-product"},[e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.data.loading,expression:"data.loading"}],attrs:{visible:t.data.isShow,title:t.$t("storeSetting.选择商品"),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)},close:t.closeDialog}},[e("el-divider"),e("div",[e("el-form",{staticStyle:{"margin-bottom":"10px !important"},attrs:{inline:!0,size:"mini"}},[t.up?t._e():e("el-form-item",[e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:t.$t("storeSetting.请选择")},on:{change:function(e){return t.filterGetItem("status")}},model:{value:t.filterData.status,callback:function(e){t.$set(t.filterData,"status",e)},expression:"filterData.status"}},[e("el-option",{attrs:{label:t.$t("storeSetting.全部"),value:""}}),e("el-option",{attrs:{label:t.$t("storeSetting.上架"),value:"1"}}),e("el-option",{attrs:{label:t.$t("storeSetting.下架"),value:"2"}})],1)],1),e("el-form-item",[e("el-input",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:t.$t("goods.商品名称")},on:{clear:function(e){return t.clearFilter("name")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem()}},model:{value:t.filterData.name,callback:function(e){t.$set(t.filterData,"name",e)},expression:"filterData.name"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"0"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterGetItem()}}},[t._v(t._s(t.$t("myinvoice.filter")))]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.clearFilter()}}},[t._v(t._s(t.$t("goods.重置")))])],1)],1)],1),e("el-divider"),e("div",{staticClass:"action"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.goToGoods}},[t._v(t._s(t.$t("storeSetting.管理商品")))]),e("div",{staticClass:"refresh",on:{click:t.getItems}},[e("i",{staticClass:"el-icon-refresh-right"}),e("span",{staticClass:"mg-l-5"},[t._v(t._s(t.$t("storeSetting.刷新")))])])],1),e("el-divider"),t.data.item&&t.data.item.length&&null==t.data.variableId?e("el-table",{ref:"productTable",attrs:{data:t.data.item,stripe:"",height:"300px"}},[e("el-table-column",{attrs:{label:"",width:"60"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.statusIpt?e("el-radio",{staticClass:"none-label",attrs:{label:a.row.id},model:{value:t.productData,callback:function(e){t.productData=e},expression:"productData"}},[t._v(t._s(""))]):t._e()]}}],null,!1,768795816)}),e("el-table-column",{attrs:{label:t.$t("goods.商品图片"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{width:"60px",height:"60px",border:"1px solid #ddd","background-color":"#fff"},attrs:{src:t.row.imgUrl,fit:"contain","scroll-container":".main-scroll .el-scrollbar__wrap","preview-src-list":t.row.imgUrlArr}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,2968517507)}),e("el-table-column",{attrs:{label:t.$t("goods.商品名称")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("p",{staticClass:"tx-ellipsis3",staticStyle:{"line-height":"22px"}},[t._v(t._s(a.row.name))])]}}],null,!1,2941362605)}),e("el-table-column",{attrs:{label:t.$t("storeSetting.状态"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.statusIpt?e("el-tag",[t._v(t._s(t.$t("storeSetting.上架")))]):e("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.$t("storeSetting.下架")))])]}}],null,!1,73026675)})],1):t.data.item&&t.data.item.length&&t.data.variableId?e("div",[e("el-table",{staticClass:"no-hover",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.data.item,height:"300px"}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"","show-header":!1,data:a.row.stocks}},[e("el-table-column",{attrs:{label:t.$t("orders.select"),width:"55"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-radio",{attrs:{label:s.row.sku},on:{change:function(e){return t.changeHandler(s.row.sku,a.row)}},model:{value:t.tableRadio,callback:function(e){t.tableRadio=e},expression:"tableRadio"}},[e("i")])]}}],null,!0)}),e("el-table-column",{attrs:{label:t.$t("orders.productinfo")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"d-flex"},[e("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:a.row.propertyImage,fit:"cover"}}),e("div",{staticClass:"mg-l-20"},[e("p",[t._v(t._s(a.row.name))]),e("p",[t._v("SKU: "+t._s(a.row.sku))])])],1)]}}],null,!0)})],1)]}}])}),e("el-table-column",{attrs:{label:t.$t("orders.productinfo")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"d-flex"},[e("img",{attrs:{src:a.row.imgUrl,width:"60",height:"60"}}),e("div",{staticClass:"mg-l-20"},[e("p",[t._v(t._s(a.row.name))]),e("p",[t._v("SPU: "+t._s(a.row.sku))])])])]}}])})],1)],1):e("div",{staticClass:"no-data"},[e("img",{attrs:{src:a("069c")}}),e("div",[t._v(t._s(t.$t("storeSetting.暂无数据"))+"，"),e("span",{on:{click:t.goToGoods}},[t._v(t._s(t.$t("storeSetting.去添加商品")))])])]),e("div",{ref:"tableFooter",staticStyle:{margin:"10px 0 20px"}},[t.data.item&&t.data.item.length?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",[e("el-pagination",{attrs:{small:"","current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"pager-count":Number(5),"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDialog}},[t._v(t._s(t.$t("storeSetting.取消")))]),e("el-button",{attrs:{type:"primary",disabled:t.data.variableId?!t.tableRadio:!t.productData},on:{click:t.AddGoods}},[t._v(t._s(t.$t("storeSetting.添加")))])],1)],1)],1)},i=[],l=(a("14d9"),{props:["data","up"],data(){return{host:location.host,productItem:{},productData:"",filterData:{name:"",status:""},tableRadio:"",defaultFilterData:"{}",pageSize:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem(this.$route.name+"RowsPerPage")?Number(localStorage.getItem(this.$route.name+"RowsPerPage")):10,total:0,totalPage:0,loading:!1}},mounted(){this.up&&(this.filterData.status=1),this.getItems(),this.defaultFilterData=JSON.stringify(this.filterData)},watch:{$route:"gotoPage","data.menuData":{deep:!0,handler(){this.data.menuData.urlData&&(this.productData=this.data.menuData.urlData.id)}}},methods:{getItems(){this.loading=!0,this.$apiCall("api.VendorShop.vendorFindProducts",{page:this.page,rowsPerPage:this.rowsPerPage,name:this.filterData.name,status:this.filterData.status},t=>{this.tableRadio="",this.loading=!1,9999==t.ErrorCode?(this.data.item=t.Data.Results.products.map(t=>(t.imgUrlArr=JSON.parse(t.imgUrlJson),t.statusIpt="1"==t.status,t)),this.total=Number(t.Data.Pagination.totalCount),this.totalPage=Number(t.Data.Pagination.totalPage),this.$refs.productTable&&(this.$refs.productTable.bodyWrapper.scrollTop=0)):this.$message({message:t.Message,type:"error"})})},changeHandler(t,e){this.productItem=e,console.log(this.tableRadio,"vcvsdf"),console.log(e)},filterGetItem(){this.page=1,this.productData="",this.getItems()},clearFilter(t){switch(t){case"name":this.filterData.name="";break;default:this.filterData=JSON.parse(this.defaultFilterData)}"none"!=t&&this.toPage(1)},AddGoods(){this.productItem?(this.data.item.forEach(t=>{t.id==this.productData&&(this.productItem=t)}),"menuEditor"==this.$route.name?this.$emit("selectedProduct",this.productItem):"quotationGoods"==this.$route.name?(this.$parent.form.id=this.productItem.id,this.$parent.form.imgUrl=this.productItem.imgUrl,this.$parent.form.cost=this.productItem.cost,this.$parent.form.vendorSku=this.tableRadio,this.$parent.form={...this.$parent.form}):(this.$parent.setting.name=this.productItem.name,this.$parent.setting.cost=this.productItem.cost,this.$parent.setting.imgUrl=this.productItem.imgUrl,this.$parent.setting.id=this.productItem.id,this.$parent.setting={...this.$parent.setting}),this.closeDialog()):this.$message({message:"请选择一件商品",type:"error"})},goToGoods(){this.$router.push("/goods-mgr/all")},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.$nextTick(()=>{this.getItems()})},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t,cid:this.$route.query.cid,id:this.$route.query.id}}):this.getItems()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem(this.$route.name+"RowsPerPage",t),this.getItems()},closeDialog(){this.page=1,"quotationGoods"==this.$route.name?this.$router.push({query:{id:this.$route.query.id,variableId:this.data.variableId}}):this.$router.push({query:{cid:this.$route.query.cid,variableId:this.data.variableId}}),this.data.item={},this.productData="",this.productItem={},this.tableRadio="",this.filterData=JSON.parse(this.defaultFilterData),this.data.isShow=!1}},components:{}}),o=l,r=(a("f601"),a("2877")),n=Object(r["a"])(o,s,i,!1,null,"d1b27e04",null);e["a"]=n.exports},"98cb":function(t,e,a){"use strict";a("af0c")},"9e4f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel edit-menu-page"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"pagebody"},[e("el-card",{staticStyle:{"margin-bottom":"80px"}},[e("h2",{staticClass:"edit-title"},[t._v(t._s(t.$t("menuSetting.编辑")))]),e("el-row",{attrs:{gutter:15}},[e("el-col",{staticClass:"edit-row",attrs:{span:24}},[e("span",{staticClass:"tx-danger"},[t._v("*")]),e("span",{staticClass:"m-label"},[t._v(t._s(t.$t("menuSetting.菜单名称:")))]),e("el-input",{staticStyle:{width:"600px"},attrs:{maxlength:"50","show-word-limit":""},model:{value:t.editItem.name,callback:function(e){t.$set(t.editItem,"name",e)},expression:"editItem.name"}})],1)],1),e("el-divider"),e("el-row",{attrs:{gutter:15}},[t.hasMenuNum?[e("el-col",{staticClass:"setting-msg",attrs:{span:24}},[t._v(t._s(t.$t("menuSetting.菜单目录结构"))+" "),e("span",[t._v(t._s(t.$t("menuSetting.目录名称会展示在店铺网页上。 (改变顺序可拖拽，建议重下往上拖拽)")))])]),e("el-col",{staticClass:"tree-wrap",attrs:{span:24}},[e("el-tree",{ref:"menuTree",attrs:{data:t.editItem.menu,"node-key":"id",draggable:"","default-expand-all":"","expand-on-click-node":!1,"allow-drop":t.allowDrop},scopedSlots:t._u([{key:"default",fn:function({node:a,data:s}){return e("div",{staticClass:"tree-node"},["bottom"!=s.id?e("div",[e("div",{staticClass:"left"},[e("i",{staticClass:"iconfont",class:s.children&&s.children.length?"icon-sub-nav":"icon-nav"}),e("div",{staticClass:"name",style:{marginRight:"25px"}},[e("el-input",{staticStyle:{width:"200px"},on:{blur:t.eventIpt,focus:t.eventIpt},model:{value:s.label,callback:function(e){t.$set(s,"label",e)},expression:"data.label"}})],1),e("div",{staticClass:"mg-r-15"},[e("el-select",{attrs:{placeholder:t.$t("menuSetting.链接页面")},on:{change:function(e){return t.changeRouter(s)}},model:{value:s.value,callback:function(e){t.$set(s,"value",e)},expression:"data.value"}},t._l(t.$dict.storeMenuArr,(function(a){return e("el-option",{key:a.value,attrs:{label:t.$t(a.label),value:a.value}})})),1)],1),"productDetails"==s.value?e("div",[s.urlData?[e("div",{staticClass:"product-box"},[e("el-image",{staticStyle:{width:"36px",height:"36px",border:"1px #DCDFE6 solid"},attrs:{src:s.urlData.imgUrl,fit:"contain"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]),e("p",{staticClass:"name tx-ellipsis1"},[t._v(" "+t._s(s.urlData.name)+" ")]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openSelect(s)}}},[t._v(t._s(t.$t("menuSetting.更改商品")))])],1)]:e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openSelect(s)}}},[t._v(t._s(t.$t("menuSetting.选择商品")))])],2):t._e(),"category"==s.value?e("div",[s.urlData?[e("div",{staticClass:"product-box"},[e("el-image",{staticStyle:{width:"36px",height:"36px",border:"1px #DCDFE6 solid"},attrs:{src:s.urlData.themeUrl,fit:"contain"}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]),e("p",{staticClass:"name tx-ellipsis1"},[t._v(" "+t._s(s.urlData.name)+" ")]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openSelectCategory(s)}}},[t._v(t._s(t.$t("menuSetting.更改分类")))])],1)]:e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openSelectCategory(s)}}},[t._v(t._s(t.$t("menuSetting.选择分类")))])],2):t._e(),"customPage"==s.value?e("div",[s.urlData?[e("div",{staticClass:"product-box"},[e("p",{staticClass:"name tx-ellipsis1"},[t._v(" "+t._s(s.urlData.title)+" ")]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openSelectCustomPage(s)}}},[t._v(t._s(t.$t("menuSetting.更改自定义页面")))])],1)]:e("div",{staticClass:"d-flex"},[e("el-link",{staticClass:"mg-r-15",attrs:{type:"primary"},on:{click:function(e){return t.openSelectCustomPage(s)}}},[t._v(t._s(t.$t("menuSetting.选择自定义页面")))])],1)],2):t._e(),"9998"==s.value?e("div",{staticClass:"c-url"},[s.url?[e("a",{staticClass:"tx-ellipsis1",staticStyle:{"margin-right":"15px","max-width":"280px"},attrs:{href:s.url,target:"_blank"}},[t._v(t._s(s.url))]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openCustomUrl(s)}}},[t._v(t._s(t.$t("menuSetting.更改")))])]:t._e(),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openCustomUrl(s)}}},[t._v(t._s(t.$t("menuSetting.添加链接")))])],2):t._e()]),e("div",{staticClass:"right"},[s.level<3?e("el-link",{staticStyle:{"margin-right":"25px"},attrs:{type:"primary"},on:{click:function(e){return t.addNewNav(s)}}},[1==s.level?e("span",[t._v(t._s(t.$t("menuSetting.添加二级目录")))]):t._e(),2==s.level?e("span",[t._v(t._s(t.$t("menuSetting.添加三级目录")))]):t._e()]):t._e(),e("el-link",{attrs:{type:"danger"},on:{click:function(e){return t.removeNav(a,s)}}},[t._v(t._s(t.$t("menuSetting.删除")))])],1)]):t._e()])}}],null,!1,1330538048)})],1)]:e("el-col",{attrs:{span:24}},[e("div",{staticClass:"none-menu"},[e("div",{staticClass:"none"}),e("p",[t._v(t._s(t.$t("menuSetting.您还没有添加任何目录")))]),e("div",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addNewNav()}}},[t._v(t._s(t.$t("menuSetting.添加菜单目录")))])],1)])])],2),t.hasMenuNum?e("el-divider",{staticClass:"mg-t--13"}):t._e(),t.hasMenuNum?e("el-row",{attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-link",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:function(e){return t.addNewNav()}}},[t._v(t._s(t.$t("menuSetting.添加菜单目录")))])],1)],1):t._e()],1),t.hasMenuNum?e("div",{staticClass:"action-box"},[e("el-card",[e("div",{staticClass:"action-content"},[e("el-link",{attrs:{type:"danger",disabled:t.editItem.id<3||!t.$isRole(t.$route.meta.roleWrite)},on:{click:t.delMenu}},[t._v(t._s(t.$t("menuSetting.删除菜单")))]),e("el-button",{attrs:{type:"primary",size:"medium",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:t.save}},[t._v(t._s(t.$t("menuSetting.保存")))])],1)])],1):t._e()],1),e("DialogCustomUrl",{attrs:{data:t.dialogCustomUrlData}}),e("selectProduct",{attrs:{data:t.dialogProductList},on:{selectedProduct:t.selectedProduct}}),e("DialogSelectCategory",{ref:"dialogSelectCategory",attrs:{data:t.dialogSelectCategoryData},on:{selectedCategory:t.selectedCategory}}),e("DialogSelectCustomPage",{attrs:{data:t.dialogSelectCustomPageData},on:{selectCustomPage:t.selectCustomPage}})],1)},i=[],l=(a("14d9"),function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.data.isShow,title:"自定义链接","close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[e("el-divider"),e("div",{staticClass:"d-body"},[e("el-form",{attrs:{"label-position":"top","label-width":"120px"}},[e("el-form-item",{attrs:{label:"链接地址"}},[e("el-input",{nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save.apply(null,arguments)}},model:{value:t.data.ipt,callback:function(e){t.$set(t.data,"ipt",e)},expression:"data.ipt"}})],1)],1),t.data.msg?e("div",{staticClass:"error"},[t._v(t._s(t.data.msg))]):t._e()],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("goods.取消")))]),e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)],1)}),o=[],r={props:["data"],methods:{save(){if(this.data.msg="",this.data.ipt){var t=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i");t.test(this.data.ipt)?(this.$set(this.data.item,"url",this.data.ipt),this.data.isShow=!1):this.data.msg="Url格式错误.请填写完整。 （例：https://www.myourmall.com）"}else this.data.msg="Url不能为空"}}},n=r,d=(a("fa8b"),a("2877")),u=Object(d["a"])(n,l,o,!1,null,"c39408b8",null),c=u.exports,g=a("88a7"),m=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("storeSetting.商品分类"),width:"300px",visible:t.data.addCategoryVisible},on:{"update:visible":function(e){return t.$set(t.data,"addCategoryVisible",e)}}},[e("div",{staticClass:"dialog-area"},[e("div",{staticClass:"search"},[e("el-input",{attrs:{size:"mini","suffix-icon":"el-icon-search"},on:{input:t.searchCategory},model:{value:t.data.keyword,callback:function(e){t.$set(t.data,"keyword",e)},expression:"data.keyword"}})],1),e("el-scrollbar",[t.data.displayItems.length>0?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.data.cLoading,expression:"data.cLoading"}],staticClass:"item-area"},[t._l(t.data.displayItems,(function(a,s){return[-1==t.data.selectedIds.indexOf(a.id)?e("div",{key:s},[e("div",{staticClass:"item-list"},[e("div",{staticClass:"left"},[e("el-image",{staticClass:"image",attrs:{fit:"contain",src:a.themeUrl}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]),e("div",{staticClass:"name"},[t._v(t._s(a.name))])],1),e("div",[e("el-radio",{attrs:{label:a},model:{value:t.data.selectedItems,callback:function(e){t.$set(t.data,"selectedItems",e)},expression:"data.selectedItems"}},[e("div",{staticStyle:{display:"none"}},[t._v("1")])])],1)]),e("el-divider")],1):t._e()]})),t.data.selectedIds.length==t.data.displayItems.length?e("div",{staticClass:"no-category"},[t._v(" "+t._s(t.$t("storeSetting.暂无更多类目"))+" ")]):t._e(),e("div",{staticStyle:{height:"20px"}})],2):t._e()]),0==t.data.displayItems.length?e("div",{staticClass:"no-category"},[t._v(" "+t._s(t.$t("storeSetting.暂无类目"))+" "),e("router-link",{attrs:{to:"/category-mgr"}},[t._v(t._s(t.$t("storeSetting.前去添加")))])],1):t._e(),e("div",{staticClass:"control"},[e("router-link",{staticClass:"mg-r-20",attrs:{to:"/category-mgr"}},[t._v(t._s(t.$t("storeSetting.管理商品类目")))]),e("i",{staticClass:"refresh mg-r-20 el-icon-refresh",on:{click:t.getCategory}}),e("el-button",{attrs:{size:"small",type:"primary",disabled:!t.data.selectedItems},on:{click:t.addCategoryHandle}},[t._v(t._s(t.$t("storeSetting.添加")))])],1)],1)])},p=[],h={props:["data"],methods:{addCategoryHandle(){this.$emit("selectedCategory",this.data.selectedItems)},searchCategory(t){let e=[];this.data.items.forEach(a=>{a.name.indexOf(t)>-1&&e.push(a)}),this.data.displayItems=e},getCategory(){this.data.cLoading=!0,this.$apiCall("api.ProductCategory.findByUser",{level:1},t=>{setTimeout(()=>{this.data.cLoading=!1},500),9999==t.ErrorCode&&(this.data.items=t.Data.Results,this.data.displayItems=t.Data.Results,this.data.selectedItems&&this.data.displayItems.forEach(t=>{t.id==this.data.selectedItems.id&&(this.data.selectedItems=t)}))})}}},f=h,v=(a("332d"),Object(d["a"])(f,m,p,!1,null,"01a4efc6",null)),y=v.exports,S=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"自定义页面",width:"400px",visible:t.data.isShow},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[e("el-divider"),e("div",{staticClass:"d-body"},[t.$store.state.configJson.customPage&&t.$store.state.configJson.customPage.length?e("p",{staticClass:"title d-flex"},[e("span",{staticClass:"mg-r-20"},[t._v("选择自定义页面")]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({name:"storePage"})}}},[t._v("管理自定义页面")])],1):t._e(),t.$store.state.configJson.customPage&&t.$store.state.configJson.customPage.length?e("ul",{staticClass:"c-page-li"},t._l(t.$store.state.configJson.customPage,(function(a){return e("li",{key:a.id,staticClass:"tx-ellipsis1"},[e("el-radio",{attrs:{label:a},model:{value:t.data.selected,callback:function(e){t.$set(t.data,"selected",e)},expression:"data.selected"}},[t._v(t._s(a.title))])],1)})),0):e("div",{staticClass:"none-data"},[e("span",{staticClass:"mg-r-20"},[t._v("没有数据")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.$router.push({name:"storePage"})}}},[t._v("管理自定义页面")])],1)]),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("goodsEdit.取消")))]),e("el-button",{attrs:{size:"small",type:"primary",disabled:!t.data.selected},on:{click:t.selectCustomPage}},[t._v(t._s(t.$t("goodsEdit.确定")))])],1)],1)},C=[],b={props:["data"],methods:{selectCustomPage(){this.$emit("selectCustomPage",this.data.selected)}}},_=b,D=(a("3964"),Object(d["a"])(_,S,C,!1,null,"29b28e93",null)),w=D.exports,k={data(){return{isSave:!1,pageLoading:!1,editItem:{id:"",name:"",menu:[]},dialogCustomUrlData:{isShow:!1,ipt:"",error:!1,msg:"",item:{url:""}},defaultDialogCustomUrlData:"{}",dialogProductList:{loading:!1,isShow:!1,item:null,menuData:null},defaultDialogProductList:"{}",dialogSelectCategoryData:{addCategoryVisible:!1,keyword:"",displayItems:[],cLoading:!1,selectedIds:[],selectedItems:null,items:[],menuData:null},defaultDialogSelectCategoryData:"{}",dialogSelectCustomPageData:{isShow:!1,items:[],selected:null,menuData:null},defaultDialogSelectCustomPageData:"{}"}},components:{DialogCustomUrl:c,selectProduct:g["a"],DialogSelectCategory:y,DialogSelectCustomPage:w},computed:{hasMenuNum(){let t=0;return this.editItem.menu.forEach(e=>{"bottom"!=e.id&&t++}),t}},mounted(){this.defaultDialogCustomUrlData=JSON.stringify(this.dialogCustomUrlData),this.defaultDialogProductList=JSON.stringify(this.dialogProductList),this.defaultDialogSelectCategoryData=JSON.stringify(this.dialogSelectCategoryData),this.defaultDialogSelectCustomPageData=JSON.stringify(this.dialogSelectCustomPageData),this.getConfig()},beforeRouteLeave(t,e,a){if("menuEditor"!=t.name)if(this.isSave)a();else{let t=confirm(this.$t("goodsEdit.当前页面还未保存，确定要离开吗?"));t?a():a(!1)}else a()},methods:{save(){if(!this.editItem.name)return void this.$message({message:"请输入菜单名称",type:"error"});if(this.editItem.menu.length){let t="";if(this.editItem.menu.some(e=>{if("bottom"!=e.id)return e.label||(t="菜单名必须填写;"),e.children.some(e=>(e.label||(t="菜单名必须填写;"),e.children.some(e=>(e.label||(t="菜单名必须填写;"),t)),t)),t}),t)return void this.$message({message:t,type:"error"})}let t=JSON.parse(JSON.stringify(this.editItem));t.menu.forEach((e,a)=>{"bottom"==e.id&&t.menu.splice(a,1)});let e=JSON.parse(JSON.stringify(this.$store.state.configJson));e.menu.findIndex(e=>e.id==t.id)>-1&&e.menu.splice(e.menu.findIndex(e=>e.id==t.id),1),e.menu.unshift(t),e.menu.map((t,a)=>{"2"==t.id&&e.menu.unshift(e.menu.splice(a,1)[0])}),e.menu.map((t,a)=>{"1"==t.id&&e.menu.unshift(e.menu.splice(a,1)[0])}),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(e)},t=>{9999==t.ErrorCode?(this.isSave=!0,this.$elementMessage(this.$t("storeSetting.保存成功"),"success"),this.$router.push({name:"menuSetting"})):this.$message({message:t.Message,type:"error"})})},delMenu(){this.$confirm(this.$t("menuSetting.是否要删除菜单"),"",{confirmButtonText:this.$t("products.删除"),cancelButtonText:this.$t("products.取消"),confirmButtonClass:"el-button--danger"}).then(()=>{this.$store.commit("delMenu",this.editItem.id),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},t=>{9999==t.ErrorCode?(this.isSave=!0,this.$elementMessage(this.$t("shop.删除成功"),"success"),this.$router.push({name:"menuSetting"})):this.$message({message:t.Message,type:"error"})})})},selectCustomPage(t){this.dialogSelectCustomPageData.menuData.urlData=t,this.dialogSelectCustomPageData.isShow=!1},openSelectCustomPage(t){this.dialogSelectCustomPageData=JSON.parse(this.defaultDialogSelectCustomPageData),this.dialogSelectCustomPageData.menuData=t,this.dialogSelectCustomPageData.isShow=!0},selectedCategory(t){this.dialogSelectCategoryData.menuData.urlData=t,this.dialogSelectCategoryData.addCategoryVisible=!1},openSelectCategory(t){this.dialogSelectCategoryData=JSON.parse(this.defaultDialogSelectCategoryData),this.dialogSelectCategoryData.menuData=t,t.urlData&&(this.dialogSelectCategoryData.selectedItems=t.urlData),this.dialogSelectCategoryData.addCategoryVisible=!0,this.$refs.dialogSelectCategory.getCategory()},openCustomUrl(t){this.dialogCustomUrlData=JSON.parse(this.defaultDialogCustomUrlData),this.dialogCustomUrlData.item=t,this.dialogCustomUrlData.ipt=t.url,this.dialogCustomUrlData.isShow=!0},removeNav(t,e){const a=t.parent,s=a.data.children||a.data,i=s.findIndex(t=>t.id===e.id);s.splice(i,1)},addNewNav(t){let e=JSON.parse(JSON.stringify(this.$store.state.navDefault));t?(e.id=(new Date).getTime(),e.level=t.level+1,t.children.push(e)):(this.editItem.menu.splice(this.editItem.menu.findIndex(t=>"bottom"==t.id),1),e.id=(new Date).getTime(),e.level=1,this.editItem.menu.push(e),this.editItem.menu.push({id:"bottom"}))},changeRouter(t){this.urlSync(t),"9998"==t.value&&this.openCustomUrl(t),"productDetails"==t.value&&this.openSelect(t),"category"==t.value&&this.openSelectCategory(t),"customPage"==t.value&&this.openSelectCustomPage(t)},urlSync(t){this.$dict.storeMenuArr.forEach(e=>{e.value==t.value&&(t.url=e.url)}),t.urlData=null},allowDrop(t,e,a){return t.level===e.level&&1==e.level?"prev"===a||"text"===a:t.level===e.level},openSelect(t){this.dialogProductList=JSON.parse(this.defaultDialogProductList),this.dialogProductList.menuData=t,this.getItems(),this.dialogProductList.isShow=!0},getItems(){this.dialogProductList.loading=!0,this.$apiCall("api.VendorShop.vendorFindProducts",{page:1,rowsPerPage:10},t=>{this.dialogProductList.loading=!1,9999==t.ErrorCode?this.dialogProductList.item=t.Data.Results.products.map(t=>(t.imgUrlArr=JSON.parse(t.imgUrlJson),t.statusIpt="1"==t.status,t)):this.$message({message:t.Message,type:"error"})})},selectedProduct(t){this.dialogProductList.menuData.urlData=t},getConfig(){this.pageLoading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},t=>{this.pageLoading=!1,9999==t.ErrorCode&&0!==t.Data.Results.length&&(this.$store.commit("getShopConfig",t.Data.Results),t.Data.Results.menu&&t.Data.Results.menu.length||this.$store.commit("getDefaultMenu"),this.$route.query.id?(this.$store.state.configJson.menu.forEach(t=>{t.id==this.$route.query.id&&(this.editItem=JSON.parse(JSON.stringify(t)))}),this.editItem.id||(this.editItem.id=this.$route.query.id),this.editItem.menu.push({id:"bottom"})):(this.$message({message:"error",type:"error"}),this.isSave=!0,this.$router.push({name:"menuSetting"})))})},eventIpt(t){"focus"==t.type&&$(".el-tree-node").removeAttr("draggable"),"blur"==t.type&&$(".el-tree-node").attr("draggable","true")}}},I=k,x=(a("ad23a"),a("98cb"),Object(d["a"])(I,s,i,!1,null,"d25c4d52",null));e["default"]=x.exports},abb5:function(t,e,a){},ad23a:function(t,e,a){"use strict";a("abb5")},af0c:function(t,e,a){},ea98:function(t,e,a){},f601:function(t,e,a){"use strict";a("3ca4")},f759:function(t,e,a){},fa8b:function(t,e,a){"use strict";a("f759")}}]);