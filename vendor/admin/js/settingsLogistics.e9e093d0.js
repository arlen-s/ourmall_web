(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["settingsLogistics"],{"00ee":function(t,e,s){"use strict";var i=s("b622"),a=i("toStringTag"),r={};r[a]="z",t.exports="[object z]"===String(r)},2181:function(t,e,s){},"271a":function(t,e,s){"use strict";var i=s("cb2d"),a=s("e330"),r=s("577e"),l=s("d6d6"),n=URLSearchParams,o=n.prototype,c=a(o.getAll),p=a(o.has),g=new n("a=1");!g.has("a",2)&&g.has("a",void 0)||i(o,"has",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return p(this,t);var i=c(this,t);l(e,1);var a=r(s),n=0;while(n<i.length)if(i[n++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},"509f":function(t,e,s){"use strict";s("2181")},5494:function(t,e,s){"use strict";var i=s("83ab"),a=s("e330"),r=s("edd0"),l=URLSearchParams.prototype,n=a(l.forEach);i&&!("size"in l)&&r(l,"size",{get:function(){var t=0;return n(this,(function(){t++})),t},configurable:!0,enumerable:!0})},5596:function(t,e,s){},"577e":function(t,e,s){"use strict";var i=s("f5df"),a=String;t.exports=function(t){if("Symbol"===i(t))throw new TypeError("Cannot convert a Symbol value to a string");return a(t)}},"6693f":function(t,e,s){},"6a75":function(t,e,s){"use strict";s("8d71")},"88a7f":function(t,e,s){"use strict";var i=s("cb2d"),a=s("e330"),r=s("577e"),l=s("d6d6"),n=URLSearchParams,o=n.prototype,c=a(o.append),p=a(o["delete"]),g=a(o.forEach),d=a([].push),h=new n("a=1&a=2&b=3");h["delete"]("a",1),h["delete"]("b",void 0),h+""!=="a=2"&&i(o,"delete",(function(t){var e=arguments.length,s=e<2?void 0:arguments[1];if(e&&void 0===s)return p(this,t);var i=[];g(this,(function(t,e){d(i,{key:e,value:t})})),l(e,1);var a,n=r(t),o=r(s),h=0,u=0,f=!1,m=i.length;while(h<m)a=i[h++],f||a.key===n?(f=!0,p(this,a.key)):u++;while(u<m)a=i[u++],a.key===n&&a.value===o||c(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},"8a57":function(t,e,s){},"8d71":function(t,e,s){},9751:function(t,e,s){"use strict";s("5596")},"9c4b":function(t,e,s){},"9cab":function(t,e,s){},a4dc:function(t,e,s){},abd9:function(t,e,s){"use strict";s("9c4b")},cab9:function(t,e,s){"use strict";s("a4dc")},d055:function(t,e,s){"use strict";s("9cab")},d6d6:function(t,e,s){"use strict";var i=TypeError;t.exports=function(t,e){if(t<e)throw new i("Not enough arguments");return t}},d90e:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel edit-logistics-page"},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"el-icon-guide"}),e("h2",[t._v(" "+t._s(t.id?t.$t("logistics.编辑"):t.$t("logistics.添加"))+t._s(t.$t("logistics.区域方案"))+" ")])])]),e("div",{staticClass:"right"},[e("el-button",{on:{click:function(e){return t.goto("logistics")}}},[t._v(t._s(t.$t("logistics.取消")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v(t._s(t.$t("logistics.保存")))])],1)]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[e("el-card",[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{staticClass:"link-a",attrs:{to:{path:"/logistics"}}},[e("i",{staticClass:"el-icon-arrow-right"}),t._v(" "+t._s(t.$t("logistics.返回列表"))+" ")])],1),e("el-divider"),e("div",{staticClass:"project-wrap"},[e("div",{staticClass:"ipt-group"},[e("div",{staticClass:"ipt-label"},[t._v(" "+t._s(t.$t("logistics.区域方案名称 (该名称不会展示给客户查看):"))+" "),e("span",{staticClass:"required"},[t._v("*")])]),e("el-input",{attrs:{placeholder:t.$t("logistics.请输入名称"),maxlength:"50"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.name.length)+" / 50")])])],1),e("div",{staticClass:"shipping-area-wrap"},[e("div",{staticClass:"title"},[e("div",{staticClass:"left"},[t._v(" "+t._s(t.$t("logistics.配送区域"))+" "),e("span",{staticClass:"required"},[t._v("*")]),t._v(" "+t._s(t.$t("logistics.(请添加当前方案适用的国家/地区)"))+" ")]),e("div",{staticClass:"right"},[e("div",{staticClass:"num"},[t._v(" "+t._s(t.$t("logistics.当前已添加"))+" "),e("b",[t._v(t._s(t.countrys.length))]),t._v(" "+t._s(t.$t("logistics.个国家/地区"))+" ")]),e("el-link",{staticClass:"collapse-arr",attrs:{underline:!1},on:{click:t.changeAreaCollapse}},[e("i",{class:t.tabArea?"el-icon-arrow-up":"el-icon-arrow-down"})]),e("el-button",{staticClass:"add-btn",attrs:{type:"primary",size:"small"},on:{click:t.openDrawerSelectCountry}},[t._v(t._s(t.$t("logistics.添加国家/地区")))])],1)]),e("el-collapse",{attrs:{value:t.tabArea}},[e("el-collapse-item",{attrs:{name:"1"}},[e("el-table",{ref:"areaTable",attrs:{height:"280",data:t.countrys,stripe:""}},[e("el-table-column",{attrs:{label:t.$t("logistics.操作"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-link",{staticClass:"mg-r-15",attrs:{type:"danger"},on:{click:function(e){return t.removeArea(s.$index)}}},[t._v(t._s(t.$t("logistics.删除")))]),e("el-link",{attrs:{type:"primary"},on:{click:t.openDrawerSelectCountry}},[t._v(t._s(t.$t("logistics.编辑")))])]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.国家地区")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"d-flex"},[e("span",{staticClass:"mg-r-20"},[t._v(t._s(s.row.label))]),e("div",{staticClass:"iti-flag",class:s.row.value.toLowerCase()})])]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.分地区"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(){return[t._v(" "+t._s(t.$t("logistics.全部"))+" ")]},proxy:!0}])})],1)],1)],1)],1),e("div",{staticClass:"shipping-price-wrap"},[e("div",{staticClass:"title"},[e("div",{staticClass:"left"},[t._v(" "+t._s(t.$t("logistics.运费方案"))+" "),e("span",{staticClass:"required"},[t._v("*")])]),e("div",{staticClass:"right"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.openDrawerShipping}},[t._v(t._s(t.$t("logistics.添加运费方案")))]),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.openImportShipping}},[t._v(t._s(t.$t("logistics.导入运费方案")))])],1)]),e("el-table",{ref:"shippingTable",attrs:{data:t.shippings,stripe:""}},[e("el-table-column",{attrs:{label:t.$t("logistics.操作"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-link",{staticClass:"mg-r-15",attrs:{type:"danger"},on:{click:function(e){return t.removeShipping(s.$index)}}},[t._v(t._s(t.$t("logistics.删除")))]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.editShipping(s.row)}}},[t._v(t._s(t.$t("logistics.编辑")))])]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.方案名称")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("p",[t._v(t._s(s.row.name))]),s.row.nameDisplay?e("p",[t._v(t._s(s.row.nameDisplay))]):t._e()]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.运费"),width:"500"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("TableFreight",{attrs:{item:t.row}})]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.时效天数")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.agingDaysBegin)+" - "+t._s(e.row.agingDaysEnd)+" "+t._s(t.$t("logistics.天"))+" ")]}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.商品属性")},scopedSlots:t._u([{key:"default",fn:function(s){return t._l(s.row.productType,(function(s,i){return e("div",{key:i},[t._v(" "+t._s(t.$dict.productType[s]?t.$t(t.$dict.productType[s].text):"")+" ")])}))}}])}),e("el-table-column",{attrs:{label:t.$t("logistics.计算规则"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("TableWeight",{attrs:{item:t.row}})]}}])})],1)],1)])],1)],1),e("div",{staticClass:"page-footer"},[e("div",[e("el-button",{on:{click:function(e){return t.goto("logistics")}}},[t._v(t._s(t.$t("logistics.取消")))]),t.id?e("el-button",{attrs:{type:"danger"},on:{click:t.delAreaShipping}},[t._v(t._s(t.$t("logistics.删除该区域方案")))]):t._e(),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.save()}}},[t._v(t._s(t.$t("logistics.保存")))])],1)]),e("DrawerSelectCountry",{attrs:{data:t.DrawerSelectCountryData,arr:t.countryArr},on:{setCountry:t.setCountry}}),e("DrawerShipping",{attrs:{data:t.DrawerShippingsData},on:{setShipping:t.setShipping}}),e("DialogImport",{attrs:{data:t.dialogImportData},on:{uploadSuccess:t.uploadSuccess}})],1)},a=[],r=(s("14d9"),s("6693f"),s("c895")),l=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"drawer-select-country",attrs:{title:t.$t("logistics.区域设置"),visible:t.data.isShow,size:"600","before-close":t.beforeClose},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)},opened:t.opened}},[e("el-divider"),e("div",{staticClass:"d-body"},[e("div",{staticClass:"ipt-wrap"},[e("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:t.$t("logistics.请输入国家/地区名称"),clearable:""},model:{value:t.data.filterText,callback:function(e){t.$set(t.data,"filterText",e)},expression:"data.filterText"}})],1),e("el-tree",{ref:"countryTree",attrs:{data:t.arr,"show-checkbox":"","highlight-current":"","node-key":"value","filter-node-method":t.filterNode,"check-strictly":!1},on:{"check-change":t.changeTree,"node-click":t.nodeClick},scopedSlots:t._u([{key:"default",fn:function({node:s,data:i}){return e("span",{staticClass:"custom-tree-node"},[e("span",[t._v(t._s(s.label))]),i.children?e("span",{staticStyle:{color:"#909399"}},[t._v(" ( "),e("span",{staticStyle:{color:"#303133"}},[t._v(t._s(t.selectedData.num[i.id])+" ")]),t._v("/"+t._s(i.children.length)+") ")]):t._e()])}}])})],1),e("div",{staticClass:"drawer-footer"},[e("span",{staticClass:"mg-r-20"},[t._v(t._s(t.$t("logistics.已选择"))+" "+t._s(t.selectedData.arr.length)+" "+t._s(t.$t("logistics.个国家/地区")))]),e("el-button",{on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("logistics.取消")))]),e("el-button",{attrs:{type:"primary",loading:t.data.loading},on:{click:t.setCountry}},[t._v(t._s(t.$t("logistics.保存")))])],1)],1)},n=[],o={props:["data","arr"],data(){return{selectedData:{num:{0:0,1:0,2:0,3:0,4:0,5:0},arr:[]}}},watch:{"data.filterText"(t){this.$refs.countryTree.filter(t)}},methods:{nodeClick(t){if(!t.disabled&&t.value){let e=this.$refs.countryTree.getCheckedKeys().filter(t=>t);e.indexOf(t.value)>-1?e=e.filter(e=>e!=t.value):e.push(t.value),this.$refs.countryTree.setCheckedKeys(e)}},changeTree(){let t=t=>t.filter(Boolean);this.selectedData.arr=t(this.$refs.countryTree.getCheckedKeys()),this.selectedData.num={0:0,1:0,2:0,3:0,4:0,5:0},this.arr.forEach((t,e)=>{t.children.forEach(t=>{this.selectedData.arr.indexOf(t.value)>-1&&this.selectedData.num[e]++})})},filterNode(t,e){return!t||-1!==e.label.toLowerCase().indexOf(t.toLowerCase())},setCountry(){if(!this.selectedData.arr.length)return void this.$elementMessage(this.$t("logistics.请选择国家/地区"),"error");let t=[];this.selectedData.arr.forEach(e=>{this.arr.forEach(s=>{s.children.forEach(s=>{s.value==e&&t.push({label:s.label,value:s.value})})})}),this.$emit("setCountry",t)},opened(){this.$refs.countryTree.setCheckedKeys(this.data.openedArr),this.changeTree()},beforeClose(t){this.$confirm(this.$t("logistics.确认关闭？  将不会保存改变。")).then(e=>{t()}).catch(t=>{})}}},c=o,p=(s("abd9"),s("6a75"),s("2877")),g=Object(p["a"])(c,l,n,!1,null,"c7a81082",null),d=g.exports,h=function(){var t=this,e=t._self._c;return e("el-drawer",{staticClass:"drawer-shipping",attrs:{title:`${t.data.form.tId?t.$t("logistics.编辑"):t.$t("logistics.添加")}${t.$t("logistics.运费方案")}`,visible:t.data.isShow,size:"1080px","before-close":t.beforeClose},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)},open:t.open}},[e("el-divider"),e("div",{staticClass:"d-body"},[e("el-form",{ref:"ShoppingForm",attrs:{"label-position":"top",model:t.data.form,"label-width":"120px"}},[e("el-form-item",{attrs:{label:t.$t("logistics.名称"),required:""}},[e("el-input",{attrs:{placeholder:t.$t("logistics.请输入名称"),maxlength:"30"},model:{value:t.data.form.name,callback:function(e){t.$set(t.data.form,"name",e)},expression:"data.form.name"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.data.form.name.length?t.data.form.name.length:0)+" / 30")])])],1),e("el-form-item",{attrs:{label:t.$t("logistics.别名")}},[e("el-input",{attrs:{placeholder:t.$t("logistics.请输入方案别名"),maxlength:"30"},model:{value:t.data.form.nameDisplay,callback:function(e){t.$set(t.data.form,"nameDisplay",e)},expression:"data.form.nameDisplay"}},[e("span",{attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.data.form.nameDisplay?t.data.form.nameDisplay.length:0)+" / 30")])])],1),e("el-form-item",{staticStyle:{position:"relative"},attrs:{label:t.$t("logistics.方案说明")}},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:t.$t("logistics.请输入200个字以内的物流方案说明")},model:{value:t.data.form.remark,callback:function(e){t.$set(t.data.form,"remark",e)},expression:"data.form.remark"}}),e("span",{staticClass:"textarea-len",staticStyle:{color:"#909399"}},[e("span",{style:{color:t.data.form.remark&&t.data.form.remark.length>200?"#F56C6C":"#909399"}},[t._v(t._s(t.data.form.remark&&t.data.form.remark.length?t.data.form.remark.length:0))]),t._v(" / 200")])],1),e("el-form-item",{attrs:{label:t.$t("logistics.商品属性"),required:""}},[e("el-checkbox-group",{model:{value:t.data.form.productType,callback:function(e){t.$set(t.data.form,"productType",e)},expression:"data.form.productType"}},t._l(t.productTypeArr,(function(s,i){return e("el-checkbox",{key:i,attrs:{label:s.val,name:"type",value:s.val}},[t._v(t._s(t.$t(s.text)))])})),1)],1),e("el-form-item",{attrs:{label:t.$t("logistics.运费方案"),required:""}},[e("div",[e("el-select",{attrs:{placeholder:t.$t("logistics.请选择")},model:{value:t.data.form.calType,callback:function(e){t.$set(t.data.form,"calType",e)},expression:"data.form.calType"}},t._l(t.logicList,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"t-box-int"},[e("span",{staticClass:"text"},[t._v(t._s(t.$t("logistics.添加运费方案"))+":")]),"1"==t.data.form.calType?e("span",{staticClass:"textM"},[t._v(t._s(t.$t("logistics.ourmall运费计算逻辑")))]):"2"==t.data.form.calType?e("span",{staticClass:"textM"},[t._v(t._s(t.$t("logistics.云途运费计算逻辑")))]):e("span",{staticClass:"textM"},[t._v(t._s(t.$t("logistics.最终运费")))])])]),e("el-form-item",{attrs:{label:t.$t("logistics.运费设置")}},[e("div",{staticStyle:{position:"absolute",top:"-40px",left:"80px"}},[e("el-link",{staticClass:"mg-r-15",attrs:{type:"primary",underline:!1},on:{click:function(e){return t.addSetting()}}},[t._v(t._s(t.$t("logistics.添加一组运费设置")))])],1),t.settingArr&&t.settingArr.length?t._l(t.settingArr,(function(s,i){return e("div",{key:i},[e("el-row",{staticClass:"mg-t-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.重量范围："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{on:{change:function(e){return t.numberChange("rangeBegin",i,s.rangeBegin)}},model:{value:s.rangeBegin,callback:function(e){t.$set(s,"rangeBegin",e)},expression:"setting.rangeBegin"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.起始")))]),e("template",{slot:"append"},[t._v("g")])],2)],1),e("el-col",{attrs:{span:8,offset:1}},[e("el-input",{attrs:{disabled:s.noHeavy&&s.noHeavy.length>0},on:{change:function(e){return t.numberChange("rangeEnd",i,s.rangeEnd)}},model:{value:s.rangeEnd,callback:function(e){t.$set(s,"rangeEnd",e)},expression:"setting.rangeEnd"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.截止")))]),e("template",{slot:"append"},[t._v("g")])],2)],1),t.settingArr.length>1?[e("el-col",{attrs:{span:2,offset:1}},[e("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.deleteSetting(i)}}},[t._v(t._s(t.$t("logistics.删除")))])],1)]:t._e(),i==t.settingArr.length-1?[e("el-col",{attrs:{span:2,offset:t.settingArr.length>1?0:1}},[e("el-checkbox-group",{model:{value:s.noHeavy,callback:function(e){t.$set(s,"noHeavy",e)},expression:"setting.noHeavy"}},[e("el-checkbox",{attrs:{label:"1",value:"1"}},[t._v(t._s(t.$t("logistics.不限重")))])],1)],1)]:t._e()],2),e("el-row",{staticClass:"mg-t-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.首重设置："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{model:{value:s.firstWeight,callback:function(e){t.$set(s,"firstWeight",e)},expression:"setting.firstWeight"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.首重")))]),e("template",{slot:"append"},[t._v("g")])],2)],1),e("el-col",{attrs:{span:8,offset:1}},[e("el-input",{on:{input:function(e){s.firstPrice=t.oninput(s.firstPrice)}},model:{value:s.firstPrice,callback:function(e){t.$set(s,"firstPrice",e)},expression:"setting.firstPrice"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.首重价格")))]),e("template",{slot:"append"},[t._v(t._s(t.$store.state.country.symbol))])],2)],1)],1),e("el-row",{staticClass:"mg-t-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.续重设置："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{model:{value:s.nextWeight,callback:function(e){t.$set(s,"nextWeight",e)},expression:"setting.nextWeight"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.续重")))]),e("template",{slot:"append"},[t._v("g")])],2)],1),e("el-col",{attrs:{span:8,offset:1}},[e("el-input",{on:{input:function(e){s.nextPrice=t.oninput(s.nextPrice)}},model:{value:s.nextPrice,callback:function(e){t.$set(s,"nextPrice",e)},expression:"setting.nextPrice"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.续重价格")))]),e("template",{slot:"append"},[t._v(t._s(t.$store.state.country.symbol))])],2)],1)],1),e("el-row",{staticClass:"mg-t-15 mg-b-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.挂号费："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:t.$t("logistics.挂号费")},model:{value:s.registrationFee,callback:function(e){t.$set(s,"registrationFee",e)},expression:"setting.registrationFee"}},[e("template",{slot:"append"},[t._v(t._s(t.$store.state.country.symbol))])],2)],1)],1),"2"!=t.data.form.calType?e("el-row",{staticClass:"mg-t-15 mg-b-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.燃油附加费率"))+"： ")]),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:t.$t("logistics.燃油附加费率")},model:{value:s.fuelSurchargeRate,callback:function(e){t.$set(s,"fuelSurchargeRate",e)},expression:"setting.fuelSurchargeRate"}})],1)],1):t._e(),e("el-row",{staticClass:"mg-t-15 mg-b-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.系数"))+": ")]),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:t.$t("logistics.系数")},model:{value:s.numCoefficient,callback:function(e){t.$set(s,"numCoefficient",e)},expression:"setting.numCoefficient"}})],1),e("el-col",{staticStyle:{"text-align":"center"},attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.汇率"))+": ")]),e("el-col",{attrs:{span:4}},[e("el-input",{attrs:{placeholder:t.$t("logistics.汇率")},model:{value:s.exchangeRate,callback:function(e){t.$set(s,"exchangeRate",e)},expression:"setting.exchangeRate"}})],1)],1),e("el-row",{staticClass:"mg-t-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.包裹侧面积范围："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{on:{change:function(e){return t.numberChangeT("lateralAreaBegin",i,s.lateralAreaBegin)}},model:{value:s.lateralAreaBegin,callback:function(e){t.$set(s,"lateralAreaBegin",e)},expression:"setting.lateralAreaBegin"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.起始")))]),e("template",{slot:"append"},[t._v("m²")])],2)],1),e("el-col",{attrs:{span:8,offset:1}},[e("el-input",{on:{change:function(e){return t.numberChangeT("lateralAreaEnd",i,s.lateralAreaEnd)}},model:{value:s.lateralAreaEnd,callback:function(e){t.$set(s,"lateralAreaEnd",e)},expression:"setting.lateralAreaEnd"}},[e("template",{slot:"prepend"},[t._v(t._s(t.$t("logistics.截止")))]),e("template",{slot:"append"},[t._v("m²")])],2)],1),t.settingArr.length>1?[e("el-col",{attrs:{span:2,offset:1}},[e("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(e){return t.deleteSetting(i)}}},[t._v(t._s(t.$t("logistics.删除")))])],1)]:t._e()],2),e("el-row",{staticClass:"mg-t-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.包裹尺寸范围："))+" ")]),e("el-col",{attrs:{span:6}},[e("el-input",{model:{value:s.length,callback:function(e){t.$set(s,"length",e)},expression:"setting.length"}},[e("template",{slot:"prepend"},[t._v(">"+t._s(t.$t("logistics.长")))]),e("template",{slot:"append"},[t._v("cm")])],2)],1),e("el-col",{attrs:{span:6,offset:1}},[e("el-input",{model:{value:s.width,callback:function(e){t.$set(s,"width",e)},expression:"setting.width"}},[e("template",{slot:"prepend"},[t._v(">"+t._s(t.$t("logistics.宽")))]),e("template",{slot:"append"},[t._v("cm")])],2)],1),e("el-col",{attrs:{span:6,offset:1}},[e("el-input",{model:{value:s.height,callback:function(e){t.$set(s,"height",e)},expression:"setting.height"}},[e("template",{slot:"prepend"},[t._v(">"+t._s(t.$t("logistics.高")))]),e("template",{slot:"append"},[t._v("cm")])],2)],1)],1),"2"==t.data.form.calType||"1"==t.data.form.calType?e("el-row",{staticClass:"mg-t-15 mg-b-15"},[e("el-col",{attrs:{span:2}},[t._v(" "+t._s(t.$t("logistics.利润："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:"0.00"},model:{value:s.profit,callback:function(e){t.$set(s,"profit",e)},expression:"setting.profit"}},[e("template",{slot:"append"},[t._v(t._s(t.$store.state.country.symbol))])],2)],1)],1):t._e(),e("el-divider")],1)})):t._e()],2),e("el-form-item",{attrs:{label:t.$t("logistics.其他运费设置")}},[e("el-row",{staticClass:"mg-t-15 mg-b-15"},[e("el-col",{attrs:{span:2}},[e("span",{staticStyle:{color:"#F56C6C"}},[t._v("*")]),t._v(" "+t._s(t.$t("logistics.时效天数："))+" ")]),e("el-col",{attrs:{span:4}},[e("el-input",{model:{value:t.freightObj.agingDaysBegin,callback:function(e){t.$set(t.freightObj,"agingDaysBegin",e)},expression:"freightObj.agingDaysBegin"}},[e("template",{slot:"append"},[t._v("-")])],2)],1),e("el-col",{attrs:{span:4}},[e("el-input",{model:{value:t.freightObj.agingDaysEnd,callback:function(e){t.$set(t.freightObj,"agingDaysEnd",e)},expression:"freightObj.agingDaysEnd"}},[e("template",{slot:"append"},[t._v(t._s(t.$t("logistics.天")))])],2)],1),e("el-col",{attrs:{span:2,offset:1}},[t._v(" "+t._s(t.$t("logistics.附加费："))+" ")]),e("el-col",{attrs:{span:8}},[e("el-input",{attrs:{placeholder:t.$t("logistics.附加费")},model:{value:t.freightObj.operatingFee,callback:function(e){t.$set(t.freightObj,"operatingFee",e)},expression:"freightObj.operatingFee"}},[e("template",{slot:"append"},[t._v(t._s(t.$store.state.country.symbol))])],2)],1)],1)],1)],1)],1),e("div",{staticClass:"drawer-footer"},[e("el-button",{on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("logistics.取消")))]),e("el-button",{attrs:{type:"primary",loading:t.data.loading},on:{click:t.setShipping}},[t._v(t._s(t.$t("logistics.保存")))])],1)],1)},u=[],f={props:["data"],data(){return{productTypeArr:this.$dict.productType,freightObj:{registrationFee:"",operatingFee:"",agingDaysBegin:"",agingDaysEnd:""},logicType:"1",logicList:[{value:"1",label:this.$t("logistics.ourmall计算模板")},{value:"2",label:this.$t("logistics.云途计算模板")},{value:"3",label:this.$t("logistics.按数量常规计费")}],settingArr:[{rangeBegin:"",rangeEnd:"",lateralAreaBegin:"",lateralAreaEnd:"",width:"",height:"",length:"",firstWeight:"",firstPrice:"",nextWeight:"",nextPrice:"",registrationFee:"",profit:"",numCoefficient:"",exchangeRate:"",fuelSurchargeRate:"",noHeavy:[]}]}},methods:{open(){this.data.isEdit?(console.log(this.data.form.priceArr," this.data.form.priceArr"),this.settingArr=this.data.form.priceArr,this.freightObj.operatingFee=this.data.form.item.operatingFee,this.freightObj.agingDaysBegin=this.data.form.item.agingDaysBegin,this.freightObj.agingDaysEnd=this.data.form.item.agingDaysEnd,this.settingArr.length&&this.settingArr.forEach(t=>{t.noHeavy&&t.noHeavy.length||this.$set(t,"noHeavy",[])})):(this.settingArr=[{rangeBegin:"",rangeEnd:"",firstWeight:"",firstPrice:"",nextWeight:"",width:"",height:"",length:"",lateralAreaBegin:"",lateralAreaEnd:"",nextPrice:"",registrationFee:"",profit:"",numCoefficient:"",exchangeRate:"",noHeavy:[]}],this.freightObj.operatingFee="",this.freightObj.agingDaysBegin="",this.freightObj.agingDaysEnd="")},deleteSetting(t){this.settingArr.splice(t,1)},addSetting(){this.settingArr.push({rangeBegin:"",rangeEnd:"",firstWeight:"",firstPrice:"",nextWeight:"",width:"",height:"",length:"",lateralAreaBegin:"",lateralAreaEnd:"",nextPrice:"",numCoefficient:"",exchangeRate:"",noHeavy:[]})},numberChange(t,e,s){let i=this.settingArr[e];if("rangeBegin"==t){if(this.settingArr.length>1&&e>0){let t=this.settingArr[e-1];t&&t.rangeEnd&&i.rangeBegin!=t.rangeEnd&&(this.$elementMessage(this.$t("logistics.相邻的阶梯重量，当前组的起始重量必须等于前一组的截止重量"),"error"),this.$set(i,"rangeBegin",t.rangeEnd))}}else{if(i.noHeavy&&i.noHeavy.length)return void(i.rangeEnd="");i.rangeEnd=Number(s),this.$nextTick(()=>{i.rangeBegin>0&&i.rangeEnd<i.rangeBegin&&(this.$elementMessage(this.$t("logistics.截止重量需要大于等于起始重量"),"error"),this.$set(i,"rangeEnd",i.rangeBegin))})}},numberChangeT(t,e,s){let i=this.settingArr[e];if("lateralAreaBegin"==t){if(this.settingArr.length>1&&e>0){let t=this.settingArr[e-1];t&&t.lateralAreaEnd&&i.lateralAreaBegin!=t.lateralAreaEnd&&(this.$elementMessage(this.$t("logistics.相邻的阶梯重量，当前组的起始重量必须等于前一组的截止重量"),"error"),this.$set(i,"lateralAreaBegin",t.lateralAreaEnd))}}else i.lateralAreaEnd=Number(s),this.$nextTick(()=>{i.lateralAreaBegin>0&&i.lateralAreaEnd<i.lateralAreaBegin&&(this.$elementMessage(this.$t("logistics.截止重量需要大于等于起始重量"),"error"),this.$set(i,"lateralAreaEnd",i.lateralAreaBegin))})},oninput(t){var e=t,s=e.substr(0,1),i=e.substr(1,1);if(e.length>1&&0==s&&"."!=i&&(e=e.substr(1,1)),"."==s&&(e=""),-1!=e.indexOf(".")){var a=e.substr(e.indexOf(".")+1);-1!=a.indexOf(".")&&(e=e.substr(0,e.indexOf(".")+a.indexOf(".")+1))}return e=e.replace(/[^\d^\.]+/g,"").replace(/^\D*([0-9]\d*\.?\d{0,4})?.*$/,"$1"),e},setShipping(){if(!this.data.form.name)return void this.$elementMessage(this.$t("logistics.名称必须输入"),"error");if(this.data.form.remark&&this.data.form.remark.length>200)return void this.$elementMessage(this.$t("logistics.方案说明长度不能超过200"),"error");if(!this.data.form.productType||!this.data.form.productType.length)return void this.$elementMessage(this.$t("logistics.请选择商品属性"),"error");if(!this.freightObj.agingDaysBegin||!this.freightObj.agingDaysEnd)return void this.$elementMessage(this.$t("logistics.时效天数必须填写"),"error");this.settingArr.forEach(t=>{t.noHeavy&&t.noHeavy.length&&this.$set(t,"rangeEnd","")});let t={id:this.data.form.id,name:this.data.form.name,nameDisplay:this.data.form.nameDisplay,remark:this.data.form.remark,productType:this.data.form.productType,type:this.data.form.type,calType:this.data.form.calType,tId:this.data.form.tId,min:0,max:0,priceArr:this.settingArr,operatingFee:this.freightObj.operatingFee,agingDaysBegin:this.freightObj.agingDaysBegin,agingDaysEnd:this.freightObj.agingDaysEnd};this.$emit("setShipping",t)},beforeClose(t){this.$confirm(this.$t("logistics.确认关闭？  将不会保存改变。")).then(e=>{t()}).catch(t=>{})}}},m=f,v=(s("cab9"),s("509f"),Object(p["a"])(m,h,u,!1,null,"3ba1166a",null)),y=v.exports,b=s("b879"),_=s("3d50"),C=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.data.isShow,title:t.$t("goods.导入商品"),width:"500px"},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[e("el-divider"),e("div",{staticClass:"d-body"},[t.data.filePath?e("div",{staticClass:"path"},[e("p",{staticClass:"mg-b-20 tx-ellipsis3"},[t._v(t._s(t.data.filePath))]),e("div",{staticClass:"tx-center"},[e("el-link",{attrs:{type:"danger"},on:{click:t.clearFile}},[e("i",{staticClass:"el-icon-delete"})])],1)]):e("a",{staticClass:"i-btn",attrs:{href:"javascript:;"},on:{click:t.openUpload}},[e("i",{staticClass:"el-icon-upload"}),e("p",[t._v(t._s(t.$t("goods.选择文件")))])]),e("div",{staticClass:"right"},[e("p",{staticClass:"t1"},[e("span",[t._v(t._s(t.$t("goods.点击下载")))]),t._v(" "),e("el-link",{attrs:{type:"primary",target:"_blank"},on:{click:function(e){return t.downLoadExcel()}}},[t._v(t._s(t.$t("goods.运费导入模板")))])],1),e("p",{staticClass:"t2"},[t._v(" "+t._s(t.$t("goods.请按规范填写表格，仅支持xlsx格式文件"))+" ")])])]),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"uploadXls",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},on:{change:function(e){return t.fileUpload(e)}}}),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("goods.取消")))]),e("el-button",{attrs:{type:"primary",loading:t.data.loading,disabled:!t.data.file},on:{click:t.apiUpload}},[t._v(t._s(t.$t("goods.提交")))])],1)],1)},w=[],D=(s("c73d"),s("88a7f"),s("271a"),s("5494"),{props:["data"],methods:{clearFile(){this.data.file=null,this.data.filePath="",document.getElementById("uploadXls").value=""},fileUpload(t){this.data.file=t.target.files[0],this.data.filePath=t.target.value,t.target.value=""},downLoadExcel(){let t="/file/importFreight.xlsx",e=document.createElement("a");e.href=t,e.download="good.xlsx",e.style.display="none",document.body.appendChild(e),setTimeout(()=>{e.click(),document.removeChild(e),setTimeout(()=>{self.URL.revokeObjectURL(e.href)},200)},66)},apiUpload(){this.data.file.size>2097152?this.$message({message:this.$t("goods.文件不能大于10MB"),type:"error"}):this.data.file?(this.$set(this.data,"loading",!0),0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>'),this.$apiCall("api.AreaShipping.importAreaShippingDetailExcel",{"@file":this.data.file,id:this.data.params.id||"",name:this.data.params.name,countrys:this.data.params.countrys},t=>{this.$set(this.data,"loading",!1),9999==t.ErrorCode?t.Data.Results.file?(this.$emit("uploadSuccess","error"),document.getElementById("ifilePro").src=t.Data.Results.file):this.$emit("uploadSuccess"):this.$message({message:t.Message,type:"error"})})):this.$message({message:this.$t("goods.请上传文件"),type:"error"})},openUpload(){document.getElementById("uploadXls").click()}}}),S=D,k=(s("9751"),Object(p["a"])(S,C,w,!1,null,"666b32d7",null)),x=k.exports,A={data(){return{isSave:!1,loading:!1,code2Arr:[],tabArea:"1",id:"",name:"",countrys:[],shippings:[],countryArr:[],DrawerSelectCountryData:{isShow:!1,loading:!1,filterText:"",showTree:!1,openedArr:[]},DrawerShippingsData:{isShow:!1,loading:!1,form:{id:"",name:"",nameDisplay:"",remark:"",productType:[],type:"1",min:void 0,max:void 0,firstWeight:void 0,firstPrice:void 0,nextWeight:void 0,nextPrice:void 0,radio:void 0,priceType:"1",tId:"",calType:"1",minWeight:void 0,priceArr:[{smallerWeight:void 0,greaterWeight:void 0,perPrice:void 0,registrationFee:void 0,surcharge:void 0}]},kg:2,kg2:2},defaultDrawerShippingData:"{}",dialogImportData:{loding:!1,isShow:!1,file:null,filePath:"",params:{}},defaultDialogImportData:"{}"}},components:{DrawerSelectCountry:d,DrawerShipping:y,TableFreight:b["a"],TableWeight:_["a"],DialogImport:x},beforeRouteLeave(t,e,s){if(this.isSave)s();else{let t=confirm(this.$t("logistics.当前页面还未保存，确定要离开吗?"));t?s():s(!1)}},mounted(){this.defaultDrawerShippingData=JSON.stringify(this.DrawerShippingsData),this.defaultDialogImportData=JSON.stringify(this.dialogImportData),Object.keys(r).forEach((t,e)=>{let s=[];Object.keys(r[t]).forEach(e=>{s.push({label:r[t][e].nameCN+" "+r[t][e].nameEN,value:r[t][e].code2,labelCN:r[t][e].nameCN,labelEN:r[t][e].nameEN,disabled:!1}),this.code2Arr.push(r[t][e].code2)}),this.countryArr.push({id:e+"",label:t,children:s.map(t=>t)})}),this.$route.query.id?(this.id=this.$route.query.id,this.getDetail()):this.getDisabledCountry()},methods:{uploadSuccess(t){setTimeout(()=>{this.dialogImportData.isShow=!1,"error"==t?this.$message({message:t?this.$t("goods.导入失败，下载查看错误文件"):this.$t("goods.导入成功"),type:t?"error":"success"}):(this.isSave=!0,this.$nextTick(()=>{this.$router.push({name:"logistics"})}))},1e3)},openImportShipping(){this.dialogImportData=JSON.parse(this.defaultDialogImportData);let t=this.countrys.map(t=>t.value),e={id:this.id||"",name:this.name,countrys:t};this.dialogImportData.params=e,this.dialogImportData.isShow=!0},getDisabledCountry(){this.loading=!0,this.$apiCall("api.AreaShipping.checkCountry",{id:this.id,country:this.code2Arr},t=>{if(this.loading=!1,"9999"==t.ErrorCode){let e=t.Data.Results.map(t=>t.country);e=[...new Set(e)],this.countryArr.forEach(t=>{t.children.forEach(t=>{t.disabled=e.indexOf(t.value)>-1})})}})},delAreaShipping(){this.$confirm(this.$t("logistics.是否确定删除该区域方案？"),{type:"warning",confirmButtonText:this.$t("logistics.删除"),cancelButtonText:this.$t("logistics.取消"),confirmButtonClass:"el-button--danger"}).then(()=>{this.loading=!0,this.$apiCall("api.AreaShipping.delete",{id:this.id},t=>{this.loading=!1,"9999"==t.ErrorCode?(this.isSave=!0,this.goto("logistics")):this.$elementMessage(t.Message,"error")})}).catch(()=>{})},getDetail(){this.loading=!0,this.$apiCall("api.AreaShipping.findByVendor",{id:this.id},t=>{if(this.loading=!1,"9999"==t.ErrorCode){let e=t.Data.Results[0];this.id=e.id,this.countrys=[],e.countrys.forEach(t=>{this.countryArr.forEach(e=>{e.children.forEach(e=>{e.value==t&&this.countrys.push({label:e.label,value:e.value})})})}),this.name=e.name,this.shippings=e.shippings.map(t=>(t.tId=t.id,t)),this.getDisabledCountry()}else this.$elementMessage(t.Message,"error")})},save(){if(!this.name)return void this.$elementMessage(this.$t("logistics.方案名必须输入"),"error");if(!this.countrys.length)return void this.$elementMessage(this.$t("logistics.必须选择一个配送区域"),"error");if(!this.shippings.length)return void this.$elementMessage(this.$t("logistics.必须创建一个运费方案"),"error");let t=this.countrys.map(t=>t.value),e={id:this.id||"",name:this.name,countrys:t,shippings:this.shippings};this.loading=!0,this.$apiCall("api.AreaShipping.saveByVendor",e,t=>{this.loading=!1,"9999"==t.ErrorCode?(this.isSave=!0,this.$nextTick(()=>{this.$router.push({name:"logistics"})})):this.$elementMessage(t.Message,"error")})},setShipping(t){if(t.tId){for(let e=0;e<this.shippings.length;e++)if(this.shippings[e].tId==t.tId){this.shippings.splice(e,1,t);break}}else t.tId=(new Date).getTime(),this.shippings.unshift(t);this.DrawerShippingsData.isShow=!1},openDrawerShipping(){this.DrawerShippingsData=JSON.parse(this.defaultDrawerShippingData),this.DrawerShippingsData.isShow=!0},setCountry(t){this.DrawerSelectCountryData.isShow=!1,this.countrys=t.map(t=>t)},openDrawerSelectCountry(){this.DrawerSelectCountryData.isShow=!0,this.DrawerSelectCountryData.openedArr=this.countrys.map(t=>t.value)},changeAreaCollapse(){this.tabArea=this.tabArea?"":"1"},removeArea(t){this.$confirm(this.$t("logistics.确认要删除吗？"),{confirmButtonClass:"el-button--danger",type:"warning"}).then(()=>{this.countrys.splice(t,1)}).catch(()=>{})},removeShipping(t){this.$confirm(this.$t("logistics.确认要删除吗？"),{confirmButtonClass:"el-button--danger",type:"warning"}).then(()=>{this.shippings.splice(t,1)}).catch(()=>{})},editShipping(t){this.DrawerShippingsData=JSON.parse(this.defaultDrawerShippingData),this.DrawerShippingsData.form.id=t.id,this.DrawerShippingsData.form.name=t.name,this.DrawerShippingsData.form.calType=t.calType?t.calType:"1",this.DrawerShippingsData.form.nameDisplay=t.nameDisplay,this.DrawerShippingsData.form.remark=t.remark,this.DrawerShippingsData.form.productType=[...t.productType],this.DrawerShippingsData.form.tId=t.tId,this.DrawerShippingsData.form.priceArr=[...t.priceArr],this.DrawerShippingsData.form.item=t,this.DrawerShippingsData.isEdit=!0,this.DrawerShippingsData.isShow=!0},goto(t){this.$router.push({name:t})}}},E=A,T=(s("d055"),s("dc1d"),Object(p["a"])(E,i,a,!1,null,"2986e58e",null));e["default"]=T.exports},dc1d:function(t,e,s){"use strict";s("8a57")},f5df:function(t,e,s){"use strict";var i=s("00ee"),a=s("1626"),r=s("c6b6"),l=s("b622"),n=l("toStringTag"),o=Object,c="Arguments"===r(function(){return arguments}()),p=function(t,e){try{return t[e]}catch(s){}};t.exports=i?r:function(t){var e,s,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(s=p(e=o(t),n))?s:c?r(e):"Object"===(i=r(e))&&a(e.callee)?"Arguments":i}}}]);