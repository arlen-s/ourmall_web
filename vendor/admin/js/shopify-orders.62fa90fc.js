(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shopify-orders"],{1646:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",[e("el-dialog",{attrs:{visible:t.data.isShow,title:t.$t("app.通知"),width:"700px"},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[e("el-divider"),e("div",{staticClass:"body-wrap"},[e("p",{staticClass:"mg-b-10"},[t._v(t._s(t.$t("app.该站长可处理的单量不足，请联系站长购买单量包。")))]),e("p",{staticClass:"mg-b-15"},[t._v("( "+t._s(t.$t("app.请将该提醒转发您的站长客户："))+" "),e("span",{staticStyle:{color:"#909399"}},[t._v(t._s(t.$t("app.Youdon")))]),t._v(" ) ")]),e("p",{staticClass:"mg-b-10 d-flex"},[t._v(t._s(t.$t("app.您若有疑问，"))),e("el-link",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.tawk()}}},[t._v(t._s(t.$t("app.可点此联系客服")))])],1)]),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("app.关闭")))])],1)],1)],1)},a=[],r={props:["data"],methods:{tawk(){}}},o=r,l=(i("d603"),i("2877")),n=Object(l["a"])(o,s,a,!1,null,"36deeecd",null);e["a"]=n.exports},"6e31":function(t,e,i){},"812b":function(t,e,i){"use strict";i("6e31")},"8eb6":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"contentpanel orders-page",attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)"}},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-shopify"}),e("h2",[t._v(t._s(1==t.isManage?t.$t("shopifyOrders.allShopifyOrders"):t.$t("shopifyOrders.allHiddenShopifyOrders"))+" "),t.activeStore?e("em",{staticStyle:{"font-size":"22px"}},[t._v("("+t._s(this.totalCount)+")")]):t._e()])])]),e("div",{staticClass:"right"},[t.tableData.length?e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.exportDialogOpen}},[e("i",{staticClass:"fa fa-download"}),t._v(t._s(t.$t("shopifyOrders.export"))+" ")]):t._e()],1)]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.selectLoading,expression:"selectLoading"}],staticClass:"pagebody"},[e("div",{staticClass:"design-tab-content"},[t.storeId?e("div",{ref:"pageFilter"},[e("div",{staticClass:"d-flex"},[e("el-popover",{ref:"selectRangePopover",attrs:{placement:"bottom",trigger:"click","popper-class":"d-block"}},[e("div",[e("el-form",{ref:"formRange",attrs:{"label-width":"80px"}},[e("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:t.$t("shopifyOrders.numberFrom")}},[e("el-input",{attrs:{size:"mini"},model:{value:t.orderMin,callback:function(e){t.orderMin=e},expression:"orderMin"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"5px"},attrs:{label:t.$t("shopifyOrders.numberTo")}},[e("el-input",{attrs:{size:"mini"},model:{value:t.orderMax,callback:function(e){t.orderMax=e},expression:"orderMax"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"0"}},[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.filterItems("range")}}},[t._v(t._s(t.$t("shopifyOrders.select")))]),e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.clearFilterItems("range")}}},[t._v(t._s(t.$t("shopifyOrders.close2")))])],1)],1)],1),e("el-button",{staticClass:"mg-r-10",attrs:{slot:"reference",size:"small"},on:{click:t.clearRange},slot:"reference"},[t._v(t._s(t.$t("shopifyOrders.orderNumberRange"))),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("div",{staticClass:"mg-l-10 mg-r-10"},[e("el-input",{attrs:{size:"small","prefix-icon":"el-icon-search",placeholder:t.$t("shopifyOrders.filterOrders"),clearable:""},on:{input:t.getCodeName,clear:t.clearFilterItems},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getCodeName.apply(null,arguments)}},model:{value:t.codeName,callback:function(e){t.codeName=e},expression:"codeName"}})],1),e("el-button-group",{staticStyle:{"min-width":"300px"}},[e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-radio-group",{on:{change:function(e){return t.filterItems("date")}},model:{value:t.timeFilter,callback:function(e){t.timeFilter=e},expression:"timeFilter"}},t._l(t.dateArr,(function(i,s){return e("el-radio",{key:s,attrs:{label:s}},[t._v(t._s(t.$t(i)))])})),1),6==t.timeFilter?e("div",[e("el-date-picker",{attrs:{size:"mini","value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"-","start-placeholder":"Start","end-placeholder":"End"},on:{change:t.dateChange},model:{value:t.filterDate,callback:function(e){t.filterDate=e},expression:"filterDate"}})],1):t._e(),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.timeFilter},on:{click:function(e){return t.clearFilterItems("date")}}},[t._v(t._s(t.$t("shopifyOrders.clear")))])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("shopifyOrders.dateRanges"))),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-checkbox-group",{on:{change:function(e){return t.filterItems("fulfill")}},model:{value:t.fulfillStatus,callback:function(e){t.fulfillStatus=e},expression:"fulfillStatus"}},[e("el-checkbox",{attrs:{label:"1"}},[t._v(t._s(t.$t("shopifyOrders.unfulfilled")))]),e("el-checkbox",{attrs:{label:"2"}},[t._v(t._s(t.$t("shopifyOrders.partiallyFulfilled")))])],1),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.fulfillStatus.length},on:{click:function(e){return t.clearFilterItems("fulfill")}}},[t._v(t._s(t.$t("shopifyOrders.clear")))])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("shopifyOrders.fulfillmentStatus"))),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1),e("el-popover",{attrs:{placement:"bottom",title:"",trigger:"click","popper-class":"d-block"}},[e("el-radio-group",{on:{change:function(e){return t.filterItems("sort")}},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},t._l(t.sortArr,(function(i,s){return e("el-radio",{key:s,attrs:{label:s}},[t._v(t._s(t.$t(i)))])})),1),e("div",[e("el-button",{attrs:{type:"text",disabled:!t.sortBy},on:{click:function(e){return t.clearFilterItems("sort")}}},[t._v(t._s(t.$t("shopifyOrders.clear")))])],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(t._s(t.$t("shopifyOrders.sortBy"))),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])],1)],1),e("div",{staticStyle:{"margin-left":"auto","margin-right":"15px"}},[1==t.isManage?e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.filterItems2(2)}}},[t._v(t._s(t.$t("shopifyOrders.showHiddenOrders")))]):t._e()],1)],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"sortWrap",staticClass:"mg-t-20"},[t.activeStore?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info"}},[t._v(" "+t._s(t.activeStore.customerName)+" - "+t._s(t.activeStore.store)+" "),e("a",{staticClass:"mg-l-5",attrs:{href:"javascript:;"},on:{click:function(e){return t.removeStore()}}},[e("i",{staticClass:"el-icon-error"})])]):t._e(),t.filterParams.codeNameGeq||t.filterParams.codeNameLeq?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info"}},[t._v(" "+t._s(`${t.filterParams.codeNameGeq} - ${t.filterParams.codeNameLeq}`)+" "),e("a",{staticClass:"mg-l-5",attrs:{href:"javascript:;"},on:{click:function(e){return t.clearFilterItems("range")}}},[e("i",{staticClass:"el-icon-error"})])]):t._e(),t.timeFilter?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("date")}}},[t._v(" "+t._s(t.$t(t.dateArr[t.timeFilter]))+" "),6==t.timeFilter&&t.filterDate.length?e("span",[t._v(" "+t._s(t.filterDate[0])+"--"+t._s(t.filterDate[1])+" ")]):t._e()]):t._e(),t.fulfillStatus.length?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("fulfill")}}},[t._v(" "+t._s(1==t.fulfillStatus[0]?t.$t("shopifyOrders.unfulfilled"):t.$t("shopifyOrders.partiallyFulfilled"))),t.fulfillStatus.length>1?e("span",[t._v(","+t._s(1==t.fulfillStatus[1]?t.$t("shopifyOrders.unfulfilled"):t.$t("shopifyOrders.partiallyFulfilled")))]):t._e()]):t._e(),t.sortBy?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilterItems("sort")}}},[t._v(t._s(t.$t(t.sortArr[t.sortBy])))]):t._e(),t.warningDialog.page?e("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.removeStore()}}},[t._v("限制"+t._s(this.warningDialog.orders)+"条")]):t._e()],1)]):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:t.storeId,expression:"storeId"}],staticClass:"invoice-list mg-t-20"},[e("ul",{staticClass:"invoice-header"},[e("li",{staticClass:"invoice-item",staticStyle:{width:"63px","max-width":"63px","padding-left":"24px","border-left":"0",position:"relative"}},[t.checkLoading?e("i",{staticClass:"el-icon-loading",staticStyle:{position:"absolute",left:"5px",top:"8px"}}):t._e(),e("el-checkbox",{on:{change:t.checkedAll},model:{value:t.isAll1,callback:function(e){t.isAll1=e},expression:"isAll1"}})],1),e("li",{staticClass:"invoice-item"},[e("a",{attrs:{href:"javascript:;"},on:{click:t.expandChange}},[e("i",{class:t.expandAll?"el-icon-minus":"el-icon-plus"})]),t._v(" "+t._s(t.$t("shopifyOrders.orderID"))+" ")]),e("li",{staticClass:"invoice-item"},[t._v(t._s(t.$t("shopifyOrders.shopifyStores")))]),e("li",{staticClass:"invoice-item"},[t._v(t._s(t.$t("shopifyOrders.date")))]),e("li",{ref:"customerH",staticClass:"invoice-item",style:{width:t.customerH?t.customerH+30+"px":"auto"}},[t._v(t._s(t.$t("shopifyOrders.customer")))]),e("li",{staticClass:"invoice-item tx-right pd-r-15"},[t._v(t._s(t.$t("shopifyOrders.shopifyOrderTotal")))]),e("li",{staticClass:"invoice-item"},[t._v(t._s(t.$t("shopifyOrders.fulfillment")))]),e("li",{staticClass:"invoice-item"},[t._v(t._s(t.$t("shopifyOrders.items")))])]),[t.tableData?e("div",{ref:"treeWrap",staticClass:"tree-wrap",staticStyle:{"overflow-y":"scroll"}},[e("el-tree",{ref:"treeData",attrs:{props:t.props,data:t.tableData,"show-checkbox":"","node-key":"id","default-expand-all":t.expandAll,"default-expanded-keys":t.expandedKeys,"default-checked-keys":t.defaultChecked,"filter-node-method":t.showTree},on:{"node-expand":t.handleExpandChange,"check-change":t.handleCheckChange,check:t.handleCheck},scopedSlots:t._u([{key:"default",fn:function({node:i,data:s}){return e("div",{staticClass:"custom-tree-node",class:{"d-hide":!s.isShow},attrs:{id:"customTreeNode"+s.id}},[s.span?e("div",{staticClass:"table_info_node table_info_top"},[e("div",{staticClass:"table_info_item d-flex"},[s.items&&s.items.length?e("span",{staticStyle:{"font-size":"12px",cursor:"pointer"}},[e("i",{staticClass:"el-icon-plus",staticStyle:{"font-weight":"700"}}),t._v(" "+t._s(s.codeName)+" ")]):e("span",[e("i",{staticClass:"el-icon-plus",staticStyle:{opacity:"0"}}),t._v(" "+t._s(s.codeName)+" ")]),s.note?e("span",{staticClass:"mg-l-5"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:s.note,placement:"top"}},[e("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px",width:"12px",color:"#5c6ac4"}})])],1):t._e()]),e("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[t._v(t._s(s.store))]),e("div",{staticClass:"table_info_item"},[t._v(" "+t._s(t.$moment(s.timeCreated).format("ll [at] LTS"))+" ")]),e("div",{staticClass:"table_info_item"},[e("el-popover",{attrs:{"popper-class":"customer-popover",placement:"bottom",width:"600",trigger:"hover"}},[e("span",{staticClass:"d-flex",staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[e("span",{staticClass:"tx-ellipsis1",style:{width:t.customerH?t.customerH+"px":"auto"}},[t._v(t._s(s.shippingJson&&s.shippingJson.name?s.shippingJson.name:""))]),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e("div",{staticClass:"mg-b-20 mg-t-10"},[e("div",{staticClass:"d-flex mg-b-20",staticStyle:{"justify-content":"space-between"}},[e("div",{staticClass:"title",staticStyle:{"font-weight":"bold","font-size":"16px"}},[t._v("Shopify Order "+t._s(s.codeName))]),e("div",[e("span",{staticStyle:{color:"#999"}},[t._v(t._s(t.$t("invoice.Orderdate")))]),e("span",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(s.timeCreated?s.timeCreated:"---"))])])]),e("div",{staticClass:"mg-y-10",staticStyle:{"font-weight":"bold","font-size":"16px"}},[t._v(t._s(t.$t("shopifyOrders.收件信息")))]),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.客户:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(s.shippingJson&&s.shippingJson.name?s.shippingJson.name:"---"))]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.name?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.name,expression:"data.shippingJson.name",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)]),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.收货地址1:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.address1?s.shippingJson.address1:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.address1?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.address1,expression:"data.shippingJson.address1",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)]),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.收货地址2:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{"max-width":"75%"}},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.address2?s.shippingJson.address2:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.address2?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.address2,expression:"data.shippingJson.address2",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)]),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex",staticStyle:{width:"50%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.城市:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.city?s.shippingJson.city:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.city?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.city,expression:"data.shippingJson.city",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1),e("div",{staticClass:"d-flex",staticStyle:{width:"50%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.省份:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.province?s.shippingJson.province:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.province?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.city,expression:"data.shippingJson.city",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)]),e("div",{staticClass:"d-flex",staticStyle:{"justify-content":"space-between"}},[e("div",{staticClass:"d-flex",staticStyle:{flex:"0 0 50%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.国家:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.country?s.shippingJson.country:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.country?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.country,expression:"data.shippingJson.country",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1),e("div",{staticClass:"d-flex",staticStyle:{flex:"0 0 50%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.邮编:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.zip?s.shippingJson.zip:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.zip?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.zip,expression:"data.shippingJson.zip",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)]),e("div",{staticClass:"mg-y-10",staticStyle:{"font-weight":"bold","font-size":"16px"}},[t._v(t._s(t.$t("shopifyOrders.收件信息")))]),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[e("div",{staticStyle:{width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.联系电话:"))+" ")]),e("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(s.shippingJson&&s.shippingJson.phone?s.shippingJson.phone:"---")+" ")]),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"copy",placement:"left"}},[s.shippingJson&&s.shippingJson.phone?e("el-button",{attrs:{size:"mini",type:"text"}},[e("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:s.shippingJson.phone,expression:"data.shippingJson.phone",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"el-icon-document-copy"})]):t._e()],1)],1)])])])],1),e("div",{staticClass:"table_info_item pd-r-15 d-flex",staticStyle:{"justify-content":"flex-end"}},[s.currency?e("span",[t._v(t._s(t.ce[s.currency]?t.ce[s.currency].symbol:s.currency)+" ")]):t._e(),t._v(" "+t._s(s.totalPrice)+" ")]),e("div",{staticClass:"table_info_item"},[s.fulfillmentStatus?"partial"==s.fulfillmentStatus?e("el-tag",{attrs:{size:"small",type:"partial"==s.fulfillmentStatus?"danger":""}},[e("span",{staticClass:"-EFlq"}),t._v(" "+t._s("partial"==s.fulfillmentStatus?t.$t("shopifyOrders.partiallyFulfilled"):t.$t("shopifyOrders.fulfilled"))+" ")]):t._e():e("el-tag",{attrs:{size:"small",type:"warning"}},[e("span",{staticClass:"-EFlq"}),t._v(" "+t._s(t.$t("shopifyOrders.unfulfilled"))+" ")])],1),e("div",{staticClass:"table_info_item"},[t._v(" "+t._s(s.items?s.items.length:"0")+" Items "),e("el-link",{staticClass:"mg-l-20",staticStyle:{display:"inline"},attrs:{underline:!1,type:"primary"},on:{click:function(e){return e.stopPropagation(),t.setOrderHide(s)}}},[t._v(t._s(1==t.isManage?t.$t("shopifyOrders.hide"):t.$t("shopifyOrders.show"))+" "+t._s(t.$t("shopifyOrders.thisOrder")))])],1)]):e("div",{staticClass:"table_info_node"},[e("div",{staticClass:"table_info_item",staticStyle:{flex:"2",overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("el-image",{staticStyle:{"min-width":"40px",width:"40px",height:"40px",margin:"5px 15px 5px 0",border:"1px solid #ddd"},attrs:{src:s.imgUrl,"preview-src-list":s.previewList}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"20px"}})])]),e("div",{staticClass:"table_info_item",staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"}},[e("p",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","word-break":"break-all","white-space":"nowrap"},style:s.disabled?"text-decoration:line-through;":""},[t._v(t._s(s.name))]),s.customerProperties&&s.customerProperties.length?t._l(s.customerProperties,(function(i){return e("p",{key:i.name},[e("span",{staticStyle:{color:"#909399"}},[t._v(t._s(i.name))]),t._v(" "+t._s(i.value)+" ")])})):t._e(),e("p",[e("span",{staticStyle:{color:"#999"}},[t._v("SKU: ")]),t._v(t._s(s.sku))])],2)],1)]),e("div",{staticClass:"table_info_item"},[e("p",{class:s.unfulfillQuantity>0&&s.unfulfillQuantity<s.quantity?"line":""},[t._v(" x "+t._s(s.quantity)+" ")]),s.unfulfillQuantity>0&&s.unfulfillQuantity<s.quantity?e("p",[e("span",[t._v(" x "+t._s(s.unfulfillQuantity)+" ")]),e("span",{staticStyle:{color:"#c05717","margin-left":"20px"}},[t._v("("+t._s(s.fulfillQuantity)+" of "+t._s(s.quantity)+" purchased items are delivered)")])]):t._e(),0==s.unfulfillQuantity?e("p",[e("span",[t._v("("+t._s(s.fulfillQuantity)+" of "+t._s(s.quantity)+" fulfilled)")])]):t._e()]),e("div",{staticClass:"table_info_item"},[e("p",[e("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.vendor"))+" ")]),t._v(" "+t._s(s.vendorName?s.vendorName:"---")+" ")]),e("p",[e("span",{staticStyle:{display:"inline-block",width:"100px","text-align":"right",color:"#999"}},[t._v(t._s(t.$t("shopifyOrders.costPerUnit"))+" ")]),t._v(" "+t._s(s.costPrice?"US$ "+s.costPrice:"---")+" ")])]),s.invoiceItems?e("div",{staticClass:"table_info_item"},[s.invoiceItems.length>0?[e("el-popover",{attrs:{"popper-class":"items-popover",placement:"bottom",title:`Selected by ${s.invoiceItems.length} purchase Orders`,width:"500",trigger:"hover"}},[e("span",{staticStyle:{"margin-right":"10px",cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v("# ("+t._s(s.invoiceItems.length)+")"),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._l(s.invoiceItems,(function(i){return e("div",{staticClass:"mg-y-15 mg-t-20"},[e("div",{staticClass:"d-flex mg-b-15"},[e("span",{staticClass:"mg-r-10"},[t._v("# "+t._s(i.code))]),e("span",{staticClass:"mg-r-10"},[t._v(t._s(i.vendorName))]),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.gotoInvoice(i)}}},[t._v(t._s(t.$t("shopifyOrders.viewTheDetails")))])],1)])}))],2)]:t._e()],2):t._e()])])}}],null,!1,306067783)}),e("el-row",{staticStyle:{margin:"20px 0 35px"},attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",[e("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSizes,"page-size":t.rowsPerPage,total:Number(t.totalCount)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1)],1):t._e()]],2),t.storeId?t._e():e("div",[e("el-card",{staticClass:"box-card"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("div",{ref:"pageFilter2",staticClass:"page-filter"},[e("el-form",{attrs:{inline:!0,size:"mini"}},[e("el-form-item",[e("el-select",{attrs:{filterable:"",remote:"","remote-method":t.remoteMethodCustom,loading:t.selectLoading,placeholder:t.$t("myinvoice.pleaseCusName"),clearable:""},on:{change:function(e){return t.filterGetItem("relationshipId")}},model:{value:t.filterParams.relationshipId,callback:function(e){t.$set(t.filterParams,"relationshipId",e)},expression:"filterParams.relationshipId"}},t._l(t.selectArr,(function(t){return e("el-option",{key:t.id,attrs:{label:t.customerName,value:t.id}})})),1)],1),e("el-form-item",[e("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Email/微信/Skype/Line/QQ/旺旺/WhatsApp"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem.apply(null,arguments)}},model:{value:t.filterParams.customerLike,callback:function(e){t.$set(t.filterParams,"customerLike",e)},expression:"filterParams.customerLike"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.filterGetItem}},[t._v(t._s(t.$t("shopifyOrders.筛选")))]),e("el-button",{attrs:{type:"danger"},on:{click:t.clearFilter}},[t._v(t._s(t.$t("shopifyOrders.清空")))])],1)],1)],1),e("div",{staticClass:"webmaster-list mg-t-10"},t._l(t.storeList,(function(i){return e("div",{key:i.relationship.id,staticClass:"webmaster-item"},[e("div",{staticClass:"item-header"},[e("div",{staticClass:"webmaster-icon"},[e("i",{staticClass:"el-icon-s-custom"})]),e("div",{staticClass:"webmaster-name"},[e("span",{staticClass:"name"},[t._v(t._s(i.relationship.customerName))]),i.relationship.customerRemark?e("span",{staticClass:"mg-l-5"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.relationship.customerRemark,placement:"top"}},[e("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px",width:"12px",color:"#5c6ac4"}})])],1):t._e()]),e("div",{staticClass:"webmaster-customerLike"},[i.relationship.customerEmail?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("a",{attrs:{href:"mailto:"+i.relationship.customerEmail,target:"_blank"}},[t._v(t._s(i.relationship.customerEmail))])]),e("i",{staticClass:"iconfont icon-email",staticStyle:{color:"#606266"}})])],1):t._e(),i.relationship.customerWeChat?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(i.relationship.customerWeChat)+" ")]),e("i",{staticClass:"iconfont icon-wechat",staticStyle:{color:"#55A947"}})])],1):t._e(),i.relationship.customerSkype?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("a",{attrs:{href:`skype:${i.relationship.customerSkype}?chat`,target:"_blank"}},[t._v(" "+t._s(i.relationship.customerSkype)+" ")])]),e("i",{staticClass:"iconfont icon-skype",staticStyle:{color:"#00B0F6"}})])],1):t._e(),i.relationship.customerLine?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(i.relationship.customerLine)+" ")]),e("i",{staticClass:"iconfont icon-line",staticStyle:{color:"#00C300"}})])],1):t._e(),i.relationship.customerQQ?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("a",{attrs:{href:`tencent://message/?uin=${i.relationship.customerQQ}&Site=5yoho&Menu=yes`}},[t._v(" "+t._s(i.relationship.customerQQ)+" ")])]),e("i",{staticClass:"iconfont icon-qq",staticStyle:{color:"#1E6FFF"}})])],1):t._e(),i.relationship.customerWangwang?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("a",{attrs:{href:`http://amos.alicdn.com/msg.aw?v=2&uid=${i.relationship.customerWangwang}&site=cnalichn&s=11&charset=UTF-8`,target:"_blank"}},[t._v(" "+t._s(i.relationship.customerWangwang)+" ")])]),e("i",{staticClass:"iconfont icon-wangwang",staticStyle:{color:"#009FFF"}})])],1):t._e(),i.relationship.customerWhatsapp?e("div",[e("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("a",{attrs:{href:"https://wa.me/"+i.relationship.customerWhatsapp,target:"_blank"}},[t._v(" "+t._s(i.relationship.customerWhatsapp)+" ")])]),e("i",{staticClass:"iconfont icon-whatsapp",staticStyle:{color:"#109D58"}})])],1):t._e()])]),e("div",{staticClass:"webmaster-body"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:i.shops,"header-cell-style":t.headerCellStyle}},[e("el-table-column",{attrs:{prop:"name",label:t.$t("shopifyOrders.店铺名称")}}),e("el-table-column",{attrs:{label:t.$t("shopifyOrders.店铺地址")},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("a",{attrs:{target:"_blank",href:`http://${i.subUrl}.myshopify.com`}},[t._v(t._s(i.subUrl)+".myshopify.com")])]}}],null,!0)}),e("el-table-column",{attrs:{prop:"orderCnt",label:t.$t("shopifyOrders.当前可生成订单数")}}),e("el-table-column",{attrs:{prop:"hideOrderCnt",label:t.$t("shopifyOrders.已被隐藏的订单数")}}),e("el-table-column",{attrs:{label:t.$t("shopifyOrders.操作")},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("div",[e("el-link",{attrs:{disabled:!s.orderCnt,type:"primary"},on:{click:function(e){return t.selectStore(s,i.relationship.id)}}},[t._v(t._s(t.$t("shopifyOrders.查看并手工生成采购单")))])],1),s.hideOrderCnt?e("div",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.selectStore(s,i.relationship.id,"hidden")}}},[t._v(" "+t._s(t.$t("shopifyOrders.查看已隐藏的订单"))+" ")])],1):t._e()]}}],null,!0)})],1)],1)])})),0)])],1)],1)],1)])]),t.storeId?e("div",{ref:"ordersFooter",staticClass:"alert-wrap d-flex justify-content-between"},[e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"is-bold"},[t._v(t._s(this.selectNum)+" "+t._s(t.$t("shopifyOrders.shopifyOrdersHaveBeen"))+" ")])]),e("div",{staticStyle:{"padding-right":"70px"}},[e("el-button",{staticClass:"button-new-tag",attrs:{type:"primary",size:"small"},on:{click:t.setOrderHideChecked}},[t._v(t._s(1==t.isManage?t.$t("shopifyOrders.hide"):t.$t("shopifyOrders.show"))+" "+t._s(t.$t("shopifyOrders.selectedOrders")))]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.isManage,expression:"isManage == 1"}],staticClass:"button-new-tag mg-l-10",attrs:{type:"success",size:"small"},on:{click:t.getInvocie}},[t._v(t._s(t.$t("shopifyOrders.makeAPurchaseOrder")))])],1)]):t._e(),e("el-dialog",{staticClass:"add-vendor-dialog",attrs:{title:t.$t("shopifyOrders.addANewVendor"),visible:t.addVendorDialog.isShow,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addVendorDialog,"isShow",e)}}},[e("el-divider"),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form",[e("el-form-item",{attrs:{label:t.$t("shopifyOrders.name"),"label-width":t.addVendorDialog.labelW,required:""}},[e("el-input",{attrs:{placeholder:t.$t("shopifyOrders.name"),"auto-complete":"off"},model:{value:t.addVendorDialog.name,callback:function(e){t.$set(t.addVendorDialog,"name",e)},expression:"addVendorDialog.name"}})],1),e("el-form-item",{attrs:{label:t.$t("shopifyOrders.email"),"label-width":t.addVendorDialog.labelW}},[e("el-input",{attrs:{placeholder:t.$t("shopifyOrders.email"),"auto-complete":"off"},model:{value:t.addVendorDialog.email,callback:function(e){t.$set(t.addVendorDialog,"email",e)},expression:"addVendorDialog.email"}})],1),e("el-form-item",{attrs:{label:t.$t("shopifyOrders.remark"),"label-width":t.addVendorDialog.labelW}},[e("el-input",{attrs:{placeholder:t.$t("shopifyOrders.remark"),"auto-complete":"off"},model:{value:t.addVendorDialog.remark,callback:function(e){t.$set(t.addVendorDialog,"remark",e)},expression:"addVendorDialog.remark"}})],1)],1)],1)],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.addVendorDialog.isShow=!1}}},[t._v(t._s(t.$t("shopifyOrders.close")))]),e("el-button",{attrs:{size:"small",type:"primary",loading:t.addVendorDialog.loading},on:{click:function(e){return t.saveVendor(2)}}},[t._v(t._s(t.$t("shopifyOrders.save")))])],1)],1),e("el-dialog",{staticClass:"d-block",attrs:{title:t.$t("shopifyOrders.exportTo"),visible:t.exportDialog,width:"620px","close-on-click-modal":!1},on:{"update:visible":function(e){t.exportDialog=e}}},[e("el-divider"),e("div",{staticStyle:{padding:"20px"}},[t.$store.state.userInfo.email?e("p",{staticClass:"mg-b-10"},[t._v(t._s(t.$t("shopifyOrders.exportTo"))+" "+t._s(t.$store.state.userInfo.email))]):e("p",[e("el-link",{staticClass:"mg-l-10",attrs:{type:"primary",underline:!1},on:{click:t.$root.$children[0].changeUserEmail}},[t._v(t._s(t.$store.state.userInfo.email?t.$t("app.modifyEmail"):"您当前未绑定邮箱，请先添加邮箱"))])],1),e("el-radio-group",{model:{value:t.exportStatus,callback:function(e){t.exportStatus=e},expression:"exportStatus"}},[e("el-radio",{attrs:{label:"1"}},[t._v(t._s(t.$t("shopifyOrders.allOrders")))]),e("el-radio",{attrs:{label:"2",disabled:!t.selectNum}},[t._v(t._s(t.$t("shopifyOrders.selected"))+" "+t._s(t.selectNum)+" "+t._s(t.$t("shopifyOrders.orders")))])],1)],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small"},on:{click:function(e){t.exportDialog=!1}}},[t._v(t._s(t.$t("shopifyOrders.cancel")))]),e("el-button",{attrs:{size:"small",type:"primary",disabled:!t.exportStatus||!t.$store.state.userInfo.email,loading:t.exportLoading},on:{click:t.exportOrders}},[t._v(t._s(t.$t("shopifyOrders.exportOrders")))])],1)],1),e("el-dialog",{staticClass:"dialog-automatic",attrs:{visible:t.automaticSettingDialog.isShow,title:"Automatic dispatch orders setting"},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShow",e)}}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.automaticSettingDialog.loading,expression:"automaticSettingDialog.loading"}],staticClass:"automatic-body"},[e("div",{staticStyle:{"margin-bottom":"15px"}},[e("el-alert",{attrs:{title:"The unfulfilled shopify order will be dispatched to the vendor according to the optimization apportion rules which you made. You can set up an automatic advice to your vendor to check order and offer quotation.",type:"warning","show-icon":"",closable:!1}})],1),t.automaticSettingDialog.openRulestatus?[e("div",{staticStyle:{"margin-bottom":"15px",padding:"15px",border:"1px #DCDFE6 solid"}},[e("div",{staticClass:"d-flex",staticStyle:{"margin-bottom":"10px"}},[e("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:t.automaticSettingDialog.allProducts},model:{value:t.automaticSettingDialog.productIds,callback:function(e){t.$set(t.automaticSettingDialog,"productIds",e)},expression:"automaticSettingDialog.productIds"}},t._l(t.automaticSettingDialog.products,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name.substring(0,18),value:i.id}},[e("div",{staticClass:"product-select-opt"},[e("div",{staticClass:"img-wrap",style:{backgroundImage:`url(${i.img})`}}),e("div",{staticClass:"info"},[e("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(i.name))]),e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v(t._s(i.currency))]),i.minShopPrice==i.maxShopPrice?e("span",[t._v(t._s(i.minShopPrice))]):e("span",[t._v(t._s(i.minShopPrice)+" - "+t._s(i.maxShopPrice))])])])])])})),1),e("el-checkbox",{staticStyle:{"margin-right":"25px","margin-bottom":"0"},model:{value:t.automaticSettingDialog.allProducts,callback:function(e){t.$set(t.automaticSettingDialog,"allProducts",e)},expression:"automaticSettingDialog.allProducts"}},[t._v(" Choose my all Shopify products ")]),e("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:t.automaticSettingDialog.vendorId,callback:function(e){t.$set(t.automaticSettingDialog,"vendorId",e)},expression:"automaticSettingDialog.vendorId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return e("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1),e("div",[t._v(" Every "),e("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"circle period"},model:{value:t.automaticSettingDialog.period,callback:function(e){t.$set(t.automaticSettingDialog,"period",e)},expression:"automaticSettingDialog.period"}},t._l(15,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t+""}})})),1),t._v(" day(s) ")],1)],1),e("div",[e("el-select",{staticStyle:{"margin-right":"25px",width:"200px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:t.automaticSettingDialog.visibilityType,callback:function(e){t.$set(t.automaticSettingDialog,"visibilityType",e)},expression:"automaticSettingDialog.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1),e("el-select",{staticStyle:{"margin-right":"25px",width:"100px"},attrs:{size:"mini"},model:{value:t.automaticSettingDialog.status,callback:function(e){t.$set(t.automaticSettingDialog,"status",e)},expression:"automaticSettingDialog.status"}},[e("el-option",{attrs:{label:"Enabled",value:"1"}}),e("el-option",{attrs:{label:"Disabled",value:"2"}})],1),e("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,loading:t.automaticSettingDialog.saveRuleLoading,type:"primary",size:"mini"},on:{click:function(e){return t.saveRule()}}},[t._v("Save Rule")]),e("el-button",{attrs:{disabled:t.automaticSettingDialog.saveRuleLoading,size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!1)}}},[t._v("Cancel")])],1)])]:e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.changeOpenAddRule(!0)}}},[t._v("+ Add a dispatch rule")])],1),e("div",[e("el-table",{ref:"autoSettingTable",staticClass:"auto-setting-table",staticStyle:{width:"100%"},attrs:{data:t.automaticSettingDialog.items,"row-key":"id",stripe:"",height:"300"}},[e("el-table-column",{attrs:{label:"Priority",width:"110"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("i",{staticClass:"el-icon-d-caret"}),t._v(" "+t._s(i.$index+1)+" "),i.$index?t._e():e("span",{staticStyle:{color:"#C0C4CC"}},[t._v("(Highest)")])]}}])}),e("el-table-column",{attrs:{label:"Products in Shopify",width:"240"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("div",{staticClass:"d-flex"},[e("el-select",{staticStyle:{"margin-right":"5px",width:"200px"},attrs:{filterable:"",remote:"",multiple:"",placeholder:"Please enter a product name","remote-method":t.remoteMethodGetProducts,loading:t.automaticSettingDialog.getProductsloading,size:"mini",disabled:i.row.editMode.allProducts},model:{value:i.row.editMode.productIds,callback:function(e){t.$set(i.row.editMode,"productIds",e)},expression:"scope.row.editMode.productIds"}},t._l(t.automaticSettingDialog.products,(function(i){return e("el-option",{key:i.id,attrs:{label:i.name.substring(0,18),value:i.id}},[e("div",{staticClass:"product-select-opt"},[e("div",{staticClass:"img-wrap",style:{backgroundImage:`url(${t.stockImg(i)})`}}),e("div",{staticClass:"info"},[e("div",{staticClass:"name tx-ellipsis1"},[t._v(t._s(i.name))]),e("div",{staticClass:"price"},[e("span",{staticClass:"currency"},[t._v(t._s(i.currency))]),i.minPrice==i.maxPrice?e("span",[t._v(t._s(i.minPrice))]):e("span",[t._v(t._s(i.minPrice)+" - "+t._s(i.maxPrice))])])])])])})),1),e("el-checkbox",{staticStyle:{"margin-bottom":"0"},model:{value:i.row.editMode.allProducts,callback:function(e){t.$set(i.row.editMode,"allProducts",e)},expression:"scope.row.editMode.allProducts"}},[t._v(" all ")])],1):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:!i.row.editMode,expression:"!scope.row.editMode"}],staticClass:"d-flex",on:{click:function(e){return t.showProducts(i.row)}}},[i.row.products.length?[t._l(i.row.products,(function(i,s){return[s<5?e("el-image",{key:i.id,staticStyle:{width:"26px",height:"26px","margin-right":"5px"},attrs:{src:t.stockImg(i),fit:"contain",lazy:""}},[e("div",{staticClass:"image-slot",staticStyle:{color:"#C0C4CC","text-align":"center"},attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])]):t._e()]})),i.row.productCnt>5?[e("span",{staticStyle:{color:"#909399"}},[t._v(" ... ("),e("span",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(i.row.productCnt))]),t._v(") ")])]:t._e()]:[t._v("My all Shopify products")]],2)]}}])}),e("el-table-column",{attrs:{label:"Dispatch to vendor",width:"180",prop:"vendorName"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"170px"},attrs:{filterable:"",remote:"",placeholder:"Please enter a vendor name","remote-method":t.remoteMethodGetVendors,loading:t.automaticSettingDialog.getVendorsloading,size:"mini"},model:{value:i.row.editMode.relationshipId,callback:function(e){t.$set(i.row.editMode,"relationshipId",e)},expression:"scope.row.editMode.relationshipId"}},t._l(t.automaticSettingDialog.vendors,(function(t){return e("el-option",{key:t.id,attrs:{label:t.vendorName,value:t.id}})})),1):e("span",[t._v(t._s(i.row.vendorName))])]}}])}),e("el-table-column",{attrs:{label:"Cycle Time",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("div",[e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini",placeholder:"period"},model:{value:i.row.editMode.period,callback:function(e){t.$set(i.row.editMode,"period",e)},expression:"scope.row.editMode.period"}},t._l(15,(function(i){return e("el-option",{key:i,attrs:{label:i,value:i+""}},[e("span",[t._v(t._s(i))]),t._v(" "),e("span",{staticStyle:{color:"#C0C4CC"}},[t._v("day(s)")])])})),1)],1):e("span",[t._v(" Every "+t._s(i.row.period)+" day(s) ")])]}}])}),e("el-table-column",{attrs:{label:"Vendor visibility",width:"170"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"Vendor visibility"},model:{value:i.row.editMode.visibilityType,callback:function(e){t.$set(i.row.editMode,"visibilityType",e)},expression:"scope.row.editMode.visibilityType"}},t._l(t.visibilityTypeArr,(function(t,i){return e("el-option",{key:i,attrs:{label:t,value:i}})})),1):e("span",[t._v(t._s(t.visibilityTypeArr[i.row.visibilityType]))])]}}])}),e("el-table-column",{attrs:{label:"Rule status",width:"110"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},model:{value:i.row.editMode.status,callback:function(e){t.$set(i.row.editMode,"status",e)},expression:"scope.row.editMode.status"}},[e("el-option",{attrs:{label:"Enabled",value:"1"}}),e("el-option",{attrs:{label:"Disabled",value:"2"}})],1):e("el-tag",{attrs:{type:1==i.row.status?"success":"danger","disable-transitions":!0}},[t._v(" "+t._s(1==i.row.status?"Enabled":"Disabled")+" ")])]}}])}),e("el-table-column",{attrs:{label:"Action"},scopedSlots:t._u([{key:"default",fn:function(i){return[i.row.editMode?[e("el-button",{attrs:{loading:i.row.loading,disabled:i.row.loading,size:"mini",type:"primary"},on:{click:function(e){return t.saveEditRule(i.row)}}},[t._v("Save Rule")]),e("el-button",{attrs:{disabled:i.row.loading,size:"mini"},on:{click:function(e){return t.cancelEditRule(i.row)}}},[t._v("Cancel")])]:[e("el-link",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.editRule(i.row)}}},[t._v("Edit")]),e("el-link",{staticStyle:{"margin-right":"10px"},attrs:{disabled:i.row.statusLoading,type:1==i.row.status?"danger":"success"},on:{click:function(e){return t.changeRuleStatus(i.row)}}},[t._v(" "+t._s(1==i.row.status?"Disable":"Enable")+" ")]),e("el-popconfirm",{attrs:{title:"Do you want to delete it",iconColor:"red",confirmButtonText:"Delete",cancelButtonText:"Cancel"},on:{onConfirm:function(e){return t.delRuleStatus(i.row,i.$index)}}},[e("el-link",{attrs:{slot:"reference",disabled:i.row.delLoading,type:"danger"},slot:"reference"},[t._v("Delete")])],1)]]}}])})],1)],1)],2),e("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"footer"},slot:"footer"},[e("div",[t._v(" Only matching last "),e("el-select",{staticStyle:{width:"100px"},attrs:{size:"mini"},on:{change:t.changeDay},model:{value:t.automaticSettingDialog.day,callback:function(e){t.$set(t.automaticSettingDialog,"day",e)},expression:"automaticSettingDialog.day"}},t._l(t.automaticSettingDialog.dayArr,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1),t._v(" days unfulfilled orders ")],1),e("div",[e("el-button",{attrs:{disabled:t.automaticSettingDialog.loading},on:{click:function(e){t.automaticSettingDialog.isShow=!1}}},[t._v("Close")]),e("el-button",{attrs:{type:"primary",loading:t.automaticSettingDialog.loading},on:{click:t.dispatchRuleTest}},[t._v(" Dispatch rule TEST ")])],1)]),e("el-dialog",{attrs:{width:"30%",title:"Dispatch rule Test Preview",visible:t.automaticSettingDialog.previewShow,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"previewShow",e)}}},[e("div",{staticStyle:{padding:"20px"}},[e("p",{staticStyle:{"margin-bottom":"10px"}},[t._v(" According to your settings, we found some data for you: ")]),e("p",[t._v(" Shopify order: "),e("b",{staticStyle:{"margin-right":"15px",color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.orderCnt))]),t._v(" (Dispatch to "),e("b",{staticStyle:{color:"#5c6ac4"}},[t._v(t._s(t.automaticSettingDialog.vendorCnt))]),t._v(" vendor(s)) ")])]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{disabled:t.automaticSettingDialog.runLoading},on:{click:function(e){t.automaticSettingDialog.previewShow=!1}}},[t._v(" Dispatch in the Next Cycle ")]),e("el-button",{attrs:{loading:t.automaticSettingDialog.runLoading,disabled:t.automaticSettingDialog.runLoading,type:"primary"},on:{click:t.runDispatchRule}},[t._v("Dispatch Immediately")])],1)]),e("el-dialog",{attrs:{width:"50%",title:"Products",visible:t.automaticSettingDialog.isShowProducts,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.automaticSettingDialog,"isShowProducts",e)}}},[e("div",{staticClass:"preview-product-list"},t._l(t.automaticSettingDialog.showProductsItems,(function(i){return e("div",{key:i.id,staticClass:"pro"},[e("el-image",{staticStyle:{width:"160px",height:"160px"},attrs:{src:t.stockImg(i),fit:"contain"}}),e("div",{staticClass:"name tx-ellipsis2",attrs:{title:i.name}},[t._v(" "+t._s(i.name)+" ")])],1)})),0),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.automaticSettingDialog.isShowProducts=!1}}},[t._v("Close")])],1)])],1),e("el-dialog",{attrs:{visible:t.warningDialog.visible,width:"500px"},on:{"update:visible":function(e){return t.$set(t.warningDialog,"visible",e)}}},[e("div",{staticClass:"warning-dialog"},[e("el-alert",{attrs:{type:"primary",description:t.$t("shopifyOrders.当前可生成订单超过2000条，为了不影响操作性能，建议您指定订单数量进行生成采购单操作"),"show-icon":"",closable:!1}}),e("div",{staticClass:"title"},[t._v(t._s(t.$t("shopifyOrders.请选择查看的订单：")))]),e("div",{staticClass:"radio-d"},[e("el-radio",{attrs:{label:1},on:{change:t.warningRadio},model:{value:t.warningDialog.radio,callback:function(e){t.$set(t.warningDialog,"radio",e)},expression:"warningDialog.radio"}},[t._v(t._s(t.$t("shopifyOrders.按订单编号筛选")))]),e("el-radio",{attrs:{label:2},on:{change:t.warningRadio},model:{value:t.warningDialog.radio,callback:function(e){t.$set(t.warningDialog,"radio",e)},expression:"warningDialog.radio"}},[t._v(t._s(t.$t("shopifyOrders.按订单数量筛选")))])],1),1===t.warningDialog.radio?e("div",[e("el-form",{attrs:{size:"small","label-position":"left","label-width":"120px",model:t.warningDialog}},[e("el-form-item",{attrs:{label:"Order ID From:"}},[e("el-input",{attrs:{type:"number"},model:{value:t.warningDialog.orderStart,callback:function(e){t.$set(t.warningDialog,"orderStart",e)},expression:"warningDialog.orderStart"}},[e("template",{slot:"prepend"},[t._v("#")])],2)],1),e("el-form-item",{attrs:{label:"Order ID TO:"}},[e("el-input",{attrs:{type:"number"},model:{value:t.warningDialog.orderEnd,callback:function(e){t.$set(t.warningDialog,"orderEnd",e)},expression:"warningDialog.orderEnd"}},[e("template",{slot:"prepend"},[t._v("#")])],2)],1)],1)],1):e("div",{staticClass:"warning-order-wrapper"},[e("el-checkbox-group",{attrs:{max:1},model:{value:t.warningDialog.checked,callback:function(e){t.$set(t.warningDialog,"checked",e)},expression:"warningDialog.checked"}},[e("el-checkbox",{attrs:{label:3}},[t._v(" "+t._s(t.$t("shopifyOrders.日期最早可处理的"))+" "),3!==t.warningDialog.checked[0]?e("el-input",{staticClass:"warning-order",attrs:{type:"number",size:"small",disabled:""}}):e("el-input",{staticClass:"warning-order",attrs:{type:"number",size:"small"},model:{value:t.warningDialog.orders,callback:function(e){t.$set(t.warningDialog,"orders",e)},expression:"warningDialog.orders"}}),t._v(" "+t._s(t.$t("shopifyOrders.条订单"))+" ")],1),e("el-checkbox",{attrs:{label:4}},[t._v(" "+t._s(t.$t("shopifyOrders.日期最新可处理的"))+" "),4!==t.warningDialog.checked[0]?e("el-input",{staticClass:"warning-order",attrs:{type:"number",size:"small",disabled:""}}):e("el-input",{staticClass:"warning-order",attrs:{type:"number",size:"small"},model:{value:t.warningDialog.orders,callback:function(e){t.$set(t.warningDialog,"orders",e)},expression:"warningDialog.orders"}}),t._v(" "+t._s(t.$t("shopifyOrders.条订单"))+" ")],1)],1)],1)],1),e("div",{staticClass:"warning-dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("div",[e("el-link",{attrs:{type:"info"},on:{click:t.selectStore2}},[t._v(t._s(t.$t("shopifyOrders.显示全部订单")))])],1),e("div",[e("el-button",{on:{click:function(e){t.warningDialog.visible=!1}}},[t._v(t._s(t.$t("shopifyOrders.取消")))]),e("el-button",{attrs:{type:"primary",loading:t.warningDialog.btnLoading},on:{click:t.confirmViewOrder}},[t._v(t._s(t.$t("shopifyOrders.确认查看订单")))])],1)])]),e("el-dialog",{attrs:{visible:t.DialogLoadingCnt.isShow,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){return t.$set(t.DialogLoadingCnt,"isShow",e)}}},[e("div",{staticClass:"get-invocie-loading"},[e("i",{staticClass:"el-icon-loading"}),e("span",[t._v("Loading "),e("span",[t._v(t._s(parseInt(100*t.DialogLoadingCnt.loadingCnt))+" %")])])])]),e("DialogOrderQTYAlert",{attrs:{data:t.dialogQtyAlert}}),e("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:60}})],1)},a=[],r=(i("14d9"),i("aa47")),o=i("1646"),l={data(){return{warningDialog:{visible:!1,radio:1,orderStart:"",orderEnd:"",checked:[],orders:"",page:null,data:null,relationshipId:null},warningDialogDefault:"{}",filterParams:{name:"",customerLike:"",relationshipId:"",codeNameGeq:"",codeNameLeq:""},dynamicTags:[],inputVisible:!1,inputVisible2:!1,vendorName:"",loading:!1,tableHeight:400,tableHeight2:400,page:this.$route.query.page?Number(this.$route.query.page):"1",rowsPerPage:localStorage.getItem("importPerPage")?Number(localStorage.getItem("importPerPage")):20,pageSizes:[10,20,30,50,100],items:[],totalCount:0,totalPage:0,updateOrderLoading:!1,cnow:0,now:Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff,updateTime:localStorage.getItem("orders-updateTime")?Number(localStorage.getItem("orders-updateTime")):0,dispatchStatus:"",sortBy:"",fulfillStatus:[],timeFilter:"",shopifyStore:[],dateRangeValue:"",codeName:"",dateArr:{1:"shopifyOrders.today",2:"shopifyOrders.last7Days",3:"shopifyOrders.last30Days",4:"shopifyOrders.last90Days",5:"shopifyOrders.last12Months",6:"shopifyOrders.custom"},sortArr:{1:"shopifyOrders.orderNumberAascending",2:"shopifyOrders.orderNumberDescending",3:"shopifyOrders.dateOldestFirst",4:"shopifyOrders.dateNewestFirst"},dispatchArr:{1:"All",2:"Not dispatched to vendor",3:"Dispatched to vendor"},tableData:[],tableDataTab1:[],tableAll:[],multipleSelection:[],multipleSelectionSub:[],getRowKey(t){return t.id},getRowKeyChild(t){return t.id},props:{label:"id",children:"items"},checked:!1,filterDate:[],dateFrom:"",dateTo:"",storeList:[],shopifyStoreName:"",supplierList:[],isIndeterminate:!1,checkedSupplier:[],checkedSupplierName:"",isCheckAll:!1,isCancelAll:!1,checkAll:!1,vendorData:[],addVendorDialog:{isShow:!1,loading:!1,labelW:"120px",name:"",remark:"",email:"",id:""},addVendorDialogDefault:"{}",selectData:[],selectDataNoHalf:[],expandedKeys:[],expandAll:!1,exportDialog:!1,exportStatus:"",exportLoading:!1,automaticSettingDialog:{loading:!1,isShow:!1,getProductsloading:!1,allProducts:!1,products:[],productIds:[],getVendorsloading:!1,vendorId:"",vendors:[],period:"",visibilityType:"",status:"1",saveRuleLoading:!1,openRulestatus:!1,page:1,rowsPerPage:10,total:0,totalPage:0,items:[],previewShow:!1,vendorCnt:0,orderCnt:0,isShowProducts:!1,showProductsItems:[],day:30,dayArr:[7,10,15,20,30,45,60],runLoading:!1},automaticSettingDialogDefault:"{}",visibilityTypeArr:{1:"Auto dispatch",2:"After my reconfirm"},ruleCnt:0,isManage:1,defaultChecked:[],selectLoading:!1,checkLoading:!1,filterCustomLoading:!1,filterCustomItems:[],customerId:"",activeCustomer:null,orderMin:void 0,orderMax:void 0,storeId:"",activeStore:null,activeRange:null,activeRangeIds:[],customerH:0,ce:this.$CE,selectArr:[],reSizeTime2:0,isAll1:!1,selectSku:[],allSku:[],selectOrder:[],allOrder:[],tempCode:"",getInvocieTime:0,DialogLoadingCnt:{isShow:!1,loadingCnt:0},dialogQtyAlert:{isShow:!1,item:null}}},components:{DialogOrderQTYAlert:o["a"]},watch:{isAll(){this.isAll1=this.isAll},$route:"gotoPage","$store.state.userInfo"(){this.$store.state.userInfo.ruleCnt&&(this.ruleCnt=this.$store.state.userInfo.ruleCnt)},shopifyStore(){if(!this.shopifyStore.length)return;let t=[];this.shopifyStore.forEach(e=>{this.storeList.forEach(i=>{e==i.shopifyAccountId&&t.push(i.store)})}),this.shopifyStoreName=t.join(",")},checkedSupplier(){if(!this.checkedSupplier.length)return;let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&"999e"!=i.id&&t.push(i.vendorName)})}),this.checkedSupplierName=t.join(",")},isShowFilter(){this.isShowFilter}},computed:{selectNum(){return this.isCancelAll?this.totalCount-(this.allOrder.length-this.selectOrder.length):this.selectOrder.length},isShowFilter(){return!(this.sortBy||this.fulfillStatus.length||this.shopifyStore.length||this.codeName||this.dispatchStatus)},isAll(){if(!this.storeId)return!1;let t=this.$refs.treeData.getCheckedNodes();for(let e=0;e<t.length;e++)t[e].items||(t.splice(e,1),e--);return t.length==this.tableData.length&&this.tableData.length>0||t.length==this.tableAll.length&&this.tableAll.length>0}},mounted(){this.$route.query.page&&(this.page=1,this.$router.push({name:"shopifyOrders"})),this.warningDialogDefault=JSON.stringify(this.warningDialog),this.automaticSettingDialogDefault=JSON.stringify(this.automaticSettingDialog),this.addVendorDialogDefault=JSON.stringify(this.addVendorDialog),this.$nextTick(()=>{this.customerH=this.$refs.customerH.clientWidth-30,this.getStore(),this.dynamicTags.push({id:this.$store.state.userInfo.id,vendorName:this.$store.state.userInfo.name}),this.loading=!1}),this.cnow=setInterval(()=>{this.now=Date.parse(new Date)/1e3-this.$store.state.userInfo.timeDiff},1e3),"999e"==this.$route.params.vid&&(this.timeFilter=""),this.$route.params.id&&(this.timeFilter=""),this.checkedSupplier=[]},beforeRouteEnter(t,e,i){i(t=>{t.loading=!0})},beforeDestroy(){clearInterval(this.cnow)},methods:{formatCode(t){if(!t)return"";t=t.replace(/[^0-9]/gi,","),t=t.split(","),t=t.filter(t=>t&&t.trim());let e=0;return t.forEach(t=>{t>e&&(e=t)}),e},loadAll(){let t={timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,keywords:this.codeName,isManage:this.isManage,accountId:this.storeId,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq)};this.$apiCall("api.Invoice.shopifyOrdersByVendor",t,t=>{this.tableAll=t.Data.Results})},cancelAll(){this.selectSku=[],this.allSku=[],this.allOrder=[],this.selectOrder=[],this.selectData=[],this.selectDataNoHalf=[],this.$refs.treeData.setCheckedKeys([]),this.isCancelAll=!1},selectAll(){this.selectSku=[],this.allSku=[],this.allOrder=[],this.selectOrder=[],this.isCancelAll=!0,this.tableData.forEach(t=>{t.items&&(this.allOrder.push(t.id),this.selectOrder.push(t.id),t.items.forEach(t=>{this.selectSku.push(t.id),this.allSku.push(t.id)}))}),this.$refs.treeData.setCheckedKeys(this.selectSku)},handleExpandChange(t,e,i){},remoteMethodCustom(t){this.selectArr=[],t&&(this.selectLoading=!0,this.$apiCall("api.Relationship.findByVendor",{name:t},t=>{this.selectLoading=!1,9999==t.ErrorCode?this.selectArr=t.Data.Results:this.$message({message:t.Message,type:"error"})}))},openWarningDialog(t,e){this.warningDialog.radio=1,this.warningDialog.orderStart="",this.warningDialog.orderEnd="",this.warningDialog.checked=[],this.warningDialog.orders="",this.warningDialog.page=null,this.warningDialog.data=t,this.warningDialog.relationshipId=e,this.warningDialog.visible=!0},confirmViewOrder(){if(1===this.warningDialog.radio){if(""===this.warningDialog.orderStart||""===this.warningDialog.orderEnd)return void this.$message.error(this.$t("shopifyOrders.请输入订单号"));this.activeRange={max:this.warningDialog.orderEnd,min:this.warningDialog.orderStart}}else{if(!this.warningDialog.checked.length)return void this.$message.error(this.$t("shopifyOrders.请设置查询数量"));this.sortBy=this.warningDialog.checked[0];const{orders:t}=this.warningDialog;if(""===t)return void this.$message.error(this.$t("shopifyOrders.请设置查询数量"));this.warningDialog.page=Math.ceil(Number(t)/this.rowsPerPage)}const{data:t}=this.warningDialog;this.storeId=t.id,this.activeStore={shopifyAccountId:t.id,store:t.name,customerName:t.customerName,orderCnt:t.orderCnt,customerId:t.rid,orderNum:t.orderNum},this.warningDialog.visible=!1,this.getItems()},warningRadio(){this.warningDialog.checked=[],this.warningDialog.orders="",this.warningDialog.orderStart="",this.warningDialog.orderEnd=""},headerCellStyle(){return"color: #5c6ac4;"},filterGetItem(){this.getStore()},clearFilter(){this.filterParams.name="",this.filterParams.customerLike="",this.filterParams.relationshipId="",this.getStore()},removeStore(){this.warningDialog=JSON.parse(this.warningDialogDefault),this.activeRange=null,this.activeStore=null,this.storeId="",this.selectData=[],this.selectDataNoHalf=[],this.tableData=[],this.tableDataTab1=[],this.checked=!1,this.$router.push({name:"shopifyOrders"})},clearRange(){},showTree(t,e,i){return e.isShow},tableSelect(t){if("remove"==t&&(this.$refs.treeData.setCheckedKeys([]),this.activeRange=null,this.getItems(),this.checked=!1),"range"==t){if(!this.orderMin&&!this.orderMax)return void this.$elementMessage(this.$t("shopifyOrders.请输入单号范围"),"error");if(this.orderMin>this.orderMax)return void this.$elementMessage(this.$t("shopifyOrders.起始单号必须小于结束单号"),"error");this.$refs.treeData.setCheckedKeys([]),this.selectDataNoHalf=[],this.selectData=[],this.tableData=this.tableDataTab1.slice();let t=[];for(let e=0;this.tableData.length>e;e++){let i=this.tableData[e].codeName;i=i.replace(/[^0-9]/gi,","),i=i.split(","),i=i.filter(t=>t&&t.trim());let s=0;i.forEach(t=>{t>s&&(s=t)}),s>=this.orderMin&&s<=(this.orderMax?this.orderMax:Number.POSITIVE_INFINITY)?t.push(this.tableData[e].id):(this.tableData.splice(e,1),e--)}this.$refs.treeData.setCheckedKeys(t),this.$elementMessage(this.$t("shopifyOrders.筛选到了{length}条数据",{length:t.length}),"success"),this.activeRange={min:this.orderMin,max:this.orderMax},this.checked=!!t.length,this.$nextTick(()=>{this.handleCheck()}),this.$refs.selectRangePopover.doClose()}},selectStore2(){const{data:t}=this.warningDialog;this.storeId=t.id,this.activeStore={shopifyAccountId:t.id,store:t.name,customerName:t.customerName,orderCnt:t.orderCnt,customerId:t.rid,orderNum:t.orderNum},this.warningDialog.visible=!1,this.getItems()},selectStore(t,e,i){this.warningDialog.relationshipId=e,this.storeId=t.id,this.activeStore={shopifyAccountId:t.id,store:t.name,customerName:t.customerName,orderCnt:t.orderCnt,customerId:t.rid,orderNum:t.orderNum},this.isManage=i?2:1,this.cancelAll(),this.clearFilterItems(),this.loadAll()},getCustom(t){t&&(this.filterCustomLoading=!0,this.$apiCall("api.Relationship.findByVendor",{name:t},t=>{this.filterCustomLoading=!1,9999==t.ErrorCode?this.filterCustomItems=t.Data.Results:this.$elementMessage(t.Message,"error")}))},setOrderHideChecked(){this.$confirm(2==this.isManage?this.$t("shopifyOrders.是否要显示选择订单, 是否继续?"):this.$t("shopifyOrders.是否要隐藏选择订单, 是否继续?"),this.$t("shopifyOrders.提示"),{confirmButtonText:2==this.isManage?this.$t("shopifyOrders.显示"):this.$t("shopifyOrders.隐藏"),cancelButtonText:this.$t("shopifyOrders.取消"),type:"warning"}).then(()=>{let t=[];this.allOrder.forEach(e=>{this.selectOrder.some(t=>{if(t==e)return!0})||t.push(e)});let e={orderIds:this.isCancelAll?[]:this.selectOrder,notOrderIds:this.isCancelAll?t:[],type:1==this.isManage?2:1,isAll:this.isCancelAll,accountId:this.storeId,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,fulfillmentStatus:this.fulfillStatus,keywords:this.codeName,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq)};this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHideByVendor",e,t=>{this.$hideLoading(),9999==t.ErrorCode?(this.cancelAll(),this.tableData=[],this.tableDataTab1=[],this.getItems(),this.selectDataNoHalf=[],this.selectData=[],this.$refs.treeData.setCheckedKeys([]),this.activeRange=null,this.tableSelect("remove")):(this.$hideLoading(),this.$elementMessage(t.Message,"error"))})})},setOrderHide(t){this.$confirm(2==this.isManage?this.$t("shopifyOrders.是否要显示此订单, 是否继续?"):this.$t("shopifyOrders.是否要隐藏此订单, 是否继续?"),this.$t("shopifyOrders.提示"),{confirmButtonText:this.$t("shopifyOrders.隐藏"),cancelButtonText:this.$t("shopifyOrders.取消"),type:"warning"}).then(()=>{let e=[];e.push(t.id),this.$showLoading(),this.$apiCall("api.ShopifyAccount.setOrderHideByVendor",{orderIds:e,type:1==this.isManage?2:1},e=>{this.$hideLoading(),9999==e.ErrorCode?(this.allOrder.forEach((e,i)=>{e==t.id&&this.allOrder.splice(i,1)}),this.selectOrder.forEach((e,i)=>{e==t.id&&this.selectOrder.splice(i,1)}),this.tableData.forEach(e=>{e.id==t.id&&e.items.forEach(t=>{console.log(t.id),this.selectSku.forEach((e,i)=>{e==t.id&&(console.log(1),this.selectSku.splice(i,1))}),this.allSku.forEach((e,i)=>{e==t.id&&this.allSku.splice(i,1)})})}),this.tableData=[],this.tableDataTab1=[],this.selectDataNoHalf=[],this.selectData=[],this.activeRange=null,this.tableSelect("remove")):(this.$hideLoading(),this.$elementMessage(e.Message,"error"))})})},changeDay(){this.$apiCall("api.DispatchOrderRule.setMatchTime",{day:this.automaticSettingDialog.day},t=>{9999==t.ErrorCode?this.$root.$children[0].checkLogin():this.$elementMessage(t.Message,"error")})},showProducts(t){if(!t.products.length)return;let e=()=>{this.automaticSettingDialog.showProductsItems=t.products,this.automaticSettingDialog.isShowProducts=!0};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},i=>{this.automaticSettingDialog.loading=!1,9999==i.ErrorCode?(t.products=i.Data.Results,e()):this.$elementMessage(i.Message,"error")})):e()},runDispatchRule(){this.automaticSettingDialog.runLoading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{isGenerate:1},t=>{this.automaticSettingDialog.runLoading=!1,9999==t.ErrorCode?(this.$elementMessage("success","success"),this.automaticSettingDialog.isShow=!1,this.automaticSettingDialog.previewShow=!1,this.getItems()):this.$elementMessage(t.Message,"error")})},dispatchRuleTest(){this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.testGenerate",{},t=>{this.automaticSettingDialog.loading=!1,9999==t.ErrorCode?(this.automaticSettingDialog.vendorCnt=t.Data.Results.vendorCnt,this.automaticSettingDialog.orderCnt=t.Data.Results.orderCnt,this.automaticSettingDialog.previewShow=!0):this.$elementMessage(t.Message,"error")})},delRuleStatus(t,e){t.delLoading=!0,this.$apiCall("api.DispatchOrderRule.deleteRule",{id:t.id},i=>{t.delLoading=!1,9999==i.ErrorCode?(this.automaticSettingDialog.items.splice(e,1),this.ruleCnt=this.automaticSettingDialog.items.length):this.$elementMessage(i.Message,"error")})},changeRuleStatus(t){t.statusLoading=!0,this.$apiCall("api.DispatchOrderRule.setStatus",{id:t.id},e=>{t.statusLoading=!1,9999==e.ErrorCode?this.$set(t,"status",1==t.status?"2":"1"):this.$elementMessage(e.Message,"error")})},editRule(t){let e=()=>{this.automaticSettingDialog.getProductsloading=!1,this.automaticSettingDialog.getVendorsloading=!1,this.automaticSettingDialog.items.forEach(t=>{this.$set(t,"editMode",null)}),t.editMode={id:t.id,relationshipId:t.relationshipId,period:t.period,visibilityType:t.visibilityType,status:t.status,productIds:[],allProducts:!t.products.length},this.automaticSettingDialog.vendors=[{vendorName:t.vendorName,id:t.relationshipId}],this.automaticSettingDialog.products=t.products,this.$nextTick(()=>{this.automaticSettingDialog.products.forEach(e=>{t.editMode.productIds.push(e.id)})})};t.productCnt>t.products.length?(this.automaticSettingDialog.loading=!0,this.$apiCall("api.DispatchOrderRule.getProductById",{ruleId:t.id},i=>{this.automaticSettingDialog.loading=!1,9999==i.ErrorCode?(t.products=i.Data.Results,e()):this.$elementMessage(i.Message,"error")})):e()},stockImg(t){return JSON.parse(t.imgsJson)[0]},cancelEditRule(t){this.$set(t,"editMode",null)},saveEditRule(t){if(!t.editMode.allProducts&&!t.editMode.productIds.length)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheProducts"),"error");if(!t.editMode.relationshipId)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheVendor"),"error");if(!t.editMode.period)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheCirclePeriod"),"error");if(!t.editMode.visibilityType)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheVendowVisibility"),"error");t.loading=!0;const e={id:t.editMode.id,relationshipId:t.editMode.relationshipId,period:t.editMode.period,visibilityType:t.editMode.visibilityType,productIds:t.editMode.productIds,status:t.editMode.status};t.editMode.allProducts&&(e.productIds=[]),this.$apiCall("api.DispatchOrderRule.changeByCustomer",e,e=>{t.loading=!1,9999==e.ErrorCode?(this.$set(t,"editMode",null),this.getAutomaticSettingItems()):this.$elementMessage(e.Message,"error")})},saveRule(){if(!this.automaticSettingDialog.allProducts&&!this.automaticSettingDialog.productIds.length)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheProducts"),"error");if(!this.automaticSettingDialog.vendorId)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheVendor"),"error");if(!this.automaticSettingDialog.period)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheCirclePeriod"),"error");if(!this.automaticSettingDialog.visibilityType)return void this.$elementMessage(this.$t("shopifyOrders.pleaseSelectTheVendowVisibility"),"error");this.automaticSettingDialog.saveRuleLoading=!0;const t={relationshipId:this.automaticSettingDialog.vendorId,period:this.automaticSettingDialog.period,visibilityType:this.automaticSettingDialog.visibilityType,productIds:this.automaticSettingDialog.productIds,status:this.automaticSettingDialog.status};this.automaticSettingDialog.allProducts&&(t.productIds=[]),this.$apiCall("api.DispatchOrderRule.addByCustomer",t,t=>{this.automaticSettingDialog.saveRuleLoading=!1,9999==t.ErrorCode?(this.changeOpenAddRule(!1),this.getAutomaticSettingItems()):this.$elementMessage(t.Message,"error")})},changeOpenAddRule(t){this.automaticSettingDialog.openRulestatus=t,t&&(this.automaticSettingDialog.getProductsloading=!1,this.automaticSettingDialog.allProducts=!1,this.automaticSettingDialog.products=[],this.automaticSettingDialog.productIds=[],this.automaticSettingDialog.getVendorsloading=!1,this.automaticSettingDialog.vendorId="",this.automaticSettingDialog.vendors=[],this.automaticSettingDialog.period="",this.automaticSettingDialog.visibilityType="",this.automaticSettingDialog.status="1")},remoteMethodGetVendors(t){t&&(this.automaticSettingDialog.getVendorsloading=!0,this.$apiCall("api.Relationship.findByCustomer",{name:t},t=>{this.automaticSettingDialog.getVendorsloading=!1,9999==t.ErrorCode&&(this.automaticSettingDialog.vendors=t.Data.Results)}))},remoteMethodGetProducts(t){t&&(this.automaticSettingDialog.getProductsloading=!0,this.$apiCall("api.Product.findByUser",{name:t},t=>{this.automaticSettingDialog.getProductsloading=!1,9999==t.ErrorCode&&(this.automaticSettingDialog.products=[],t.Data.Results.forEach(t=>{JSON.parse(t.imgsJson).length&&(t.img=JSON.parse(t.imgsJson)[0]),this.automaticSettingDialog.products.push(t)}))}))},getAutomaticSettingItems(t){t||(this.automaticSettingDialog.loading=!0);const e={};this.$apiCall("api.DispatchOrderRule.findByCustomer",e,t=>{this.automaticSettingDialog.loading=!1,9999==t.ErrorCode?(this.automaticSettingDialog.items=[],t.Data.Results.forEach(t=>{t.loading=!1,t.statusLoading=!1,t.delLoading=!1,t.editMode=null,this.automaticSettingDialog.items.push(t)}),this.ruleCnt=this.automaticSettingDialog.items.length):this.$elementMessage(t.Message,"error")})},openAutomaticSetting(){this.automaticSettingDialog=JSON.parse(this.automaticSettingDialogDefault),this.automaticSettingDialog.day=this.$store.state.userInfo.config&&this.$store.state.userInfo.config.matchDay?this.$store.state.userInfo.config.matchDay:30,this.automaticSettingDialog.isShow=!0,this.getAutomaticSettingItems(),this.$nextTick(()=>{const t=this.$refs.autoSettingTable.$refs.bodyWrapper.childNodes[0].childNodes[1],e=this;r["default"].create(t,{onEnd({newIndex:t,oldIndex:i}){let s={};i>t?(s.id=e.automaticSettingDialog.items[i].id,s.toId=e.automaticSettingDialog.items[t].id):(s.id=e.automaticSettingDialog.items[i].id,s.toId=t==e.automaticSettingDialog.items.length-1?"":e.automaticSettingDialog.items[t+1].id),e.$apiCall("api.DispatchOrderRule.changeSort",s,t=>{e.getAutomaticSettingItems(!0),9999!=t.ErrorCode&&e.$elementMessage(t.Message,"error")});const a=e.automaticSettingDialog.items.splice(i,1)[0];e.automaticSettingDialog.items.splice(t,0,a)}})})},getStore(){this.storeList=[],this.loading=!0,this.$apiCall("api.ShopifyAccount.findByVendor",{authStatus:1,customerName:this.filterParams.name,rid:this.filterParams.relationshipId,keywords:this.filterParams.customerLike},t=>{if(this.loading=!1,9999==t.ErrorCode){if(!t.Data.Results.length)return;this.storeList=t.Data.Results,this.storeList.forEach(t=>{t.shops&&t.shops.forEach(e=>{e.orderNum=t.orderNum,e.rid=t.relationship.customerId,this.$apiCall("api.ShopifyAccount.getCntDetail",{accountId:e.id,relationshipId:t.relationship.id},t=>{9999==t.ErrorCode&&(e.hideOrderCnt=t.Data.Results.hideOrderCnt,e.orderCnt=t.Data.Results.orderCnt,this.storeList=[...this.storeList])})})})}else this.$message({message:t.Message,type:"error"})})},exportOrders(){let t={email:this.$store.state.userInfo.email,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,accountIds:this.shopifyStore,keywords:this.codeName,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq),accountId:this.activeStore.shopifyAccountId},e={email:this.$store.state.userInfo.email,accountId:this.activeStore.shopifyAccountId},i=[];if(this.allOrder.forEach(t=>{this.selectOrder.some(e=>{if(e==t)return!0})||i.push(t)}),2==this.exportStatus&&(t.isAll=this.isCancelAll,t.ids=this.isCancelAll?[]:this.selectOrder,t.notOrderIds=this.isCheckAll?i:[]),3==this.exportStatus&&(2==this.dispatchStatus&&(t.fulfillType=1),3==this.dispatchStatus)){t.fulfillType=2;let e=[];this.checkedSupplier.forEach(t=>{this.supplierList.forEach(i=>{t==i.id&&e.push(i.id)})}),t.fulfillRelationshipIds=e}this.exportLoading=!0,this.$apiCall("api.Invoice.exportShopifyOrdersByVendor",1==this.exportStatus?e:t,t=>{if(this.exportLoading=!1,9999==t.ErrorCode){this.exportDialog=!1,console.log(this.$i18n.locale);let t="zh"==this.$i18n.locale?`<strong>订单正在导出</strong><br/>您导出的订单将会被发送到: ${this.$store.state.userInfo.email}。 <br/>订单导出的速度取决于所选订单数量的多少。`:`<strong>Your Orders are exporting</strong><br/>Your export will be delivered by email to: ${this.$store.state.userInfo.email}. <br/>Depending on how many Orders you’re exporting, this could take some time.`;this.$message({offset:200,duration:0,dangerouslyUseHTMLString:!0,showClose:!0,message:t,type:"success"})}else this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure()})},exportDialogOpen(){this.exportDialog=!0,this.exportStatus="",this.exportLoading=!1},openAddVendor(){this.addVendorDialog=JSON.parse(this.addVendorDialogDefault),this.addVendorDialog.name=this.vendorName,this.addVendorDialog.isShow=!0},saveVendor(t){if(!this.addVendorDialog.name)return void this.$elementMessage("Customer name required","error");this.addVendorDialog.loading=!0;let e="api.Relationship.addByCustomer",i={name:this.addVendorDialog.name,email:this.addVendorDialog.email,remark:this.addVendorDialog.remark};this.$apiCall(e,i,e=>{this.addVendorDialog.loading=!1,9999==e.ErrorCode?(this.vendorName="",this.addVendorDialog.isShow=!1,this.$elementMessage(this.$t("shopifyOrders.customersSuccessfullyAdded"),"success"),2==t?(this.dynamicTags.push({id:e.Data.Results,vendorName:this.addVendorDialog.name}),this.inputVisible=!1,this.vendorName=""):this.showInput(),this.getVendor()):(this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure())})},getInvocie(){if(this.getPageSku(),!this.selectSku.length&&!this.isCancelAll)return void this.$elementMessage(this.$t("shopifyOrders.pleaseChooseAnItem"),"error");let t=[];this.allSku.forEach(e=>{this.selectSku.some(t=>{if(t==e)return!0})||t.push(e)}),this.tempCode=`${this.storeId}${Date.parse(new Date)}`;let e={skus:this.isCancelAll?[]:this.selectSku,relationshipId:this.warningDialog.relationshipId,isAll:this.isCancelAll,notSkus:this.isCancelAll?t:[],accountId:this.storeId,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,fulfillmentStatus:this.fulfillStatus,keywords:this.codeName,tempCode:this.tempCode,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq)};this.DialogLoadingCnt.loadingCnt=0,this.DialogLoadingCnt.isShow=!0,this.getInvocieTime=setInterval(()=>{this.$apiCall("api.Invoice.checkPriceResult",{tempCode:this.tempCode,type:3},t=>{if("9999"==t.ErrorCode){let e=t.Data.Results;e.count&&e.all&&(this.DialogLoadingCnt.loadingCnt=e.count/e.all),1!=e.status&&(this.tempCode="",clearInterval(this.getInvocieTime),this.DialogLoadingCnt.isShow=!1,3==e.status&&e.message&&this.$elementMessage(e.message,"error"),2==e.status&&(this.$elementMessage(this.$t("shopifyOrders.aNewOrderSuccessfullyCreated"),"success"),sessionStorage.setItem("selectedSaveInfo",JSON.stringify(e.invoiceArr)),setTimeout(()=>{this.$router.push({name:"waitingForOffer",params:{saveCode:!0,code:e.invoiceArr[0].code}})},1e3)))}})},1e3),this.$apiCall("api.Invoice.genInvoiceByVendor",e,t=>{if(9998==t.ErrorCode)return this.dialogQtyAlert.isShow=!0,void(this.dialogQtyAlert.item=this.activeStore)})},changeCustomerName(){window.lazy&&window.clearTimeout(window.lazy),window.lazy=setTimeout(()=>{this.$apiCall("api.Relationship.findByCustomer",{name:this.vendorName},t=>{"9999"==t.ErrorCode?this.vendorData=t.Data.Results:(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})},400)},getVendor(){this.$apiCall("api.Relationship.findByCustomer",{},t=>{"9999"==t.ErrorCode?(this.vendorData=t.Data.Results,1==t.Data.Results.length&&this.dynamicTags.push(t.Data.Results[0])):(this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure())})},selectCustomer(t){this.dynamicTags=[],setTimeout(()=>{this.inputVisible=!1,this.inputVisible2=!1,this.vendorName="",this.dynamicTags.push(t)},300)},handleClose(t){this.dynamicTags.splice(t,1)},showInput(){this.inputVisible=!0,this.$nextTick(t=>{this.$refs.saveTagInput.$refs.input.focus()})},hidepopoverCustomer(){setTimeout(()=>{this.inputVisible=!1,this.inputVisible2=!1},100)},handleCheckAllChange(t){let e=[];if(this.supplierList.forEach(t=>{e.push(t.id)}),this.checkedSupplier=t?e:[],this.isIndeterminate=!1,1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&"999e"!=e&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}},handleCheckedCitiesChange(t){let e=t.length;if(this.checkAll=e===this.supplierList.length-1,this.isIndeterminate=e>0&&e<this.supplierList.length-1,1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}},dateChange(){this.filterDate.length>1&&(this.dateFrom=this.$moment(this.filterDate[0]).unix(),this.dateTo=this.$moment(this.filterDate[1]).endOf("d").unix(),this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.clearRange(),this.getItems())},changeSupplierTag(t){this.$showLoading();const e=this.$refs.treeData.store.nodesMap;for(let i in e)e[i].expanded=!1;setTimeout(()=>{this.expandedKeys=[],"999e"!=t.id&&(this.dynamicTags=[],this.dynamicTags.push({id:t.id,vendorName:t.vendorName})),this.supplierTag=t.id,this.storeTag="";let e=[];t.listInfo.length&&(t.listInfo.forEach(t=>{e.push(t.id),t.items&&t.items.length&&t.items.forEach(t=>{e.push(t.id)})}),this.$hideLoading()),this.tableData=this.tableDataTab1;let i=JSON.parse(JSON.stringify(this.tableDataTab1));i.forEach((t,e)=>{i[e].items=[]}),e.length&&(e.forEach(t=>{this.tableData.forEach((e,s)=>{e.items.forEach((e,a)=>{t==e.id&&i[s].items.push(e)})})}),this.tableData=[],i.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))},300)},filterItems2(t){this.isManage=t,this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.activeRange=null,this.page=1,this.cancelAll(),this.getItems()},filterItems(t){switch(t){case"range":this.$refs.selectRangePopover.showPopper=!1,this.filterParams.codeNameGeq=this.orderMin,this.filterParams.codeNameLeq=this.orderMax;break;case"dispatch":return this.checkedSupplier=[],this.checkAll=!1,void(1==this.dispatchStatus?(this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.getItems()):2==this.dispatchStatus&&this.supplierList.forEach(t=>{"999e"==t.id&&this.changeSupplierTag(t)}));case"store":break;case"date":if(this.filterDate=[],this.dateFrom="",this.dateTo="",6==this.timeFilter)return;break;case"fulfill":break;case"sort":break;case"activeRange":this.warningDialog.orderEnd="",this.warningDialog.orderStart="";break;default:break}this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.activeRange=null,this.cancelAll(),1==this.page?this.getItems("range"==t&&(this.filterParams.codeNameGeq||this.filterParams.codeNameLeq)):this.$router.push({query:{page:1}})},getCodeName(){this.codeName&&(this.cancelAll(),window.lazycodeName&&window.clearTimeout(window.lazycodeName),window.lazycodeName=setTimeout(()=>{this.checked=!1,this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.page=1,this.activeRange=null,this.getItems()},400))},clearFilterItems(t){switch((this.$route.params.id||"999e"==this.$route.params.vid)&&window.location.reload(),t){case"range":this.$refs.selectRangePopover.showPopper=!1,this.orderMin=this.orderMax=this.filterParams.codeNameGeq=this.filterParams.codeNameLeq=void 0;break;case"dispatch":this.dispatchStatus="",this.checkedSupplier=[],this.isIndeterminate=!1;break;case"store":this.shopifyStore=[];break;case"date":this.timeFilter="",this.filterDate=[],this.dateFrom="",this.dateTo="";break;case"fulfill":this.fulfillStatus=[];break;case"sort":this.sortBy="";break;case"warningDialog-page":this.warningDialog.page=null;break;default:this.codeName="",this.timeFilter="",this.filterDate=[],this.dateFrom="",this.dateTo="",this.sortBy="",this.fulfillStatus=[];break}this.dynamicTags=[],this.selectData=[],this.expandedKeys=[],this.expandAll=!1,this.checked=!1,this.$refs.treeData.setCheckedKeys([]),this.activeRange=null,this.isShowFilter,this.cancelAll(),1==this.page?this.getItems():this.$router.push({query:{page:1}})},expandChange(){this.tableData.length||reutrn,this.$showLoading(),this.expandAll=!this.expandAll,this.$nextTick(()=>{let t=this.$refs.treeData.store.nodesMap;for(var e in t)t[e].expanded=this.expandAll;this.$hideLoading()})},gotoInvoice(t){let e=this.$router.resolve({path:"/i/"+t.uniCode});window.open(e.href,"_blank")},handleCheckChange(t,e,i){if(e)t.items?t.items.forEach(t=>{this.selectSku.push(t.id)}):this.selectSku.push(t.id);else if(t.items)for(let s=0;s<this.selectSku.length;s++)t.items.some(t=>{if(t.id==this.selectSku[s])return!0})&&(this.selectSku.splice(s,1),s--);else this.selectSku.forEach((e,i)=>{e==t.id&&this.selectSku.splice(i,1)});this.selectSku=[...new Set(this.selectSku)]},handleCheck(t,e){if(t){let t=this.$refs.treeData.getCheckedNodes().concat(this.$refs.treeData.getHalfCheckedNodes()),e=[],i=[];t.forEach(t=>{t.items&&e.push(t.id)}),this.tableData.forEach(t=>{e.some(e=>{if(e==t.id)return!0})||i.push(t.id)}),e.forEach(t=>{this.selectOrder.push(t)}),console.log(i);for(let s=0;s<this.selectOrder.length;s++)i.some(t=>{if(t==this.selectOrder[s])return!0})&&(this.selectOrder.splice(s,1),s--);this.selectOrder=[...new Set(this.selectOrder)]}this.$refs.treeData.getCheckedKeys();const i=this.$refs.treeData.getHalfCheckedNodes();this.selectData=[];let s=this.$refs.treeData.getCheckedNodes().concat(i);s.forEach(t=>{t.items&&this.selectData.push(t.id)}),this.selectDataNoHalf=this.selectData},changeAllCheck(t){this.checkLoading=!0;let e=0;this.tableData.length&&this.tableData.forEach(t=>{e++}),this.tableData.length==e&&setTimeout(()=>{this.checkLoading=!1},1600),setTimeout(()=>{this.defaultChecked=[];if(t){let t=[];this.tableData.length&&this.tableData.forEach(e=>{t.push(e.id),this.defaultChecked.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})}),this.$refs.treeData.setCheckedKeys(t)}else this.$refs.treeData.setCheckedKeys([]);this.handleCheck()},600)},checkedAll(){if(this.tableData.length){if(this.isCheckAll=this.isAll1,this.defaultChecked=[],this.isCheckAll){let t=[];this.tableData.forEach(e=>{t.push(e.id),this.selectOrder.push(e.id),this.defaultChecked.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})}),this.$refs.treeData.setCheckedKeys(t)}else{for(let t=0;t<this.selectOrder.length;t++)this.tableData.some(e=>{if(e.id==this.selectOrder[t])return!0})&&(this.selectOrder.splice(t,1),t--);this.$refs.treeData.setCheckedKeys([])}this.selectOrder=[...new Set(this.selectOrder)],this.handleCheck()}},handleExpandChange(t,e,i){},getPageSku(){let t=this.$refs.treeData.getCheckedNodes().concat(this.$refs.treeData.getHalfCheckedNodes());t.forEach(t=>{t.items?this.selectOrder.push(t.id):this.selectSku.push(t.id)}),this.tableData.forEach(t=>{t.items&&(t.items.forEach(t=>{this.allSku.push(t.id)}),this.allOrder.push(t.id))}),this.selectSku=[...new Set(this.selectSku)],this.allSku=[...new Set(this.allSku)],this.selectOrder=[...new Set(this.selectOrder)],this.allOrder=[...new Set(this.allOrder)]},getItems(t){this.loading=!0,this.getPageSku(),this.tableData=[],this.tableDataTab1=[];let e={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,keywords:this.codeName,isManage:this.isManage,accountId:this.storeId,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq)};this.$apiCall("api.Invoice.shopifyOrdersByVendor",e,e=>{if("9999"==e.ErrorCode){this.tableData=[],this.tableDataTab1=[],this.totalPage=e.Data.Pagination.totalPage,this.totalCount=e.Data.Pagination.totalCount;let i=e.Data.Results;this.warningDialog.page&&this.warningDialog.page<=this.page&&Number(this.warningDialog.orders!=this.rowsPerPage)&&(i=i.slice(0,Number(this.warningDialog.orders)%this.rowsPerPage)),i.forEach(t=>{this.$set(t,"shippingJson",JSON.parse(t.shippingJson)),this.$set(t,"span",!0),this.$set(t,"isShow",!0),t.items.length&&t.items.forEach(t=>{this.$set(t,"previewList",[]),this.$set(t,"disabled",0==t.unfulfillQuantity),t.imgUrl&&t.previewList.push(t.imgUrl)}),this.tableData.push(t),this.tableDataTab1.push(t)});const s=this.$refs.treeData?this.$refs.treeData.store.nodesMap:"";if(s)for(let t in s)s[t].expanded=!1;this.$nextTick(()=>{this.loading=!1,this.$hideLoading()}),t&&(this.allOrder=[],this.isCancelAll=!0,this.tableData.forEach(t=>{t.items&&t.items.forEach(t=>{this.selectSku.push(t.id)})}),this.selectSku=[...new Set(this.selectSku)],this.$refs.treeData.setCheckedKeys(this.selectSku)),this.isCancelAll&&(this.tableData.forEach(t=>{t.items&&t.items.forEach(t=>{this.allSku.some(e=>{if(e==t.id)return!0})||this.selectSku.push(t.id)})}),this.selectSku=[...new Set(this.selectSku)]),this.$refs.treeData.setCheckedKeys(this.selectSku),this.$nextTick(()=>{if(this.getPageSku(),this.expandAll){console.log(this.$refs.treeData.store.root);for(let t=0;t<this.$refs.treeData.store.root.childNodes.length;t++)this.$refs.treeData.store.root.childNodes[t].expanded=!0}})}else this.$elementMessage(e.Message,"error"),"1002"!=e.ErrorCode&&"1003"!=e.ErrorCode||this.$userFailure()})},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t}}):this.getItems()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem("importPerPage",t),this.gotoPage()},gotoPage(){this.storeId&&(this.page=this.$route.query.page?this.$route.query.page:1,this.getItems(),this.selectData=[],this.$refs.treeData.setCheckedKeys([]))},load(t,e){if(t>e)return void setTimeout(()=>{let t=[];if(this.tableData.length){if(this.tableData.forEach((e,i)=>{e.items&&e.items.length&&e.items.forEach((e,i)=>{t.push(e)})}),this.supplierList=this.buildArrayGroup(t),this.supplierList.forEach((t,e)=>{if(!t.id){this.$set(t,"id","999e"),this.$set(t,"vendorName","Unbound vendors");let i=t;this.supplierList.splice(e,1),this.supplierList.unshift(i)}}),"999e"==this.$route.params.vid&&(this.dispatchStatus=2),this.$route.params.id&&(this.checkedSupplier=[],this.dispatchStatus=3,this.supplierList.forEach(t=>{this.$route.params.id==t.id&&this.checkedSupplier.push(this.$route.params.id)})),2==this.dispatchStatus)this.supplierList.forEach(t=>{"999e"==t.id&&this.changeSupplierTag(t)});else if(3==this.dispatchStatus)if(0==this.checkedSupplier.length)this.tableData=[];else if(1==this.checkedSupplier.length)this.supplierList.forEach(t=>{t.id==this.checkedSupplier[0]&&this.changeSupplierTag(t)});else{let t=[];this.checkedSupplier.forEach(e=>{this.supplierList.forEach(i=>{e==i.id&&i.listInfo.length&&i.listInfo.forEach(e=>{t.push(e.id),e.items&&e.items.length&&e.items.forEach(e=>{t.push(e.id)})})})}),this.tableData=this.tableDataTab1;let e=JSON.parse(JSON.stringify(this.tableDataTab1));e.forEach((t,i)=>{e[i].items=[]}),t.length&&(t.forEach(t=>{this.tableData.forEach((i,s)=>{i.items.forEach((i,a)=>{t==i.id&&e[s].items.push(i)})})}),this.tableData=[],e.forEach((t,e)=>{t.items.length>0&&this.tableData.push(t)}))}}else this.supplierList=[];this.loading=!1},300);let i={page:this.page,rowsPerPage:this.rowsPerPage,timeFilter:this.timeFilter>=6?"":this.timeFilter,dateFrom:this.dateFrom,dateTo:this.dateTo,sort:this.sortBy,fulfillmentStatus:this.fulfillStatus,keywords:this.codeName,isManage:this.isManage,accountId:this.storeId,codeNameGeq:this.formatCode(this.filterParams.codeNameGeq),codeNameLeq:this.formatCode(this.filterParams.codeNameLeq)};this.$apiCall("api.Invoice.shopifyOrdersByVendor",i,t=>{if("9999"==t.ErrorCode){let e=t.Data.Results;e.forEach((t,e)=>{this.$set(t,"shippingJson",JSON.parse(t.shippingJson)),this.$set(t,"span",!0),this.$set(t,"isShow",!0),t.items.length&&t.items.forEach(t=>{this.$set(t,"previewList",[]),t.imgUrl&&t.previewList.push(t.imgUrl)}),this.tableData.push(t),this.tableDataTab1.push(t)}),this.warningDialog.page?(this.warningDialog.orders<this.tableData.length&&(this.tableData=this.tableData.slice(0,this.warningDialog.orders)),this.warningDialog.page>this.page?(this.page++,this.load(this.page,this.totalPage)):this.$nextTick(()=>{this.loading=!1,this.$hideLoading()})):(this.page++,this.load(this.page,this.totalPage))}else this.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||this.$userFailure(this)})},buildArrayGroup(t){let e=[];for(let i of t){let t=i.relationshipId,s=i.vendorName,a=e.findIndex(e=>e.relationshipId===t),r=-1!==a?e[a]:{};if(0===Object.keys(r).length){let a=[];a.push(i),r["relationshipId"]=t,r["vendorName"]=s,r["listInfo"]=a,e.push(r)}else{let t=e[a]||{},s=t["listInfo"];s.push(i)}}return e.forEach(t=>{this.$set(t,"id",t.relationshipId)}),e},groupBySupplier(t){for(var e={},i=[],s=0;s<t.length;s++){var a=t[s];if(e[a.relationshipId])for(var r=0;r<i.length;r++){var o=i[r];if(o.relationshipId==a.relationshipId){o.listInfo.push(a);break}}else i.push({id:a.relationshipId,vendorName:a.vendorName,listInfo:[a]}),e[a.relationshipId]=a}return i},groupBy(t){for(var e={},i=[],s=0;s<t.length;s++){var a=t[s];if(e[a.shopifyAccountId])for(var r=0;r<i.length;r++){var o=i[r];if(o.shopifyAccountId==a.shopifyAccountId){o.listInfo.push(a);break}}else i.push({shopifyAccountId:a.shopifyAccountId,store:a.store,listInfo:[a]}),e[a.shopifyAccountId]=a}return i},formatminute(t){return this.$moment.duration(t/60,"minutes").locale("en").humanize()},onCopy(t){this.$elementMessage(this.$t("successfullyToClipboard"),"success")},onError(t){this.$elementMessage(this.$t("failedToClipboard"),"error")},updateOrder(){this.updateOrderLoading=!0,this.$apiCall("api.ShopifyAccount.getOrderByHand",{},t=>{this.updateOrderLoading=!1,"9999"==t.ErrorCode?(this.updateTime=t.Data.Results,localStorage.setItem("orders-updateTime",t.Data.Results),this.$elementMessage("Update Order Success","success")):this.$elementMessage(t.Message,"error")})}}},n=l,d=(i("812b"),i("faf6"),i("9c5d"),i("2877")),c=Object(d["a"])(n,s,a,!1,null,"e4b3ba72",null);e["default"]=c.exports},"976d":function(t,e,i){},"9c5d":function(t,e,i){"use strict";i("ca3e")},ca3e:function(t,e,i){},d603:function(t,e,i){"use strict";i("d73a")},d73a:function(t,e,i){},faf6:function(t,e,i){"use strict";i("976d")}}]);