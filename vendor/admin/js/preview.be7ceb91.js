(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["preview"],{3901:function(t,e,i){"use strict";var a=i("6dd3"),s=i("9699"),o=i("4a15"),n=i("14b4"),l=i("9801"),r=i("03e9"),c=i("1de0"),d=i("521d"),p=i("1657"),g=i("3d1e"),m=i("9b46"),u=i("906c"),v=m("slice"),f=g("species"),h=s.Array,y=Math.max;a({target:"Array",proto:!0,forced:!v},{slice:function(t,e){var i,a,s,g=d(this),m=c(g),v=r(t,m),C=r(void 0===e?m:e,m);if(o(g)&&(i=g.constructor,n(i)&&(i===h||o(i.prototype))?i=void 0:l(i)&&(i=i[f],null===i&&(i=void 0)),i===h||void 0===i))return u(g,v,C);for(a=new(void 0===i?h:i)(y(C-v,0)),s=0;v<C;v++,s++)v in g&&p(a,s,g[v]);return a.length=s,a}})},4788:function(t,e,i){"use strict";i("d2a5")},a64c:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-scrollbar",{ref:"myScrollbar",staticClass:"page-content"},[i("div",{staticClass:"invoice"},[i("el-container",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],class:t.noMore||5==t.tabActive?"":"pd-b-100",attrs:{"infinite-scroll-distance":800,"infinite-scroll-disabled":"disabled"}},[i("el-main",[i("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"always"}},[i("el-steps",{attrs:{active:2,"process-status":"wait"}},[i("el-step",{attrs:{title:"步骤1",icon:"el-icon-success",description:"这是一段很长很长很长的描述性文字"}}),i("el-step",{attrs:{title:"步骤2",description:"这是一段很长很长很长的描述性文字"}}),i("el-step",{attrs:{title:"步骤3",description:"这是一段很长很长很长的描述性文字"}}),i("el-step",{attrs:{title:"步骤4",description:"这是一段很长很长很长的描述性文字"}})],1)],1),i("el-card",{attrs:{shadow:"always"}},[i("el-row",{staticStyle:{"margin-top":"25px","align-items":"flex-start"},attrs:{type:"flex"}},[i("el-col",{attrs:{span:12}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"grid-content invoice-header-logo"})]),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content invoice-header-info"},[i("div",{staticClass:"wv-heading-title"},[t._v("INVOICE")]),[i("div",{staticClass:"wv-text-strong"},[t._v(" "+t._s(t.invoiceInfo.vendorName?t.invoiceInfo.vendorName:"---")+" ")])]],2)])],1),i("el-divider"),i("el-row",{attrs:{type:"flex",align:"middle"}},[i("el-col",{attrs:{span:12}},[i("div",{staticClass:"grid-content invoice-metadata-custome tx-left pos-relative"},[i("div",[t._v(" BILL To "),i("br"),[i("span",{staticClass:"wv-text-strong",staticStyle:{cursor:"pointer"}},[t._v(t._s(t.invoiceInfo.customerName?t.invoiceInfo.customerName:"---"))])]],2),i("div",{staticClass:"change-customer"})])]),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"invoice-metadata-info mg-b-20"},[i("div",{staticClass:"text-right"},[i("p",[t._v("Invoice Number :")]),i("p",{staticClass:"mg-y-10"},[t._v("Invoice Date :")]),i("p",{staticClass:"text-bg"},[t._v("Amount Due (US$) :")])]),i("div",{staticClass:"text-left"},[i("p",[t._v("# "+t._s(t.invoiceInfo.code?t.invoiceInfo.code:"---"))]),i("p",{staticClass:"mg-y-10"},[t._v(t._s(t.invoiceInfo.timeCreated?t.invoiceInfo.timeCreated:"---"))]),i("p",{staticClass:"wv-text-strong text-bg",staticStyle:{"padding-left":"0"}},[t._v("$ "+t._s(t.realAmount?t.$numberToCurrency(t.realAmount):"0.00"))])])])])],1),5!=t.tabActive?[i("div",{staticClass:"table-wrap"},[i("el-table",{staticClass:"table-only",attrs:{"header-cell-style":t.getRowClass,"cell-style":t.cellStyle}},[i("el-table-column",{attrs:{label:"Items"}}),i("el-table-column",{attrs:{label:"Quantity",width:"160"}}),i("el-table-column",{attrs:{label:"Unit Cost(US$)",width:"120"}}),i("el-table-column",{attrs:{label:"Subtotal(US$)",width:"120"}})],1),i("el-table",{staticClass:"table-with-body",attrs:{"row-class-name":t.tableRowClassName,"header-cell-style":t.getRowClass,"cell-style":t.cellStyle,data:t.invoiceData,stripe:"",border:""}},[i("el-table-column",{attrs:{label:"Items"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{},[i("div",{staticStyle:{"max-width":"100%","text-align":"left"}},[i("div",{staticClass:"tx-600"},[t._v(" "+t._s(e.row.name)+" ")]),2!=t.tabActive?i("div",{staticClass:"d-flex no-wrap justify-content-between"},[i("el-popover",{attrs:{"popper-class":"customer-popover",placement:"bottom",title:"Shopify Order "+e.row.codeName,width:"500",trigger:"hover"}},[i("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(e.row.codeName)),i("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),i("div",{staticClass:"mg-y-15 mg-t-20"},[i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"120px","text-align":"right",color:"#999"}},[t._v("Order Date :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(e.row.timeCreated))])])]),i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"120px","text-align":"right",color:"#999"}},[t._v("Customer :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(e.row.shippingJson&&e.row.shippingJson.name?e.row.shippingJson.name:"---"))])])]),i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"120px","text-align":"right",color:"#999"}},[t._v("Shipping Address :")]),i("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{"max-width":"75%"}},[t._v(" "+t._s(e.row.shippingJson&&e.row.shippingJson.zip?e.row.shippingJson.zip:"---")+" "+t._s(e.row.shippingJson&&e.row.shippingJson.address1?e.row.shippingJson.address1:"---")+" "+t._s(e.row.shippingJson&&e.row.shippingJson.city?e.row.shippingJson.city:"---")+" "+t._s(e.row.shippingJson&&e.row.shippingJson.province?e.row.shippingJson.province:"---")+" ")])])]),i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"120px","text-align":"right",color:"#999"}}),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(e.row.shippingJson&&e.row.shippingJson.country?e.row.shippingJson.country:"---"))])])]),i("div",{staticClass:"d-flex"},[i("div",{staticClass:"d-flex",staticStyle:{width:"90%"}},[i("div",{staticStyle:{width:"120px","text-align":"right",color:"#999"}},[t._v("Email：")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(e.row.email))])])])])]),i("div",{staticStyle:{width:"50px"}}),i("div",{staticClass:"no-wrap"},[e.row.trackNumber?i("div",{staticClass:"d-flex"},[i("div",[t._v(" "+t._s(e.row.trackCompany)+" "+t._s(e.row.trackNumber)+" ")]),2==e.row.syncStatus?i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v("供应商已发货，但物流信息未同步到Shopify店铺。"),i("br"),t._v("原因：客户未授权该订单对应的Shopify账号。")]),i("i",{staticClass:"iconfont icon-tongbu1 mg-l-10",staticStyle:{color:"#E6A23C","font-size":"18px"}})]):i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"供应商已发货，物流信息已同步到Shopify店铺。",placement:"right"}},[i("i",{staticClass:"iconfont icon-tongbu1 mg-l-10",staticStyle:{color:"#67C23A","font-size":"20px"}})])],1):1==e.row.fulfillStatus?i("div",[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"This item hasn't been shipped yet.",placement:"right"}},[i("el-alert",{attrs:{title:"Not shipped",type:"warning",closable:!1}})],1)],1):i("div",[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Reason："+e.row.stopReason,placement:"right"}},[i("el-alert",{attrs:{title:"Can't shipment",type:"error",closable:!1}})],1)],1)])],1):t._e()])])]}}],null,!1,320709396)}),i("el-table-column",{attrs:{prop:"qty",label:"Quantity",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[2!=t.tabActive?[1==t.invoiceInfo.payStatus?[i("el-input-number",{attrs:{disabled:1==t.preview,size:"small",min:0},on:{change:function(i){return t.handleChange(e.row,i)}},model:{value:e.row.quantity,callback:function(i){t.$set(e.row,"quantity",i)},expression:"scope.row.quantity"}})]:t._e(),2==t.invoiceInfo.payStatus?[i("el-input-number",{attrs:{disabled:1==t.preview,size:"small",min:0},on:{change:function(i){return t.handleChange(e.row,i)}},model:{value:e.row.quantity,callback:function(i){t.$set(e.row,"quantity",i)},expression:"scope.row.quantity"}})]:t._e()]:t._e(),2==t.tabActive?i("span",[t._v(t._s(e.row.quantity))]):t._e()]}}],null,!1,486726724)}),i("el-table-column",{attrs:{prop:"price",label:"Unit Cost(US$)",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[2!=t.tabActive?i("div",[i("div",[t._v(" "+t._s(e.row.price)+" ")])]):t._e(),2==t.tabActive?i("div",[t._v(" "+t._s(e.row.price)+" ")]):t._e()]}}],null,!1,2353231076)}),i("el-table-column",{attrs:{label:"Subtotal(US$)",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$numberToCurrency(e.row.amount))+" ")]}}],null,!1,570403819)})],1)],1),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"page-footer mg-t-30 mg-b-10",staticStyle:{"min-height":"50px","z-index":"0"}},[i("el-row",{directives:[{name:"show",rawName:"v-show",value:t.noMore,expression:"noMore"}]},[i("el-col",{attrs:{span:20,offset:4}},[i("div",{staticClass:"grid-content invoice-bottom"},[i("div",{staticClass:"d-flex justify-content-end mg-b-10"},[i("div",{},[t._v("Items total (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(t.$numberToCurrency(t.itemAmount)))])]),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{},[t._v("Shipping total (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(t.$numberToCurrency(t.shippingAmount))+" ")])]),i("el-divider"),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{},[t._v("Subtotal (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(t.$numberToCurrency(t.totalAmount)))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.discount>0,expression:"discount>0"}],staticClass:"d-flex justify-content-end mg-t-10"},[i("div",{},[t._v("Discount (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{color:"rgb(103, 194, 58)"}},[t._v("- "+t._s(t.$numberToCurrency(t.discount)))])]),i("div",{staticClass:"d-flex justify-content-end mg-t-10 bold-input"},[i("div",{staticClass:"tx-bold"},[t._v("Amount Due (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v(" "+t._s(t.$numberToCurrency(t.realAmount))+" ")])]),i("div",{staticClass:"d-flex justify-content-end mg-t-10",staticStyle:{"align-items":"flex-start"}},[i("div",{},[t._v("Payment :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(1==t.paymentType?"Transfer by bank or PayPal":"AliExpress")+" ")])]),2==t.paymentType?i("div",{staticClass:"mg-t-10 normal-input pd-r-15",staticStyle:{"text-align":"right"}},[i("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("As the vendor's setting, you can go to Aliexpress to buy the item in the vendor's store to finish the payment.")]),i("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(e){return t.openPayUrl(t.payUrl)}}},[t._v("Go to AliExpress NOW")])],1):t._e()],1),1==t.invoiceInfo.paymentType||2==t.invoiceInfo.paymentType?[1==t.invoiceInfo.payStatus?i("div",{staticClass:"tx-right mg-t-15"},[i("span",[i("el-alert",{staticStyle:{display:"inline"},attrs:{title:"The vender has confirmed the payment.",type:"success",closable:!1}})],1)]):t._e()]:t._e()],2)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.noMore,expression:"!noMore"}],staticClass:"page-footer-fixed"},[i("div",{staticStyle:{width:"1030px",margin:"0 auto"}},[i("div",{staticClass:"without-hover"},[i("el-row",{staticStyle:{margin:"20px 15px 10px -15px"}},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"d-flex justify-content-end"},[i("div",{staticClass:"tx-bold"},[t._v("Amount Due (US$) :")]),i("div",{staticClass:"mg-l-5",staticStyle:{"font-weight":"bold","font-size":"16px!important"}},[t._v(" "+t._s(t.$numberToCurrency(t.realAmount))+" ")])])])],1)],1),i("div",{staticClass:"with-hover"},[i("el-row",{staticStyle:{margin:"10px 15px 10px -15px"}},[i("el-col",{attrs:{span:8}},[i("div",[i("el-button",{attrs:{size:"medium",plain:"",type:"primary",icon:"el-icon-printer"}},[t._v("Print")])],1)]),i("el-col",{attrs:{span:16}},[i("div",{staticClass:"grid-content invoice-bottom"},[i("div",{staticClass:"d-flex justify-content-end mg-b-10"},[i("div",{},[t._v("Items total (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(t.$numberToCurrency(t.itemAmount)))])]),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{},[t._v("Shipping total (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(t.$numberToCurrency(t.shippingAmount))+" ")])]),i("el-divider"),i("div",{staticClass:"d-flex justify-content-end"},[i("div",{},[t._v("Subtotal (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(t._s(t.$numberToCurrency(t.totalAmount)))])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.discount>0,expression:"discount>0"}],staticClass:"d-flex justify-content-end mg-t-10"},[i("div",{},[t._v("Discount (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{color:"rgb(103, 194, 58)"}},[t._v("- "+t._s(t.$numberToCurrency(t.discount)))])]),i("div",{staticClass:"d-flex justify-content-end mg-t-10 bold-input"},[i("div",{staticClass:"tx-bold"},[t._v("Amount Due (US$) :")]),i("div",{staticClass:"mg-l-5 pd-r-15",staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v(" "+t._s(t.$numberToCurrency(t.realAmount))+" ")])]),i("div",{staticClass:"d-flex justify-content-end mg-t-10",staticStyle:{"align-items":"flex-start"}},[i("div",{},[t._v("Payment :")]),i("div",{staticClass:"mg-l-5 pd-r-15"},[t._v(" "+t._s(1==t.paymentType?"Transfer by bank or PayPal":"AliExpress")+" ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:2==t.paymentType,expression:"paymentType == 2"}],staticClass:"mg-t-10 normal-input pd-r-15",staticStyle:{"text-align":"right"}},[i("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("As the vendor's setting, you can go to Aliexpress to buy the item in the vendor's store to finish the payment.")]),i("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(e){return t.openPayUrl(t.payUrl)}}},[t._v("Go to AliExpress NOW")])],1)],1),i("div",{staticClass:"tx-right mg-t-20"},[1==t.invoiceInfo.paymentType||2==t.invoiceInfo.paymentType?[1==t.invoiceInfo.payStatus?i("span",[i("el-alert",{staticStyle:{display:"inline"},attrs:{title:"The vender has confirmed the payment.",type:"success",closable:!1}})],1):t._e()]:t._e()],2)])],1)],1)])])]:t._e()],2)],1),i("el-aside",{staticStyle:{position:"relative",left:"50px"},attrs:{width:"50px"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Download & Upload",placement:"right"}},[i("el-button",{staticStyle:{position:"fixed",bottom:"260px",width:"40px",height:"40px","line-height":"40px","text-align":"center",padding:"0","z-index":"1"},attrs:{size:"medium",circle:"",type:"primary"}},[i("i",{staticClass:"iconfont icon-xiazai",staticStyle:{"margin-right":"0","font-size":"22px"}})])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Statistics",placement:"right"}},[i("el-button",{staticStyle:{"margin-left":"0",position:"fixed",bottom:"200px",width:"40px",height:"40px","line-height":"40px","text-align":"center",padding:"0","z-index":"1"},attrs:{size:"medium",circle:"",type:"primary"},on:{click:function(e){t.drawer=!0}}},[i("i",{staticClass:"fa fa-bar-chart",staticStyle:{"margin-right":"0"}})])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Help",placement:"right"}},[i("el-button",{staticStyle:{"margin-left":"0",position:"fixed",bottom:"140px",width:"40px",height:"40px","line-height":"40px","text-align":"center",padding:"0","z-index":"1"},attrs:{size:"medium",circle:"",type:"primary"}},[i("i",{staticClass:"fa fa-question-circle-o",staticStyle:{"margin-right":"0","font-size":"20px"}})])],1),i("el-backtop",{staticStyle:{right:"auto",bottom:"80px","z-index":"1"},attrs:{target:".el-scrollbar__wrap"}})],1)],1),i("el-container",{directives:[{name:"show",rawName:"v-show",value:5!=t.tabActive&&t.noMore||5==t.tabActive,expression:"(tabActive != 5 && noMore) || tabActive == 5"}],attrs:{id:"messageContainer"}},[i("el-main",[i("div",{staticClass:"d-flex justify-content-between mg-b-20 pd-x-20"},[i("span",{staticClass:"tx-16 tx-600"},[t._v("Timeline")]),i("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("Show comments")])],1),i("el-divider"),i("el-row",{attrs:{gutter:30}},[i("el-col",{attrs:{span:12}},[t.currentPageDataLog.length?i("el-timeline",[t._l(t.currentPageDataLog,(function(e){return[i("el-timeline-item",[t._v(" "+t._s(e.date)+" ")]),t._l(e.listInfo,(function(e,a){return i("el-timeline-item",{attrs:{color:"#5c6ac4"}},[i("div",{staticClass:"d-flex justify-content-between",staticStyle:{"align-items":"flex-start"}},[i("span",[t._v(t._s(e.content))]),i("span",{staticStyle:{"white-space":"nowrap","margin-left":"10px",color:"#999"}},[t._v(t._s(e.datetime))])])])}))]}))],2):i("p",{staticClass:"tx-center"},[t._v("No more data")])],1),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"mg-b-15",class:1==t.preview?"with-preview":"",staticStyle:{"margin-left":"40px",position:"relative",background:"#fff",border:"1px solid #ddd",padding:"10px"}},[i("ul",{staticClass:"figure-list"},t._l(t.fileList,(function(e,a){return i("li",[i("figure",{style:{backgroundImage:"url("+e.url+")",backgroundSize:"cover"}},[i("a",{attrs:{href:"#"}}),i("a",{staticClass:"btn",attrs:{href:"#"},on:{click:function(e){return t.removeMsgImg(a)}}},[i("i",{staticClass:"el-icon-close"})])])])})),0),i("el-input",{staticClass:"input-with-select",staticStyle:{border:"none"},attrs:{size:"medium",placeholder:"Please leave your message",type:"textarea",autosize:"",resize:"none"},model:{value:t.msgContent,callback:function(e){t.msgContent=e},expression:"msgContent"}}),i("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end",position:"absolute",bottom:"10px",right:"10px"}},[i("i",{staticClass:"fa fa-smile-o",staticStyle:{"font-size":"20px",margin:"0 10px"},attrs:{slot:"suffix"},slot:"suffix"}),i("el-upload",{staticClass:"upload-demo",attrs:{action:"","show-file-list":!1,"http-request":t.uploadSectionFile2}},[i("i",{staticClass:"fa fa-paperclip",staticStyle:{"font-size":"20px",margin:"0 10px"}})]),i("el-button",{attrs:{slot:"append",size:"small"},on:{click:t.addMessage},slot:"append"},[t._v("Send")])],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"checked"}]},[t.currentmessages.length?i("el-timeline",[t._l(t.currentmessages,(function(e){return[i("el-timeline-item",[t._v(" "+t._s(e.date)+" ")]),t._l(e.listInfo,(function(e,a){return[1==e.type?i("el-timeline-item",{attrs:{color:"#5c6ac4",timestamp:e.datetime,placement:"top"}},[i("el-card",[i("div",{staticClass:"d-flex timeline-customer"},[i("el-avatar",{attrs:{size:40}},[t._v(" "+t._s(e.cname)+" ")]),i("div",{staticClass:"mg-l-10"},[i("h4",[t._v(t._s(e.customerName)+" ")]),i("p",{staticClass:" mg-t-5"},[t._v(t._s(e.content))])])],1)])],1):t._e(),2==e.type?i("el-timeline-item",{attrs:{color:"#5c6ac4",timestamp:e.datetime,placement:"top"}},[i("el-card",{attrs:{"body-style":{background:"#9eea6a"}}},[i("div",{staticClass:"d-flex justify-content-end tx-right timeline-self"},[i("div",{staticClass:"mg-r-10"},[i("h4",[t._v(t._s(e.vendorName))]),i("p",{staticClass:" mg-t-5"},[t._v(t._s(e.content))]),e.imgJson?i("p",{staticClass:"mg-t-10"},t._l(e.imgJson,(function(t){return i("img",{staticClass:"mg-l-10",attrs:{src:t,width:"60"}})})),0):t._e()]),i("el-avatar",{attrs:{size:40}},[t._v(" "+t._s(e.vname)+" ")])],1)])],1):t._e()]}))]}))],2):i("p",{staticClass:"tx-center"},[t._v("No more comment")])],1)])],1)],1),i("el-aside",{attrs:{width:"50px"}})],1),i("el-dialog",{attrs:{title:"发票预览","custom-class":"previewTip",visible:t.previewTipOpen,width:"50%","close-on-click-modal":!1},on:{"update:visible":function(e){t.previewTipOpen=e}}},[i("el-divider"),i("div",[i("h2",{staticStyle:{"font-size":"16px","font-weight":"bold",margin:"30px 20px","text-align":"center"}},[t._v("当前发票页面仅供预览，如果发送给客户请使用发票编辑页面的“发送发票”功能！")])]),i("div",{staticClass:"d-flex",staticStyle:{"justify-content":"space-around",margin:"20px"}},[i("div",{staticStyle:{width:"48%","margin-right":"2%"}},[i("p",{staticClass:"mg-y-10"},[t._v("如图一所示：页面顶部“发送发票”按钮")]),i("img",{staticStyle:{"box-shadow":"0 2px 12px 0 rgba(0,0,0,.1)"},attrs:{width:"100%",src:"images/url2-2.png"}})]),i("div",{staticStyle:{width:"48%","margin-left":"2%"}},[i("p",{staticClass:"mg-y-10"},[t._v("如图二所示：页面底部“发送发票”按钮")]),i("img",{staticStyle:{"box-shadow":"0 2px 12px 0 rgba(0,0,0,.1)"},attrs:{width:"100%",src:"images/url2-1.png"}})])]),i("el-divider"),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.previewTipOpen=!1}}},[t._v("我知道了")])],1)],1),i("el-drawer",{attrs:{title:"我是标题",visible:t.drawer,"with-header":!1},on:{"update:visible":function(e){t.drawer=e}}},[i("el-scrollbar",[i("h2",{staticStyle:{padding:"20px","font-size":"24px"}},[t._v("数据统计：")]),i("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("采购订单基础信息")])]),i("div",{staticStyle:{"margin-top":"-30px"}},[i("el-form",{attrs:{"label-position":"right","label-width":"120px"}},[i("el-form-item",{attrs:{label:"订单总数："}},[t._v(" 212 个 ")]),i("el-form-item",{attrs:{label:"订单商品项："}},[t._v(" 22 种 ")]),i("el-form-item",{attrs:{label:"合计商品总数："}},[t._v(" 1219 件 ")]),i("el-form-item",{attrs:{label:"合计采购金额："}},[t._v(" US$ 152,233,698.65 ")])],1)],1)]),i("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("发货情况统计")])]),i("div",{staticStyle:{"margin-top":"-30px"}},[i("el-form",{attrs:{"label-position":"right","label-width":"120px"}},[i("el-form-item",{attrs:{label:"已发货商品数："}},[i("span",{staticClass:"tx-success"},[t._v("1212")]),t._v(" 件 ")]),i("el-form-item",{attrs:{label:"已发货商品额："}},[t._v(" US$ "),i("span",{staticClass:"tx-warning"},[t._v("212,963.99")])]),i("el-form-item",{attrs:{label:"未发货商品数："}},[i("span",{staticClass:"tx-warning"},[t._v("99")]),t._v(" 件 ")]),i("el-form-item",{attrs:{label:"未发货商品额："}},[t._v(" US$ "),i("span",{staticClass:"tx-warning"},[t._v("152,698.65")])]),i("el-form-item",{attrs:{label:"不发货商品数："}},[i("span",{staticClass:"tx-warning"},[t._v("12")]),t._v(" 件 ")]),i("el-form-item",{attrs:{label:"不发货商品额："}},[t._v(" US$ "),i("span",{staticClass:"tx-warning"},[t._v("96.78")])]),i("el-form-item",{attrs:{label:"发货率："}},[i("span",{staticClass:"tx-warning"},[t._v("21.6%")])])],1)],1)]),i("el-card",{staticClass:"box-card",attrs:{shadow:"never"}},[i("el-button",{attrs:{type:"primary",plain:""}},[t._v("导出到Excel")]),i("el-button",{attrs:{type:"success",plain:""}},[t._v("导出到Excel")])],1)],1)],1)],1)])},s=[],o=(i("0d8f"),i("0132"),i("39dd"),i("f433"),i("ba49"),i("3901"),i("2027"),i("6054"),i("fd2d"),{name:"invoice",data:function(){return{previewTipOpen:!1,payUrl:"",paymentType:"",msgContent:"",drawer:!1,alreadySet:!1,isCollapse:!0,customerName:"",checked:!0,count:20,loading:!1,pageLoading:!1,tabActive:1,imageUrl:"",page:1,totalPage:1,rowsPerPage:50,totalCount:0,type:"all",invoiceInfo:"",invoiceData:[],firstLoading:!0,invoiceCnt:"",getListFlag:!0,relationship:[],showLogo:!1,logoUrl:"",shippingAmount:"",itemAmount:"",totalAmount:"",realAmount:"",discount:"",operateLog:[],totalPageLog:1,currentPageLog:1,pageSizeLog:20,currentPageDataLog:[],getLogFlag:!0,messages:[],currentmessages:[],msgpage:1,msgtotalPage:1,msgrowsPerPage:20,msgtotalCount:0,getMsgFlag:!0,pack:"",fileList:[],uniCode:this.$route.query.uniCode?this.$route.query.uniCode:"",preview:this.$route.query.preview?this.$route.query.preview:""}},computed:{noMore:function(){return this.invoiceData.length==Number(this.totalCount)&&!this.loading},disabled:function(){return this.loading||this.noMore}},watch:{noMore:function(){this.noMore&&(this.getOperateLog(this.invoiceInfo.id),this.getMessages(this.invoiceInfo.id))},customerName:function(){this.changeCustomerName()}},mounted:function(){var t=this;this.getDataAll(),this.isCollapse=!0,this.$nextTick((function(){t.handleScroll()})),1==this.preview?this.previewTipOpen=!0:this.previewTipOpen=!1},destroyed:function(){},components:{},methods:{handleScroll:function(){var t=this,e=this.$refs.myScrollbar.wrap;$(".invoice .el-container:first-child").offset().top,$(".invoice .el-container:first-child").outerHeight();e.onscroll=function(){$(".el-popover").remove(),$(".el-scrollbar__wrap").scrollTop()+$(".el-scrollbar__wrap").height()>=$(".el-container:first-child").height()-10?t.noMore&&setTimeout((function(){$(".page-footer-fixed").css("display","none")}),300):setTimeout((function(){$(".page-footer-fixed").css("display","block")}),300),$(".el-scrollbar__wrap").scrollTop()+$(".el-scrollbar__wrap").height()>=$(".el-scrollbar__view").height()-100&&t.noMore&&setTimeout((function(){t.operateLog.length?t.nextPage():t.getOperateLog(t.invoiceInfo.id),t.getMessages(t.invoiceInfo.id)}),300)}},uploadSectionFile2:function(t){var e=this,i=t.file,a=i.size/1024/1024<.5;a?this.$apiCall("api.User.uploadImg",{"@file":i},(function(t){"9999"==t.ErrorCode?e.fileList.push({name:"test",url:t.Data.Results.imgUrl}):(e.pageLoading=!1,e.$elementMessage(t.Message,"error"))})):this.$message.error("上传图片大小不能超过 500kb!")},selectEmoji:function(t){console.log(t)},toFixed:function(t){if(t)return Number(t).toFixed(2)},onCopy:function(t){this.$elementMessage("已经成功复制到剪切板","success")},onError:function(t){this.$elementMessage("复制到剪切板失败，请手工复制","error")},load:function(){var t=this;if(this.invoiceInfo){var e=this.tabActive;this.getListFlag&&(this.page>this.totalPage||(this.loading=!0,this.getListFlag=!1,this.$apiCall("api.Invoice.getItemsByC",{uniCode:this.uniCode,invoiceId:this.invoiceInfo.id,type:this.type,page:this.page,rowsPerPage:this.rowsPerPage,preview:1==this.preview},(function(i){if(t.getListFlag=!0,t.loading=!1,"9999"==i.ErrorCode){t.totalPage=i.Data.Pagination.totalPage,t.totalCount=i.Data.Pagination.totalCount,i.Data.Results.forEach((function(e,i){t.invoiceData.push(e)})),t.page++;var a={data:t.invoiceData,page:t.page,totalPage:t.totalPage,totalCount:t.totalCount,loadAll:t.page>t.totalPage};1==e?sessionStorage.setItem("tabActiveAll",JSON.stringify(a)):2==e?sessionStorage.setItem("tabActiveSku",JSON.stringify(a)):3==e?sessionStorage.setItem("tabActiveNotBind",JSON.stringify(a)):4==e&&sessionStorage.setItem("tabActiveNotDeliver",JSON.stringify(a))}else t.$elementMessage(i.Message,"error")}))))}},getInvoiceData:function(t){var e=this;this.invoiceData=[];var i=this.tabActive;this.$showLoading(),this.$apiCall("api.Invoice.getItemsByC",{uniCode:this.uniCode,invoiceId:t,type:this.type,page:this.page,rowsPerPage:this.rowsPerPage,preview:1==this.preview},(function(t){if(e.$hideLoading(),"9999"==t.ErrorCode){e.totalPage=t.Data.Pagination.totalPage,e.totalCount=t.Data.Pagination.totalCount,1==e.totalPage&&(e.getOperateLog(e.invoiceInfo.id),e.getMessages(e.invoiceInfo.id)),t.Data.Results.forEach((function(t,i){e.invoiceData.push(t)})),e.page++;var a={data:e.invoiceData,page:e.page,totalPage:e.totalPage,totalCount:e.totalCount,loadAll:e.page>e.totalPage};1==i?sessionStorage.setItem("tabActiveAll",JSON.stringify(a)):2==i?sessionStorage.setItem("tabActiveSku",JSON.stringify(a)):3==i?sessionStorage.setItem("tabActiveNotBind",JSON.stringify(a)):4==i&&sessionStorage.setItem("tabActiveNotDeliver",JSON.stringify(a))}else e.$elementMessage(t.Message,"error")}))},getCnt:function(t){var e=this;this.$apiCall("api.Invoice.getItemsCntByC",{uniCode:this.uniCode,invoiceId:t,preview:1==this.preview},(function(t){"9999"==t.ErrorCode?e.invoiceCnt=t.Data.Results:e.$elementMessage(t.Message,"error")}))},groupBy:function(t){for(var e={},i=[],a=0;a<t.length;a++){var s=t[a];if(e[s.date])for(var o=0;o<i.length;o++){var n=i[o];if(n.date==s.date){n.listInfo.push(s);break}}else i.push({date:s.date,listInfo:[s]}),e[s.date]=s}return i},getOperateLog:function(t){var e=this;this.$apiCall("api.Invoice.getOperateLog",{invoiceId:t},(function(t){"9999"==t.ErrorCode?(e.operateLog=t.Data.Results,e.$moment().locale("en"),e.operateLog.forEach((function(t){e.$set(t,"date",e.$moment(t.time).format("MMMM Do")),e.$set(t,"datetime",e.$moment(t.time).format("h:mm a"))})),e.totalPageLog=Math.ceil(e.operateLog.length/e.pageSizeLog),e.totalPageLog=0==e.totalPageLog?1:e.totalPageLog,e.setCurrentPageData()):e.$elementMessage(t.Message,"error")}))},setCurrentPageData:function(){this.currentPageLog,this.pageSizeLog;var t=this.currentPageLog*this.pageSizeLog;this.currentPageDataLog=this.groupBy(this.operateLog.slice(0,t))},nextPage:function(){this.getLogFlag&&this.currentPageLog!=this.totalPageLog&&(this.getLogFlag=!1,this.currentPageLog++,this.setCurrentPageData(),this.getLogFlag=!0)},getMessages:function(t){var e=this;this.getMsgFlag&&(this.msgpage>this.msgtotalPage||(this.getMsgFlag=!1,this.$apiCall("api.Invoice.getMessages",{invoiceId:t,page:this.msgpage,rowsPerPage:this.msgrowsPerPage},(function(t){e.getMsgFlag=!0,"9999"==t.ErrorCode?(e.msgtotalPage=t.Data.Pagination.totalPage,e.msgtotalCount=t.Data.Pagination.totalCount,t.Data.Results.forEach((function(t,i){e.messages.push(t)})),e.$moment().locale("en"),e.messages.forEach((function(t){e.$set(t,"date",e.$moment(t.timeCreated).format("MMMM Do")),e.$set(t,"datetime",e.$moment(t.timeCreated).format("h:mm a")),e.$set(t,"vname",t.vendorName.substr(0,1)),e.$set(t,"cname",t.customerName.substr(0,1))})),e.currentmessages=e.groupBy(e.messages),e.msgpage++):e.$elementMessage(t.Message,"error")}))))},addMessage:function(){var t=this,e=[];this.fileList.length&&this.fileList.forEach((function(t){e.push(t.url)})),this.$apiCall("api.Invoice.addMessageByC",{uniCode:this.uniCode,invoiceId:this.invoiceInfo.id,content:this.msgContent,images:e},(function(e){"9999"==e.ErrorCode?(t.msgContent="",t.fileList=[],t.msgpage=1,t.messages=[],t.$apiCall("api.Invoice.getMessages",{invoiceId:t.invoiceInfo.id,page:t.msgpage,rowsPerPage:t.msgrowsPerPage},(function(e){"9999"==e.ErrorCode?(t.msgtotalPage=e.Data.Pagination.totalPage,t.msgtotalCount=e.Data.Pagination.totalCount,e.Data.Results.forEach((function(e,i){t.messages.push(e)})),t.$moment().locale("en"),t.messages.forEach((function(e){t.$set(e,"date",t.$moment(e.timeCreated).format("MMMM Do")),t.$set(e,"datetime",t.$moment(e.timeCreated).format("h:mm a")),t.$set(e,"vname",e.vendorName.substr(0,1)),t.$set(e,"cname",e.customerName.substr(0,1))})),t.currentmessages=t.groupBy(t.messages),t.msgpage++):t.$elementMessage(e.Message,"error")}))):t.$elementMessage(e.Message,"error")}))},removeMsgImg:function(t){this.fileList.splice(t,1)},getDataAll:function(){var t=this;this.showLogo=!1,this.logoUrl="",this.$apiCall("api.Invoice.getOneByC",{uniCode:this.uniCode,preview:1==this.preview},(function(e){"9999"==e.ErrorCode?(t.invoiceInfo=e.Data.Results,document.title="Invoice # ".concat(t.invoiceInfo.code," - ").concat(t.invoiceInfo.vendorName," - Ourmall ERP"),1==t.page&&t.getInvoiceData(t.invoiceInfo.id),t.invoiceInfo&&t.invoiceInfo.logo&&(t.showLogo=!0,t.logoUrl=t.invoiceInfo.logo),t.payUrl=t.invoiceInfo.payUrl?t.invoiceInfo.payUrl:"",t.paymentType=t.invoiceInfo.paymentType?t.invoiceInfo.paymentType:"",t.shippingAmount=t.invoiceInfo.shippingAmount?t.toFixed(t.invoiceInfo.shippingAmount):"0",t.itemAmount=t.invoiceInfo.itemAmount?t.toFixed(t.invoiceInfo.itemAmount):"0",t.totalAmount=t.invoiceInfo.totalAmount?t.toFixed(t.invoiceInfo.totalAmount):"0",t.realAmount=t.invoiceInfo.realAmount?t.toFixed(t.invoiceInfo.realAmount):"0"):t.$elementMessage(e.Message,"error")}))},getData:function(){var t=this;this.showLogo=!1,this.logoUrl="",this.$apiCall("api.Invoice.getOneByC",{uniCode:this.uniCode,preview:1==this.preview},(function(e){"9999"==e.ErrorCode?(t.invoiceInfo=e.Data.Results,t.invoiceInfo.logo?(t.showLogo=!0,t.logoUrl=t.invoiceInfo.logo):(t.showLogo=!1,t.logoUrl=""),t.payUrl=t.invoiceInfo.payUrl?t.invoiceInfo.payUrl:"",t.paymentType=t.invoiceInfo.paymentType?t.invoiceInfo.paymentType:"",t.shippingAmount=t.invoiceInfo.shippingAmount?t.toFixed(t.invoiceInfo.shippingAmount):"0",t.itemAmount=t.invoiceInfo.itemAmount?t.toFixed(t.invoiceInfo.itemAmount):"0",t.totalAmount=t.invoiceInfo.totalAmount?t.toFixed(t.invoiceInfo.totalAmount):"0",t.realAmount=t.invoiceInfo.realAmount?t.toFixed(t.invoiceInfo.realAmount):"0"):t.$elementMessage(e.Message,"error")}))},handleChange:function(t,e){var i=this;this.$nextTick((function(){i.$apiCall("api.Invoice.changeQuantityByC",{uniCode:i.uniCode,invoiceId:i.invoiceInfo.id,itemId:t.id,quantity:e,preview:1==i.preview},(function(a){"9999"==a.ErrorCode?(i.itemAmount=a.Data.Results.itemAmount?i.toFixed(a.Data.Results.itemAmount):"0",i.totalAmount=a.Data.Results.totalAmount?i.toFixed(a.Data.Results.totalAmount):"0",i.realAmount=a.Data.Results.realAmount?i.toFixed(a.Data.Results.realAmount):"0",i.invoiceData.map((function(a){t.id==a.id&&(i.$set(a,"quantity",Number(e)),i.$set(a,"amount",(Number(a.quantity)*Number(a.price)).toFixed(2)))}))):i.$elementMessage(a.Message,"error")}))}))},tableRowClassName:function(t){t.row;var e=t.rowIndex;return 0==this.invoiceData[e].quantity?"warning-row":""},getRowClass:function(t){t.row,t.column;var e=t.rowIndex,i=t.columnIndex;if(0===e)return 0==i?"padding-left:10px;text-align:left;background:#43467F;color:#fff;font-weight:600;white-space:nowrap;border-right: 0;":3==i?"padding-right:10px;text-align:right;background:#43467F;color:#fff;font-weight:600;white-space:nowrap;border-right: 0;":"text-align:center;background:#43467F;color:#fff;font-weight:600;white-space:nowrap;border-right: 0;"},cellStyle:function(t){t.row,t.column,t.rowIndex;var e=t.columnIndex;return 0===e?"padding-left:10px;text-align:left;":2==e||3==e?"padding-right:10px;text-align:right;":"text-align:center;"}}}),n=o,l=(i("4788"),i("cba8")),r=Object(l["a"])(n,a,s,!1,null,"291844b2",null);e["default"]=r.exports},d2a5:function(t,e,i){},fd2d:function(t,e,i){"use strict";var a=i("6dd3"),s=i("aee5").map,o=i("9b46"),n=o("map");a({target:"Array",proto:!0,forced:!n},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);