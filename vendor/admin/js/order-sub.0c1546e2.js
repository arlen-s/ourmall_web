(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order-sub"],{"04f2":function(t,e,i){},4939:function(t,e,i){},"4ec4":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],attrs:{"element-loading-background":"rgba(0, 0, 0, 0.3)"}},[i("div",{ref:"tablefilter"},[i("div",{staticClass:"d-flex",staticStyle:{"margin-bottom":"5px","justify-content":"space-between"}},[i("div",{staticClass:"left d-flex",staticStyle:{"flex-wrap":"wrap"}},[i("div",{ref:"pageFilter",staticClass:"page-filter",staticStyle:{"border-bottom":"none"}},[i("el-form",{attrs:{inline:!0,size:"mini"}},[i("el-form-item",{staticClass:"mg-r-5",staticStyle:{"margin-bottom":"0"}},[i("el-input",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:t.$t("myinvoice.采购订单编号")},on:{clear:function(e){return t.clearFilter("code")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem("code")}},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),i("el-form-item",{staticClass:"mg-r-5",staticStyle:{"margin-bottom":"0"}},[i("el-select",{attrs:{filterable:"",remote:"","remote-method":t.remoteMethodCustom,loading:t.selectLoading,placeholder:t.$t("myinvoice.pleaseCusName"),clearable:""},on:{change:function(e){return t.filterGetItem("relationshipId")}},model:{value:t.filterParams.relationshipId,callback:function(e){t.$set(t.filterParams,"relationshipId",e)},expression:"filterParams.relationshipId"}},t._l(t.selectArr,(function(t){return i("el-option",{key:t.id,attrs:{label:t.customerName,value:t.id}})})),1)],1),i("el-form-item",{staticClass:"mg-r-5",staticStyle:{"margin-bottom":"0"}},[i("el-select",{attrs:{filterable:"",remote:"","remote-method":t.getShopName,loading:t.getShopNameInput.loading,placeholder:t.$t("myinvoice.请输入查询店铺名"),clearable:""},on:{change:function(e){return t.filterGetItem("accountId")}},model:{value:t.filterParams.accountId,callback:function(e){t.$set(t.filterParams,"accountId",e)},expression:"filterParams.accountId"}},t._l(t.getShopNameInput.shopList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.shopName,value:t.id}})})),1)],1),i("el-form-item",{staticClass:"mg-r-5",staticStyle:{"margin-bottom":"0"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:t.$t("myinvoice.losNum"),clearable:""},on:{clear:function(e){return t.clearFilter("trackNumber")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem("trackNumber")}},model:{value:t.filterParams.trackNumberIpt,callback:function(e){t.$set(t.filterParams,"trackNumberIpt",e)},expression:"filterParams.trackNumberIpt"}})],1),i("el-form-item",{staticClass:"mg-r-5",staticStyle:{"margin-bottom":"0"}},[i("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:t.$t("myinvoice.客户订单编号"),clearable:""},on:{clear:function(e){return t.clearFilter("codeName")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem("codeName")}},model:{value:t.filterParams.codeNameIpt,callback:function(e){t.$set(t.filterParams,"codeNameIpt",e)},expression:"filterParams.codeNameIpt"}},[i("template",{slot:"prepend"},[t._v("#")])],2)],1),i("el-form-item",{staticClass:"mg-r-20",staticStyle:{"margin-bottom":"0"}},[i("el-select",{staticClass:"mg-r-5",staticStyle:{width:"170px"},attrs:{placeholder:t.$t("myinvoice.filterTime")},model:{value:t.filterParams.timeFilter,callback:function(e){t.$set(t.filterParams,"timeFilter",e)},expression:"filterParams.timeFilter"}},t._l(t.filterParams.timeOption,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),t.filterParams.timeFilter?i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":t.$t("myinvoice.to"),"start-placeholder":t.$t("myinvoice.startDate"),"end-placeholder":t.$t("myinvoice.endDate")},on:{change:t.dateChange},model:{value:t.filterParams.date,callback:function(e){t.$set(t.filterParams,"date",e)},expression:"filterParams.date"}}):t._e()],1),i("el-form-item",{staticStyle:{"margin-bottom":"0"}},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterGetItem()}}},[t._v(t._s(t.$t("myinvoice.filter")))]),i("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.clearFilter()}}},[t._v(t._s(t.$t("myinvoice.clear")))])],1)],1)],1)])]),i("div",{staticClass:"mg-b-10"},[t.filterParams.code?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("code")}}},[t._v(t._s(t.filterParams.code))]):t._e(),t.filterParams.relationshipId?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("relationshipId")}}},[t._v(t._s(t.filterParams.idName)+" ")]):t._e(),t.filterParams.accountId?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("accountId")}}},[t._v(t._s(t.filterParams.aIdName)+" ")]):t._e(),t.filterParams.trackNumber?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("trackNumber")}}},[t._v(t._s(t.$t("myinvoice.losNum"))+" "+t._s(t.filterParams.trackNumber)+" ")]):t._e(),t.filterParams.codeName?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("codeName")}}},[t._v(t._s(t.$t("myinvoice.客户订单编号"))+"# "+t._s(t.filterParams.codeName)+" ")]):t._e(),t.filterParams.date.length?i("el-tag",{staticClass:"mg-r-5",attrs:{size:"small",type:"info",closable:""},on:{close:function(e){return t.clearFilter("date")}}},[t._v(t._s(t.showDateText(t.filterParams.timeFilter))+" "+t._s(t.filterParams.dateFrom)+" - "+t._s(t.filterParams.dateTo)+" ")]):t._e()],1)]),i("div",{staticClass:"table-wrap",staticStyle:{"border-top":"1px #ebeef5 solid"}},[i("el-checkbox-group",{model:{value:t.checkboxArr,callback:function(e){t.checkboxArr=e},expression:"checkboxArr"}},[i("el-table",{ref:"gridTable",attrs:{data:t.tableData,stripe:""}},["waitingForPayment"==t.activeName||"waitingForOffer"==t.activeName?i("el-table-column",{attrs:{width:"40"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-checkbox",{staticClass:"none-label",attrs:{label:e.row.id,disabled:t.checkDisabled(e.row)},on:{change:function(i){return t.checkItem(e.row)}}})]}}],null,!1,3269368157)}):t._e(),i("el-table-column",{attrs:{label:t.$t("myinvoice.invoiceNum"),prop:"code",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v(" "+t._s(e.row.code)+" "),1==e.row.importError&&4!=e.row.status&&5!=e.row.status&&6!=e.row.status?i("el-tooltip",{attrs:{placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e.row.extraJson&&e.row.extraJson.importErrorLog&&e.row.extraJson.importErrorLog.length?t._l(e.row.extraJson.importErrorLog,(function(e,a){return i("p",{key:a},[t._v(" "+t._s(e)+" ")])})):t._e()],2),i("i",{staticClass:"el-icon-warning tx-danger",staticStyle:{"font-size":"14px","margin-left":"5px"}})]):t._e()],1),i("p",{staticClass:"tx-gray-600",staticStyle:{"white-space":"nowrap"}},[i("span",{domProps:{innerHTML:t._s(t.$t("myinvoice.includeNum",{num:Number(e.row.orderCnt)}))}}),t._v(" / "),e.row.totalCnt?i("el-popover",{attrs:{trigger:"hover",placement:"right"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.row.loadCnt,expression:"scope.row.loadCnt"}],staticStyle:{"min-height":"50px","font-size":"12px"},attrs:{slot:""},slot:"default"},[i("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(" "+t._s(t.$t("myinvoice.totalOrders"))),i("b",[t._v(t._s(e.row.totalCnt))]),t._v(" "+t._s(t.$t("myinvoice.pros"))+" ")]),e.row.cnt?[i("div",{staticStyle:{"margin-bottom":"15px","padding-left":"10px"}},t._l(e.row.cnt,(function(e,a){return i("div",{key:a},[i("span",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(e.name)+" :")]),i("span",{staticStyle:{color:"#606266","white-space":"nowrap"}},[t._v(t._s(e.cnt))])])})),0),i("div",{staticStyle:{"text-align":"right"}},[i("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.row.cntText,expression:"scope.row.cntText",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.cntOnCopy,expression:"cntOnCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.cntOnError,expression:"cntOnError",arg:"error"}],staticStyle:{color:"#5c6ac4"},attrs:{href:"javascript:;"}},[t._v(t._s(t.$t("myinvoice.copyData")))])])]:t._e()],2),i("a",{staticStyle:{color:"#5c6ac4"},attrs:{slot:"reference",href:"javascript:;"},on:{mouseenter:function(i){return t.getCntCountry(e.row)}},slot:"reference"},[t._v(t._s(e.row.totalCnt))])]):i("span",{staticStyle:{color:"#606266"}},[t._v("0")]),t._v(" "+t._s(t.$t("myinvoice.pros"))+" / "),e.row.shops.length?i("el-popover",{attrs:{trigger:"hover",placement:"right"}},[i("div",{staticStyle:{"min-height":"50px","font-size":"12px"}},[i("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(" "+t._s(t.$t("myinvoice.总共店铺数："))),i("b",[t._v(t._s(e.row.shops.length))]),t._v(t._s(t.$t("myinvoice.店铺"))+" ")]),t._l(e.row.shops,(function(e){return i("div",{key:e.id},[t._v(" "+t._s(e.shopName)+" ")])}))],2),i("a",{staticStyle:{color:"#5c6ac4"},attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[t._v(t._s(e.row.shops.length))])]):i("span",{staticStyle:{color:"#606266"}},[t._v("0")]),t._v(t._s(t.$t("myinvoice.个店铺"))+" ")],1)]}}])}),i("el-table-column",{attrs:{label:t.$t("myinvoice.cus"),prop:"customerName"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v(t._s(e.row.customerName))]),i("div",[t._v(t._s(e.row.customerRemark))])]}}])}),i("el-table-column",{attrs:{label:t.$t("myinvoice.采购单金额"),width:"230",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{width:"100%","text-align":"right"}},[1==e.row.status?[e.row.orderStatusCnt&&Number(e.row.orderStatusCnt.notBindCnt)?i("div",{staticClass:"tx-danger"},[t._v(" "+t._s(t.$t("myinvoice.部分商品供货价未设置"))+" ")]):e.row.orderStatusCnt?[i("div",[i("span",{staticStyle:{"margin-right":"5px",color:"#909399"}},[t._v("US$")]),i("span",{staticStyle:{color:"#f56c6c"}},[t._v(t._s(e.row.realAmount))])]),e.row.paymentType?i("div",[i("span",{staticStyle:{"margin-right":"5px",color:"#909399"}},[t._v(t._s(t.$t("invoice.采购单付款方式"))+": ")]),i("span",[t._v(t._s(t.$t(t.$dict.paymentType[e.row.paymentType].text)))])]):t._e()]:t._e()]:[i("div",{staticClass:"d-flex",staticStyle:{"justify-content":"flex-end"}},[Number(e.row.totalAmount)?[i("span",{staticStyle:{"margin-right":"10px",color:"#909399"}},[t._v("US$")]),i("span",{staticStyle:{color:"#303133"}},[t._v(" "+t._s(e.row.totalAmount)+" ")])]:i("span",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.$t("myinvoice.setUp")))])],2)]],2)]}}])}),i("el-table-column",{attrs:{label:t.$t("myinvoice.发货统计"),width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.orderStatusCnt?[i("div",{staticStyle:{display:"flex"}},[i("div",{staticClass:"mg-r-10"},[/^(1|2|3|4|5)$/.test(e.row.status)?i("div",{staticClass:"total-num"},[i("span",{staticClass:"title mg-r-5"},[t._v(" "+t._s(1==e.row.status?t.$t("myinvoice.待报价："):t.$t("myinvoice.待发货："))+" ")]),1==e.row.status?i("span",{staticClass:"num mg-r-5",class:"tx-"+t.$dict.invoiceStatus[e.row.status].type},[t._v(t._s(e.row.orderStatusCnt.waitOfferCnt||"---"))]):i("span",{staticClass:"num mg-r-5",class:"tx-"+t.$dict.invoiceStatus[e.row.status].type},[t._v(t._s(e.row.orderStatusCnt.undeliveredCnt||"---"))]),Number(e.row.orderStatusCnt.refundOrderCnt)?i("div",{staticClass:"total-num"},[i("span",{staticClass:"msg"},[t._v("( "),i("span",{staticClass:"tx-danger"},[t._v(t._s(e.row.orderStatusCnt.refundOrderCnt))]),t._v(" "+t._s(t.$t("myinvoice.个订单采购数量异常"))+" )")])]):t._e()]):t._e(),/^(4|5|6)$/.test(e.row.status)?i("div",{staticClass:"total-num"},[i("span",{staticClass:"title mg-r-5"},[t._v(t._s(t.$t("myinvoice.已发货：")))]),i("span",{staticClass:"num mg-r-5 tx-success"},[t._v(t._s(e.row.orderStatusCnt.deliveredCnt||"---"))]),i("div",[Number(e.row.orderStatusCnt.refundOrderCnt)&&6==e.row.status?i("div",{staticClass:"total-num"},[i("span",{staticClass:"msg"},[t._v("( "),i("span",{staticClass:"tx-danger"},[t._v(t._s(e.row.orderStatusCnt.refundOrderCnt))]),t._v(" "+t._s(t.$t("myinvoice.个客户有退款"))+" )")])]):t._e(),Number(e.row.orderStatusCnt.notSyncCnt)?i("div",{staticClass:"total-num"},[i("el-popover",{attrs:{placement:"bottom",title:t.$t("myinvoice.Download"),width:"500",trigger:"hover"}},[i("div",{staticClass:"mg-t-15 mg-b-15",staticStyle:{"white-space":"nowrap"}},[i("span",{staticClass:"tx-gray-600"},[t._v(t._s(t.$t("myinvoice.shippedquantity"))+" ")]),i("a",{attrs:{href:"javascript:;"}},[t._v(t._s(e.row.orderStatusCnt.deliveredCnt))]),i("span",{staticClass:"mg-l-10"},[t._v(" ("),i("a",{attrs:{href:"javascript:;"}},[t._v(t._s(e.row.orderStatusCnt.notSyncOrderCnt))]),t._v(" "+t._s(t.$t("myinvoice.个订单同步异常"))+") ")])]),i("el-alert",{staticClass:"icon-color",attrs:{closable:!1,title:t.$t("myinvoice.Downloadtext"),type:"info","show-icon":""}}),i("div",{staticClass:"mg-t-15 d-flex justify-content-center"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return t.exportDeliver(e.row.id,1)}}},[t._v(t._s(t.$t("myinvoice.Downloadall")))]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return t.exportDeliver(e.row.id,2)}}},[t._v(t._s(t.$t("myinvoice.Downloadallunsync")))])],1),i("a",{staticClass:"msg",attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[t._v(" ( "),i("span",{staticClass:"tx-danger"},[t._v(t._s(e.row.orderStatusCnt.notSyncOrderCnt))]),t._v(" "+t._s(t.$t("myinvoice.个订单同步异常"))+" ) ")])],1)],1):t._e()])]):t._e()])])]:i("i",{staticClass:"el-icon-loading"})]}}])}),i("el-table-column",{attrs:{label:t.$t("myinvoice.status"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$dict.invoiceStatus[e.row.status]?["9"==e.row.status&&e.row.stopReason?i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.stopReason,placement:"top"}},[i("span",[t._v(t._s(t.$t(t.$dict.invoiceStatus[e.row.status].text)))])]):i("span",{class:"tx-"+t.$dict.invoiceStatus[e.row.status].type},[t._v(t._s(t.$t(t.$dict.invoiceStatus[e.row.status].text)))])]:t._e()]}}])}),i("el-table-column",{attrs:{label:t.$t("myinvoice.dateTime"),width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.timeCreated?i("div",{staticStyle:{"white-space":"nowrap"}},[i("span",{staticClass:"tx-gray-600"},[t._v(t._s(t.$t("myinvoice.orderCreate")))]),i("span",[t._v(t._s(t.$moment.unix(e.row.timeCreated).format("YYYY-MM-DD HH:mm:ss")))])]):t._e(),e.row.timeRead?i("div",{staticStyle:{"white-space":"nowrap"}},[i("span",{staticClass:"tx-gray-600"},[t._v(t._s(t.$t("myinvoice.orderPaid")))]),i("span",[t._v(t._s(t.$moment.unix(e.row.timeRead).format("YYYY-MM-DD HH:mm:ss")))])]):t._e(),e.row.timePaid?i("div",{staticStyle:{"white-space":"nowrap"}},[i("span",{staticClass:"tx-gray-600"},[t._v(t._s(t.$t("myinvoice.orderConfirm")))]),i("span",[t._v(t._s(t.$moment.unix(e.row.timePaid).format("YYYY-MM-DD HH:mm:ss")))])]):t._e()]}}])}),i("el-table-column",{attrs:{fixed:"right",label:t.$t("myinvoice.action"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.orderStatusCnt?["1"!=e.row.status||Number(e.row.orderStatusCnt.notBindCnt)?t._e():i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"success"},on:{click:function(i){return t.setPriceConfirm(e.row)}}},[t._v(" "+t._s(t.$t("invoice.确认完成报价"))+" ")])],1),i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"1"==e.row.status&&Number(e.row.orderStatusCnt.notBindCnt)?"success":"primary"},on:{click:function(i){return t.gotoInvoice(e.row)}}},[t._v(" "+t._s("1"==e.row.status&&Number(e.row.orderStatusCnt.notBindCnt)?t.$t("myinvoice.完善报价"):t.$t("myinvoice.viewDetail"))+" ")])],1)]:t._e(),2!=e.row.status&&3!=e.row.status&&4!=e.row.status&&5!=e.row.status&&6!=e.row.status&&9!=e.row.status?[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"},on:{click:function(i){return t.handleCommand({row:e.row,command:"b"})}}},[t._v(t._s(t.$t("myinvoice.导出订单信息")))]),i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"},on:{click:function(i){return t.handleCommand({row:e.row,command:"a"})}}},[t._v(t._s(t.$t("myinvoice.importInfo")))])]:t._e(),2==e.row.status?i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{disabled:e.row.submitLoading,type:"success"},on:{click:function(i){return t.sendInvoice(e.row)}}},[t._v(t._s(t.$t("myinvoice.sendCus")))])],1):t._e(),3==e.row.status?i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{disabled:e.row.submitLoading,type:"success"},on:{click:function(i){return t.openConfirmSetPayed(e.row)}}},[t._v(t._s(t.$t("myinvoice.确认收到款项")))])],1):t._e(),4==e.row.status||5==e.row.status?i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"},on:{click:function(i){return t.openDeliverImport(e.row)}}},[t._v(t._s(t.$t("myinvoice.手工导入发货信息")))])],1):t._e(),1!=e.row.status&&2!=e.row.status?i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"},on:{click:function(i){return t.handleCommand({row:e.row,command:"c"})}}},[t._v(t._s(t.$t("myinvoice.exportt")))])],1):t._e(),2==e.row.status?i("div",[i("div",[i("el-dropdown",{attrs:{type:"primary"},on:{command:t.handleCommandStatus2}},[i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"primary"},on:{click:function(i){return t.handleCommand({row:e.row,command:"b"})}}},[t._v(t._s(t.$t("myinvoice.导出订单信息")))]),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{disabled:""}},[i("b",{staticClass:"black"},[t._v(" "+t._s(t.$t("myinvoice.更多操作"))+" ")])]),i("el-dropdown-item",{attrs:{command:{type:"a",data:e.row}}},[t._v(t._s(t.$t("myinvoice.importInfo")))]),e.row.status<5?i("el-dropdown-item",{attrs:{command:{type:"c",data:e.row}}},[t._v(t._s(t.$t("myinvoice.cancelOrder")))]):t._e()],1)],1)],1)]):t._e(),4==e.row.paymentType&&1==e.row.payStatus||6==e.row.paymentType?t._e():[2!=e.row.status&&e.row.status<5?i("div",[i("el-link",{staticStyle:{"font-size":"12px"},attrs:{type:"danger"},on:{click:function(i){return t.cancelInvoice(e.row)}}},[t._v(t._s(t.$t("myinvoice.cancelOrder")))])],1):t._e()]]}}])})],1)],1)],1),i("div",{ref:"tableFooter"},[t.tableData.length?i("el-row",{attrs:{gutter:20}},[i("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[i("div",{staticStyle:{position:"relative",top:"10px"}},[i("el-pagination",{attrs:{"current-page":t.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"page-size":t.rowsPerPage,total:Number(t.totalCount)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1),i("el-dialog",{attrs:{width:"80%",title:"b"==t.exportInvoiceType?t.$t("myinvoice.exportShopify"):t.$t("myinvoice.exportOrder"),visible:t.innerVisible},on:{"update:visible":function(e){t.innerVisible=e}}},[i("div",{staticClass:"modal-export"},[i("el-divider"),i("div",{staticClass:"border-bottom-1 mg-b-15 pd-b-15"},[i("h6",{staticClass:"mg-b-15",staticStyle:{"border-left":"4px solid #3f4eae","padding-left":"10px"}},[t._v(" "+t._s(t.$t("myinvoice.exportFields"))),i("span",{staticClass:"mg-l-5"},[t._v(t._s(t.$t("myinvoice.dragging")))])]),i("div",{staticClass:"draggable-wrap"},[i("draggable",{attrs:{list:t.modalCustomExport.selectedTitles,draggable:".dargDiv",options:{animation:300},group:"tags"}},t._l(t.modalCustomExport.selectedTitles,(function(e,a){return i("el-tag",{key:e.name,staticClass:"dargDiv",attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.removeTitle(a)}}},[t._v(" "+t._s(e.name)+" ")])})),1),t.modalCustomExport.selectedTitles.length?t._e():i("div",{staticClass:"w-100 justify-content-center"},[i("span",{staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.$t("myinvoice.PleaseSelectBelow")))])])],1)]),i("el-divider"),i("div",{staticClass:"border-bottom-1 mg-b-15 pd-b-15"},[i("h6",{staticClass:"mg-b-15",staticStyle:{"border-left":"4px solid #3f4eae","padding-left":"10px"}},[t._v(" "+t._s(t.$t("myinvoice.optionalfields"))+" "),i("span",{staticClass:"tx-danger tx-12",staticStyle:{color:"#f56c6c"}},[t._v(t._s(t.$t("myinvoice.notExport")))])]),i("div",{staticClass:"tag-wrap"},[i("draggable",{attrs:{list:t.modalCustomExport.unselectedTitles,draggable:".uns-tag",options:{animation:300},group:"tags"}},t._l(t.modalCustomExport.unselectedTitles,(function(e,a){return i("el-tag",{key:e.orName,attrs:{effect:"dark"},on:{click:function(e){return t.selectTitle(a)}}},[t._v(" "+t._s(e.orName)+" ")])})),1)],1)]),i("el-divider"),i("div",{staticClass:"border-bottom-1 mg-b-15 pd-b-15"},[i("h6",{staticClass:"mg-b-15",staticStyle:{"border-left":"4px solid #3f4eae","padding-left":"10px"}},[t._v(" "+t._s(t.$t("myinvoice.customField"))+" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("myinvoice.rename"),placement:"top"}},[i("i",{staticClass:"fa fa-question-circle-o",staticStyle:{color:"#5c6ac4","text-decoration":"none"}})]),i("a",{staticClass:"mg-l-20",staticStyle:{color:"#5c6ac4","text-decoration":"none"},attrs:{href:"javascript:;"},on:{click:function(e){t.showCustom=!t.showCustom}}},[t._v(t._s(t.showCustom?t.$t("myinvoice.hideFields"):t.$t("myinvoice.showFields")))])],1),i("div",{staticClass:"row custom-wrap",class:{hide:!t.showCustom}},[i("el-row",{staticStyle:{margin:"0"},attrs:{gutter:20}},t._l(t.modalCustomExport.selectedTitles,(function(e){return i("el-col",{key:e.orName,staticStyle:{"margin-top":"10px"},attrs:{span:12}},[i("div",{staticClass:"grid-content",staticStyle:{display:"flex","align-items":"center"}},[i("label",{staticStyle:{width:"200px","white-space":"nowrap","text-align":"right","margin-right":"10px",color:"#999"}},[t._v("["+t._s(e.orName)+"]"+t._s(t.$t("myinvoice.showAs"))+"：")]),i("div",{staticClass:"col-6"},[i("el-input",{attrs:{placeholder:e.orName,size:"small"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"title.name"}})],1)])])})),1)],1)]),i("el-divider")],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.innerVisible=!1}}},[t._v(t._s(t.$t("myinvoice.discard")))]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.saveCustomExportSettingOnly}},[t._v(t._s(t.$t("myinvoice.saveSetting")))]),1!=t.exportItem.payStatus&&"c"==t.exportInvoiceType?[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(t.$t("myinvoice.confirmReceipt"))+" ")]),i("el-button",{staticStyle:{"background-color":"#b3e19d","border-color":"#b3e19d",cursor:"not-allowed"},attrs:{type:"success",size:"small"}},[t._v(" "+t._s(t.$t("myinvoice.saveSettingExcel"))+" ")])],1),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(t.$t("myinvoice.confirmReceipt"))+" ")]),i("el-button",{staticStyle:{"background-color":"#b3e19d","border-color":"#b3e19d",cursor:"not-allowed"},attrs:{type:"success",size:"small"}},[t._v(" "+t._s(t.$t("myinvoice.saveSettingCsv"))+" ")])],1)]:[i("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.saveCustomExport("1")}}},[t._v(t._s(t.$t("myinvoice.saveSettingExcel")))]),i("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.saveCustomExport("2")}}},[t._v(t._s(t.$t("myinvoice.saveSettingCsv")))])]],2)]),i("el-dialog",{attrs:{"custom-class":"sendInvoice",title:t.$t("myinvoice.sendInvoice"),visible:t.sendInvoiceOpen,width:"50%"},on:{open:t.openSkype,"update:visible":function(e){t.sendInvoiceOpen=e}}},[[i("div",{staticStyle:{position:"relative","z-index":"1"}},[i("div",{staticStyle:{position:"absolute",right:"30px",top:"15px"}},[i("el-switch",{on:{change:t.changeShowItemPrice},model:{value:t.showItemPrice,callback:function(e){t.showItemPrice=e},expression:"showItemPrice"}}),t._v(" "+t._s(t.$t("myinvoice.showPrice"))+" ")],1)]),i("el-tabs",{staticStyle:{"margin-left":"20px","margin-top":"10px"},attrs:{type:"card"},model:{value:t.activeShareName,callback:function(e){t.activeShareName=e},expression:"activeShareName"}},[i("el-tab-pane",{attrs:{name:"shareLink"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-link"}),t._v(" "+t._s(t.$t("myinvoice.shareLink")))]),i("div",{staticClass:"d-flex mg-y-20"},[i("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[t._v(" "+t._s(t.$t("myinvoice.shareUrl"))+" ")]),i("div",[i("span",[t._v(t._s(t.invoiceInfo.url))])])]),i("div",{staticClass:"d-flex mg-y-20"},[i("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}}),i("div",[i("div",[i("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.invoiceInfo.url,expression:"invoiceInfo.url",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{size:"mini",type:"success"}},[t._v(t._s(t.$t("myinvoice.shareCopy")))])],1)])])]),i("el-tab-pane",{attrs:{name:"shareWeixin"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont icon-shejiao"}),t._v(" "+t._s(t.$t("myinvoice.showApp")))]),i("div",[i("div",{staticClass:"d-flex mg-y-20"},[i("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[t._v(" "+t._s(t.$t("myinvoice.setTitle"))+" ")]),i("div",{staticStyle:{width:"70%"}},[i("el-input",{attrs:{type:"text",size:"small"},on:{change:function(e){return t.saveRemark("2")}},model:{value:t.shareTitle,callback:function(e){t.shareTitle=e},expression:"shareTitle"}})],1)]),i("div",{staticClass:"d-flex mg-y-20 align-items-center"},[i("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[t._v(" "+t._s(t.$t("myinvoice.setContent"))+" ")]),i("div",{staticStyle:{width:"70%"}},[i("el-input",{attrs:{type:"textarea",resize:"none",autosize:{minRows:3,maxRows:6},size:"small"},on:{change:function(e){return t.saveRemark("2")}},model:{value:t.shareDesc,callback:function(e){t.shareDesc=e},expression:"shareDesc"}})],1)]),i("div",{staticClass:"d-flex mg-y-20"},[i("div",{staticStyle:{color:"#999",width:"150px","text-align":"right","margin-right":"10px","white-space":"nowrap"}},[t._v(" "+t._s(t.$t("myinvoice.setType"))+" ")]),i("div",{staticClass:"d-flex",staticStyle:{width:"70%"}},[i("div",{staticClass:"skype-share",staticStyle:{"margin-right":"30px"},attrs:{"data-href":t.shareTitle+t.shareDesc,"data-lang":"en-US","data-text":t.invoiceInfo.url,"data-style":"large"}}),i("div",[i("el-tooltip",{attrs:{placement:"bottom"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",{staticClass:"tx-center mg-b-10"},[t._v(" "+t._s(t.$t("myinvoice.scan"))+" ")]),i("img",{attrs:{src:t.invoiceInfo.qrcodeBase64,width:"130"}}),i("img",{staticStyle:{position:"absolute",left:"50%",top:"50%","margin-left":"-15px","margin-top":"-4px"},attrs:{src:"images/weixin.png",width:"30px"}})]),i("a",{staticClass:"share-weixin",attrs:{href:"javascript:;"}},[i("i",{staticClass:"fa fa-weixin"}),t._v(" "+t._s(t.$t("myinvoice.share"))+" ")])])],1)])])])])],1)],i("el-divider"),i("div",{staticClass:"dialog-footer d-flex justify-content-between",attrs:{slot:"footer"},slot:"footer"},[i("div",[i("el-button",{directives:[{name:"show",rawName:"v-show",value:"shareWeixin"==t.activeShareName,expression:"activeShareName == 'shareWeixin'"}],attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){return t.saveRemark("1")}}},[t._v(t._s(t.$t("myinvoice.reset")))])],1),i("div",[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.sendInvoiceOpen=!1}}},[t._v(t._s(t.$t("myinvoice.discard")))]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.invoicePreview(t.invoiceInfo.url)}}},[t._v(t._s(t.$t("myinvoice.previewInvocie")))])],1)])],2),i("el-dialog",{attrs:{title:t.$t("myinvoice.您当前采购订单中有 0 元供货价的商品"),visible:t.dialogZeroAlert.isShow,width:"600px"},on:{"update:visible":function(e){return t.$set(t.dialogZeroAlert,"isShow",e)}}},[i("div",{staticStyle:{padding:"0 20px"}},[i("div",{staticClass:"mg-b-10"},[t._v(" "+t._s(t.$t("myinvoice.您当前采购订单中有 0 元供货价的商品"))+"： ")]),t._l(t.dialogZeroAlert.items,(function(e){return i("div",{key:e.id,staticStyle:{"margin-bottom":"5px","padding-left":"15px",color:"#909399"}},[t._v(" "+t._s(e.codeName)+" - "+t._s(e.sku)+" × "+t._s(e.quantity)+" ")])})),i("div",{staticClass:"mg-t-30"},[i("el-alert",{attrs:{title:t.$t("myinvoice.确定要发送当前发票发送给客户吗"),type:"warning",closable:!1}})],1)],2),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogZeroAlert.isShow=!1}}},[t._v(" "+t._s(t.$t("myinvoice.我再看看"))+" ")]),i("el-button",{attrs:{size:"small",type:"primary",loading:t.dialogZeroAlert.loading},on:{click:function(e){return t.toSendInvoice(t.dialogZeroAlert.invoice,!0)}}},[t._v(" "+t._s(t.$t("myinvoice.确定"))+" ")])],1)]),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogDeliverImport.loading,expression:"dialogDeliverImport.loading"}],attrs:{title:t.$t("invoice.shippinginformation"),visible:t.dialogDeliverImport.isShow,width:"600px"},on:{"update:visible":function(e){return t.$set(t.dialogDeliverImport,"isShow",e)}}},[i("div",{staticClass:"download-xsl"},[i("el-alert",{staticStyle:{width:"100%"},attrs:{type:"warning",closable:!1}},[i("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[i("span",[t._v(t._s(t.$t("invoice.templateprovided")))]),i("el-button",{staticStyle:{padding:"0"},attrs:{type:"text"},on:{click:t.downloadFile}},[t._v(t._s(t.$t("invoice.template")))])],1)])],1),i("div",{staticStyle:{"margin-top":"40px",padding:"0 20px"}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","auto-upload":!1,"file-list":t.dialogDeliverImport.uploadfileList,"on-change":t.handleUploadChange}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v(t._s(t.$t("invoice.fileSelect")))]),t.dialogDeliverImport.invoiceInfo&&1!=t.dialogDeliverImport.invoiceInfo.payStatus?[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[i("div",{attrs:{slot:"content"},slot:"content"},[t._v(" "+t._s(t.$t("invoice.proceeding"))+" ")]),i("el-button",{staticStyle:{"background-color":"#b3e19d","border-color":"#b3e19d",cursor:"not-allowed","margin-left":"10px"},attrs:{size:"small",type:"success"}},[t._v(t._s(t.$t("invoice.shippinginformation")))])],1)]:[i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v(t._s(t.$t("invoice.shippinginformation")))])],i("div",{staticClass:"el-upload__tip mg-y-15",staticStyle:{"margin-top":"20px"},attrs:{slot:"tip"},slot:"tip"},[i("p",[t._v(t._s(t.$t("invoice.shippinginformation1")))]),i("p",[t._v(t._s(t.$t("invoice.shippinginformation2")))])])],2)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogDeliverImport.isShow=!1}}},[t._v(" "+t._s(t.$t("myinvoice.关闭"))+" ")])],1)]),i("DialogCancelInvoice",{attrs:{data:t.dialogCancelInvoice},on:{setCancel:t.setCancel}}),i("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:20}})],1)},s=[],o=(i("51b3"),i("10dd"),i("87d5"),i("b3d9"),i("89a8"),i("1a91"),i("4c1e"),i("d1ba"),i("993f"),i("8ea3"),i("c93c"),i("acc0"),i("3335")),r=i.n(o),n=i("ccff"),l={props:["cancelStatus","activeName"],data:function(){return{loading:!1,selectLoading:!1,tableHeight:400,pageSize:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))?Number(localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))):10,totalCount:0,totalPage:0,getShopNameInput:{loading:!1,shopList:[]},selectArr:[],status:"",code:"",filterParams:{aIdName:"",idName:"",relationshipId:"",code:"",accountId:"",trackNumberIpt:"",trackNumber:"",codeNameIpt:"",codeName:"",timeOption:[{label:this.$t("myinvoice.createdTime"),value:"timeCreated"},{label:this.$t("myinvoice.confirmedTime"),value:"timePaid"},{label:this.$t("myinvoice.downloadTime"),value:"timeApiGet"},{label:this.$t("myinvoice.paidTime"),value:"timeRead"}],timeFilter:"",date:[],dateFrom:"",dateTo:""},filterParamsDefault:"{}",tableData:[],exportItem:"",exportInvoiceType:"",sendInvoiceOpen:!1,activeShareName:"shareLink",shareTitle:"",shareDesc:"",dialogZeroAlert:{isShow:!1,loading:!1,items:[],invoice:null},dialogZeroAlertDefault:"{}",showItemPrice:!0,showCustom:!1,invoiceInfo:"",modalCustomExport:{tags:[],selectedTitles:[],unselectedTitles:[]},modalCustomExportDefault:"",innerVisible:!1,dialogDeliverImport:{isShow:!1,loading:!1,invoiceInfo:null,uploadfileList:[]},dialogDeliverImportDefault:"{}",dialogCancelInvoice:{loading:!1,isShow:!1,item:null,stopReason:""},dialogCancelInvoiceDefault:"{}",checkboxArr:[],cid:""}},components:{draggable:r.a,DialogCancelInvoice:n["a"]},created:function(){this.getStatus()},mounted:function(){var t=this;this.checkboxArr=[],this.dialogCancelInvoiceDefault=JSON.stringify(this.dialogCancelInvoice),this.filterParamsDefault=JSON.stringify(this.filterParams),this.dialogZeroAlertDefault=JSON.stringify(this.dialogZeroAlert),this.modalCustomExportDefault=JSON.stringify(this.modalCustomExport),this.dialogDeliverImportDefault=JSON.stringify(this.dialogDeliverImport),this.$route.params.id?(this.filterParams.idName=this.$route.params.customerName?this.$route.params.customerName:"",this.filterParams.relationshipId=this.$route.params.id?this.$route.params.id:"",this.selectArr=[{id:this.$route.params.id,customerName:this.$route.params.customerName}],this.filterGetItem("relationshipId")):this.$nextTick((function(){t.getItems()}))},beforeDestroy:function(){},watch:{activeName:function(){this.checkboxArr=[]},$route:"gotoPage",cancelStatus:"gotoPage",checkboxArr:{handler:function(){this.$emit("checkedArr",this.checkboxArr)},deep:!0}},methods:{openConfirmSetPayed:function(t){var e=this;this.$confirm(this.$t("myinvoice.是否要确认收到款项？"),"",{type:"warning",confirmButtonText:this.$t("myinvoice.确认"),cancelButtonText:this.$t("myinvoice.取消")}).then((function(){e.confirmSetPayed(t)})).catch((function(){}))},checkItem:function(t){this.cid=t.relationshipId},checkDisabled:function(t){return!t.relationshipId||!!this.checkboxArr.length&&t.relationshipId!=this.cid},setPriceConfirm:function(t){var e=this;this.$confirm("\n        <p>".concat(this.$t("invoice.是否要确认完成报价?"),'</p>\n        <p>\n          <span style="margin-right: 5px; color: #909399;">').concat(this.$t("myinvoice.采购订单编号"),": </span> ").concat(t.code,'\n        </p>\n        <p>\n          <span style="margin-right: 5px; color: #909399;">').concat(this.$t("invoice.采购单金额"),": </span> US$ ").concat(t.realAmount,'\n        </p>\n        <p>\n          <span style="margin-right: 5px; color: #909399;">').concat(this.$t("invoice.采购单付款方式"),": </span>\n          ").concat(t.paymentType?this.$t(this.$dict.paymentType[t.paymentType].text):"---","\n        </p>\n        "),"",{dangerouslyUseHTMLString:!0,confirmButtonText:this.$t("invoice.确定"),cancelButtonText:this.$t("invoice.取消"),type:"warning"}).then((function(){e.loading=!0,e.$apiCall("api.Invoice.setPriceConfirm",{invoiceId:t.id},(function(t){"9999"==t.ErrorCode?(e.$elementMessage(e.$t("invoice.确认完成报价成功"),"success"),e.getItems(!0)):e.$elementMessage(t.Message,"error")}))}))},handleCommandStatus2:function(t){"a"==t.type&&this.handleCommand({row:t.data,command:"a"}),"c"==t.type&&this.cancelInvoice(t.data)},submitUpload:function(){var t=this;if(this.dialogDeliverImport.uploadfileList.length){this.dialogDeliverImport.loading=!0;var e=this.dialogDeliverImport.uploadfileList[0].raw;0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>');var i=function(t){document.getElementById("ifilePro").src=t},a="api.Invoice.deliverImport",s={invoiceId:this.dialogDeliverImport.invoiceInfo.id,"@file":e};this.$apiCall(a,s,(function(e){t.dialogDeliverImport.loading=!1,"9999"==e.ErrorCode?(t.dialogDeliverImport.isShow=!1,t.$elementMessage(t.$t("invoice.successImport"),"success"),t.getItems(!0),i(e.Data.Results.file)):t.$elementMessage(e.Message,"error")}))}else this.$elementMessage(this.$t("invoice.selectfile"),"error")},handleUploadChange:function(t){this.dialogDeliverImport.uploadfileList=[],this.dialogDeliverImport.uploadfileList.push(t)},downloadFile:function(){var t="./file/orders_impor.xlsx";0==$("#downloadFile").length&&$("body").append('<iframe id="downloadFile" style="display:none"></iframe>');var e=function(t){document.getElementById("downloadFile").src=t};e(t)},openDeliverImport:function(t){this.dialogDeliverImport=JSON.parse(this.dialogDeliverImportDefault),this.dialogDeliverImport.isShow=!0,this.dialogDeliverImport.invoiceInfo=t},confirmSetPayed:function(t){var e=this;t.submitLoading=!0,this.$apiCall("api.Invoice.setPayed",{invoiceId:t.id},(function(t){"9999"==t.ErrorCode&&(e.$elementMessage(e.$t("invoice.successConfirm"),"success"),e.getItems(!0))}))},clearFilter:function(t){switch(t){case"code":this.filterParams.code=this.code="";break;case"relationshipId":this.filterParams.relationshipId=this.filterParams.idName="";break;case"accountId":this.filterParams.accountId=this.filterParams.aIdName="";break;case"trackNumber":this.filterParams.trackNumber=this.filterParams.trackNumberIpt="";break;case"codeName":this.filterParams.codeName=this.filterParams.codeNameIpt="";break;case"date":this.filterParams.date=[],this.filterParams.dateFrom="",this.filterParams.dateTo="",this.filterParams.timeFilter="";break;default:this.code="",this.filterParams=JSON.parse(this.filterParamsDefault);break}"change"!=t&&this.gotoPage()},filterGetItem:function(t){var e=this;switch(t){case"code":this.filterParams.code=this.code;break;case"relationshipId":this.selectArr.forEach((function(t){t.id==e.filterParams.relationshipId&&(e.filterParams.idName=t.customerName)}));break;case"accountId":this.getShopNameInput.shopList.forEach((function(t){t.id==e.filterParams.accountId&&(e.filterParams.aIdName=t.shopName)}));break;case"trackNumber":this.filterParams.trackNumber=this.filterParams.trackNumberIpt;break;case"codeName":this.filterParams.codeName=this.filterParams.codeNameIpt;break;default:this.filterParams.code=this.code,this.filterParams.trackNumber=this.filterParams.trackNumberIpt,this.filterParams.codeName=this.filterParams.codeNameIpt;break}this.filterParams.codeName&&(this.filterParams.codeName=this.filterParams.codeName.replace(/#/g,"")),this.gotoPage()},showDateText:function(t){var e="";return this.filterParams.timeOption.forEach((function(i){i.value==t&&(e=i.label)})),e},dateChange:function(){this.filterParams.date.length>1&&(this.filterParams.dateFrom=this.$moment(this.filterParams.date[0]).format("YYYY-MM-DD"),this.filterParams.dateTo=this.$moment(this.filterParams.date[1]).format("YYYY-MM-DD"),this.filterGetItem())},getShopName:function(t){var e=this;this.getShopNameInput.shopList=[],t&&(this.getShopNameInput.loading=!0,this.$apiCall("api.Invoice.findStoreByVendor",{shopName:t},(function(t){e.getShopNameInput.loading=!1,9999==t.ErrorCode?e.getShopNameInput.shopList=t.Data.Results:e.$message({message:t.Message,type:"error"})})))},remoteMethodCustom:function(t){var e=this;this.selectArr=[],t&&(this.selectLoading=!0,this.$apiCall("api.Relationship.findByVendor",{name:t},(function(t){e.selectLoading=!1,9999==t.ErrorCode?e.selectArr=t.Data.Results:e.$message({message:t.Message,type:"error"})})))},onCopy:function(t){this.$elementMessage(this.$t("successfullyToClipboard"),"success")},onError:function(t){this.$elementMessage(this.$t("failedToClipboard"),"error")},saveRemark:function(t){var e=this;this.$showLoading(),this.$apiCall("api.Invoice.saveRemark",{uniCode:this.invoiceInfo.uniCode,title:1==t?"":this.shareTitle,desc:1==t?"":this.shareDesc},(function(t){e.$hideLoading(),"9999"==t.ErrorCode?(e.shareTitle=t.Data.Results.title,e.shareDesc=t.Data.Results.desc):(e.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||e.$userFailure(e))}))},invoicePreview:function(t){var e=window.open("/blank.html","invoicePreview");e.location.href=t},openSkype:function(){var t=0,e=setInterval((function(){(function(t,e,i){t.loadSkypeWebSdkAsync=t.loadSkypeWebSdkAsync||function(t){var a,s=e.getElementsByTagName(i)[0];e.getElementById(t.id)||(a=e.createElement(i),a.id=t.id,a.src=t.scriptToLoad,a.onload=t.callback,s.parentNode.insertBefore(a,s))};var a={scriptToLoad:"https://swx.cdn.skype.com/shared/v/latest/skypewebsdk.js",id:"skype_web_sdk"};t.loadSkypeWebSdkAsync(a)})(window,document,"script"),t++,t>10&&clearInterval(e)}),300)},toSendInvoice:function(t,e){var i=this;this.showItemPrice="1"==t.showItemPrice,this.sendInvoiceOpen=!0,this.activeShareName="shareLink",e&&(this.dialogZeroAlert.loading=!0),this.$apiCall("api.Invoice.getShareUrl",{invoiceId:t.id},(function(t){i.$hideLoading(),"9999"==t.ErrorCode?(i.invoiceInfo=t.Data.Results,i.shareTitle=i.invoiceInfo.remark?i.invoiceInfo.remark.title:"",i.shareDesc=i.invoiceInfo.remark?i.invoiceInfo.remark.desc:"",i.sendInvoiceOpen=!0,i.activeShareName="shareLink",e&&(i.dialogZeroAlert.isShow=!1)):(i.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||i.$userFailure())}))},sendInvoice:function(t){var e=this;t.submitLoading=!0,this.$apiCall("api.Invoice.checkItemPrice",{invoiceId:t.id},(function(i){if(t.submitLoading=!1,"9999"==i.ErrorCode){var a=i.Data.Results;a.noSkuArr.length||a.nullPriceArr.length||a.zeroPriceArr.length?(e.dialogZeroAlert=JSON.parse(e.dialogZeroAlertDefault),e.dialogZeroAlert.items=a.noSkuArr.concat(a.noSkuArr,a.nullPriceArr,a.zeroPriceArr),e.dialogZeroAlert.isShow=!0,e.dialogZeroAlert.invoice=t):e.toSendInvoice(t)}else e.$elementMessage(i.Message,"error")}))},changeShowItemPrice:function(){var t=this;this.$apiCall("api.Invoice.setShowPrice",{uniCode:this.invoiceInfo.uniCode},(function(e){"9999"==e.ErrorCode?t.getItems(!0):(t.showItemPrice=!t.showItemPrice,t.$elementMessage(e.Message,"error"))}))},selectTitle:function(t){this.modalCustomExport.selectedTitles.push(this.modalCustomExport.unselectedTitles[t]),this.modalCustomExport.unselectedTitles.splice(t,1)},removeTitle:function(t){this.modalCustomExport.unselectedTitles.unshift(this.modalCustomExport.selectedTitles[t]),this.modalCustomExport.selectedTitles.splice(t,1)},getOrderCnt:function(t){var e=this;!this.tableData.length||this.tableData.length<t+1||"undefined"==typeof this.tableData[t]||this.$apiCall("api.Invoice.getSummary",{invoiceId:this.tableData[t].id},(function(i){"9999"==i.ErrorCode?"undefined"!=typeof e.tableData[t]&&e.$set(e.tableData[t],"orderStatusCnt",i.Data.Results):e.$elementMessage(i.Message,"error"),t++,e.getOrderCnt(t)}))},getItems:function(t,e){var i=this;this.loading=!0;var a={page:this.page,rowsPerPage:this.rowsPerPage,status:this.status,code:this.filterParams.code,relationshipId:this.filterParams.relationshipId,accountId:this.filterParams.accountId,trackNumber:this.filterParams.trackNumber,codeName:this.filterParams.codeName,timeFilter:this.filterParams.timeFilter,dateFrom:this.filterParams.dateFrom,dateTo:this.filterParams.dateTo};"abnormal"==this.status&&(a.status="",a.isAbnormal="1"),2==this.cancelStatus&&(a.status="9"),this.$apiCall("api.Invoice.findByVendor",a,(function(t){if(9999==t.ErrorCode){i.loading=!1;var a=[t.Data.Results,t.Data.Pagination],s=a[0],o=a[1];i.tableData=s.map((function(t){return t.loadCnt=!1,t.cnt=null,t.cntText="",t.submitLoading=!1,t.orderStatusCnt=null,t})),i.totalCount=Number(o.totalCount),i.totalPage=Number(o.totalPage),i.getOrderCnt(0),i.$emit("getNum"),"waitingForOffer"==i.$route.name&&i.$route.params.saveCode&&i.$route.params.code&&(i.$route.params.saveCode=!1,i.tableData.some((function(t){if(t.code==i.$route.params.code)return i.gotoInvoice(t),!0}))),e||(i.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0)}else i.$message({message:t.Message,type:"error"})}))},getStatus:function(){switch(this.$route.name){case"waitingForOffer":this.status="1";break;case"waitingForPayment":this.status="2";break;case"waitingForConfirm":this.status="3";break;case"waitingForDelivery":this.status="45";break;case"fullDeliveryOrder":this.status="6";break;case"abnormal":this.status="abnormal";break;default:this.status="";break}},cntOnError:function(){this.$elementMessage(this.$t("myinvoice.copyFailed"),"error")},cntOnCopy:function(){this.$elementMessage(this.$t("myinvoice.copyItems"),"success")},getCntCountry:function(t){var e=this;t.cnt||(t.loadCnt=!0),this.$apiCall("api.Invoice.getItemsCountry",{invoiceId:t.id},(function(i){if(t.loadCnt=!1,"9999"==i.ErrorCode){t.cnt=i.Data.Results;var a="".concat(e.$t("myinvoice.总共采购商品数：")).concat(t.totalCnt,",");Object.keys(i.Data.Results).forEach((function(t){a+="".concat(i.Data.Results[t].name,": ").concat(i.Data.Results[t].cnt,",")})),t.cntText=a.slice(0,a.length-1)}}))},handleCommand:function(t){var e=this;this.exportItem=t.row,this.exportInvoiceType=t.command;var i=function(){},a="";switch(t.command){case"a":this.$router.push({name:"importData",query:{rid:this.exportItem.relationshipId,id:this.exportItem.id}});break;case"b":this.$showLoading(),0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>'),i=function(t){document.getElementById("ifilePro").src=t},a="b"==this.exportInvoiceType?"api.Invoice.exportInvoice":"api.Invoice.exportOrder",this.$apiCall(a,{invoiceId:this.exportItem.id,type:"excel"},(function(t){e.$hideLoading(),"9999"==t.ErrorCode?(e.$elementMessage(e.$t("myinvoice.exportSuccess"),"success"),i(t.Data.Results.file)):(e.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||e.$userFailure(e))}));break;case"c":this.setExportOnly("c");break}},saveCustomExport:function(t){this.saveCustomExportSettingOnly(t)},saveCustomExportSettingOnly:function(t){var e=this;if(!this.modalCustomExport.selectedTitles.length)return this.$elementMessage(this.$t("myinvoice.leastOne"),"error"),!1;if(this.modalCustomExport.selectedTitles.some((function(t){return!t.name})))return this.$elementMessage(this.$t("myinvoice.notEmpty"),"error"),!1;this.$showLoading();var i={};this.modalCustomExport.selectedTitles.forEach((function(t){i[t.key]=t.name}));var a="b"==this.exportInvoiceType?"api.Invoice.saveInvoiceTitle":"api.Invoice.saveExportTitle";this.$apiCall(a,{titles:i},(function(a){if("9999"==a.ErrorCode)if(t>0){0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>');var s=function(t){document.getElementById("ifilePro").src=t},o="b"==e.exportInvoiceType?"api.Invoice.exportInvoice":"api.Invoice.exportOrder";e.$apiCall(o,{titles:i,invoiceId:e.exportItem.id,type:1==t?"excel":"csv"},(function(t){e.$hideLoading(),"9999"==t.ErrorCode?(e.innerVisible=!1,e.$elementMessage(e.$t("myinvoice.saveSettingAndExport"),"success"),s(t.Data.Results.file)):(e.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||e.$userFailure(e))}))}else e.$elementMessage(e.$t("myinvoice.saveSettingSuccess"),"success"),e.innerVisible=!1;else e.$hideLoading(),e.$elementMessage(a.Message,"error"),"1002"!=a.ErrorCode&&"1003"!=a.ErrorCode||e.$userFailure(e)}))},setExportOnly:function(t){var e=this;this.exportInvoiceType=t,this.loading=!0,this.showCustom=!1,this.modalCustomExport=JSON.parse(this.modalCustomExportDefault);var i="b"==this.exportInvoiceType?"api.Invoice.exportInvoiceTitle":"api.Invoice.exportTitle";this.$apiCall(i,{},(function(t){if(e.loading=!1,"9999"==t.ErrorCode){for(var i in e.innerVisible=!0,t.Data.Results.default){var a={};a.key=i,a.orName=t.Data.Results.default[i],a.name=t.Data.Results.default[i],e.modalCustomExport.tags.push(a)}for(var i in t.Data.Results.titles){var s={};s.key=i,s.orName=t.Data.Results.titles[i],s.name=t.Data.Results.titles[i],e.modalCustomExport.selectedTitles.push(s)}e.modalCustomExport.tags.forEach((function(t){e.modalCustomExport.selectedTitles.some((function(e){return t.key==e.key}))||e.modalCustomExport.unselectedTitles.unshift(t),e.modalCustomExport.selectedTitles.some((function(i){t.key==i.key&&e.$set(i,"orName",t.name)}))}))}else e.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||e.$userFailure(e)}))},gotoInvoice:function(t){var e=this.$router.resolve({name:"Invoice",query:{uniCode:t.uniCode,fromPage:1}});window.open(e.href,"_blank")},toPage:function(t){t!=this.$route.query.page&&this.$router.push({query:{page:t}})},changePageSize:function(t){this.rowsPerPage=t,localStorage.setItem("".concat(this.$route.name,"RowsPerPage"),t),this.getItems()},gotoPage:function(){this.getStatus(),this.page=this.$route.query.page?Number(this.$route.query.page):1,this.getItems()},setCancel:function(){var t=this;this.dialogCancelInvoice.stopReason?(this.dialogCancelInvoice.loading=!0,this.$apiCall("api.Invoice.cancel",{invoiceId:this.dialogCancelInvoice.item.id,stopReason:this.dialogCancelInvoice.stopReason},(function(e){t.dialogCancelInvoice.loading=!1,9999==e.ErrorCode?(t.dialogCancelInvoice.isShow=!1,t.$message({message:t.$t("myinvoice.cancelSuccess"),type:"success"}),t.getItems(!0)):t.$message({message:e.Message,type:"error"})}))):this.$message({message:"作废原因必须填写",type:"error"})},cancelInvoice:function(t){this.dialogCancelInvoice=JSON.parse(this.dialogCancelInvoiceDefault),this.dialogCancelInvoice.isShow=!0,this.dialogCancelInvoice.item=t},exportDeliver:function(t,e){var i=this;this.$showLoading(),this.$apiCall("api.Invoice.exportDeliverTitle",{invoiceId:t},(function(a){if("9999"==a.ErrorCode){var s=[];for(var o in a.Data.Results.titles){var r={};r.key=o,r.orName=a.Data.Results.titles[o],r.name=a.Data.Results.titles[o],s.push(r)}var n={};s.forEach((function(t){n[t.key]=t.name}));var l={invoiceId:t,titles:n,onlyDelivered:!0};2==e&&(l.onlyNotSync=!0),0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>');var c=function(t){document.getElementById("ifilePro").src=t};i.$apiCall("api.Invoice.exportDeliver",l,(function(t){i.$hideLoading(),"9999"==t.ErrorCode?(i.$elementMessage(i.$t("myinvoice.下载成功"),"success"),c(t.Data.Results.file)):(i.$elementMessage(t.Message,"error"),"1002"!=t.ErrorCode&&"1003"!=t.ErrorCode||i.$userFailure())}))}else i.$elementMessage(a.Message,"error"),"1002"!=a.ErrorCode&&"1003"!=a.ErrorCode||i.$userFailure()}))}}},c=l,d=(i("da27"),i("7001"),i("cba8")),m=Object(d["a"])(c,a,s,!1,null,"1d97ee5a",null);e["default"]=m.exports},7001:function(t,e,i){"use strict";i("04f2")},"8ea3":function(t,e,i){"use strict";var a=i("88d4"),s=i("34cd").map,o=i("3a6d"),r=o("map");a({target:"Array",proto:!0,forced:!r},{map:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},acc0:function(t,e,i){"use strict";var a=i("88d4"),s=i("8735"),o=i("b595"),r=i("0859"),n=i("bf1f"),l=i("1c34"),c=i("126a"),d=i("63ef"),m=i("c40a"),p=i("d0ff"),u=i("3a6d"),v=i("4b57"),f=u("slice"),h=p("species"),g=s.Array,y=Math.max;a({target:"Array",proto:!0,forced:!f},{slice:function(t,e){var i,a,s,p=d(this),u=c(p),f=l(t,u),b=l(void 0===e?u:e,u);if(o(p)&&(i=p.constructor,r(i)&&(i===g||o(i.prototype))?i=void 0:n(i)&&(i=i[h],null===i&&(i=void 0)),i===g||void 0===i))return v(p,f,b);for(a=new(void 0===i?g:i)(y(b-f,0)),s=0;f<b;f++,s++)f in p&&m(a,s,p[f]);return a.length=s,a}})},ccff:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.data.loading,expression:"data.loading"}],attrs:{title:t.$t("myinvoice.confirmToCancel"),visible:t.data.isShow,width:"500px"},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[i("el-divider"),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form",{ref:"form",attrs:{"label-width":"80px"}},[t.data.item?i("el-form-item",{attrs:{label:"订单号"}},[i("span",{staticStyle:{color:"#909399"}},[t._v(t._s(t.data.item.code))])]):t._e(),i("el-form-item",{attrs:{label:"作废原因"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.data.stopReason,callback:function(e){t.$set(t.data,"stopReason",e)},expression:"data.stopReason"}})],1)],1)],1)],1),i("el-divider"),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.data.isShow=!1}}},[t._v(" "+t._s(t.$t("myinvoice.discard"))+" ")]),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:t.setCancel}},[t._v(" "+t._s(t.$t("myinvoice.cancel"))+" ")])],1)],1)},s=[],o={props:["data"],methods:{setCancel:function(){this.$emit("setCancel")}}},r=o,n=i("cba8"),l=Object(n["a"])(r,a,s,!1,null,null,null);e["a"]=l.exports},da27:function(t,e,i){"use strict";i("4939")}}]);