(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["myQuotation"],{"0d8b":function(t,e,a){"use strict";a("934d")},"480c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel my-custom-page"},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-baojiadan"}),e("h2",[t._v(t._s(t.$t("quotation.我的报价单")))])])]),e("div",{staticClass:"right"})]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[e("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-card",[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("div",{ref:"pageFilter",staticClass:"page-filter"},[e("el-form",{attrs:{inline:!0,size:"mini"}},[e("el-form-item",[e("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:t.$t("quotation.编号"),clearable:""},on:{clear:function(e){return t.clearFilter("code")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterItem.apply(null,arguments)}},model:{value:t.filterParams.code,callback:function(e){t.$set(t.filterParams,"code",e)},expression:"filterParams.code"}})],1),e("el-form-item",[e("el-select",{attrs:{filterable:"",remote:"","remote-method":t.remoteMethodCustom,loading:t.selectLoading,placeholder:t.$t("myinvoice.pleaseCusName"),clearable:""},on:{change:function(e){return t.filterItem("cust")},clear:t.close},model:{value:t.filterParams.customer,callback:function(e){t.$set(t.filterParams,"customer",e)},expression:"filterParams.customer"}},t._l(t.selectArr,(function(t){return e("el-option",{key:t.id,attrs:{label:t.customerName,value:t.customerName}})})),1)],1),e("el-form-item",{attrs:{label:t.$t("quotation.状态：")}},[e("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",clearable:"",placeholder:t.$t("quotation.请选择状态")},on:{change:function(e){return t.filterItem()}},model:{value:t.filterParams.status,callback:function(e){t.$set(t.filterParams,"status",e)},expression:"filterParams.status"}},[e("el-option",{attrs:{label:"ALL",value:""}}),e("el-option",{attrs:{label:t.$t("quotation.待报价"),value:"1"}}),e("el-option",{attrs:{label:t.$t("quotation.报价中"),value:"2"}}),e("el-option",{attrs:{label:t.$t("quotation.已报价"),value:"3"}}),e("el-option",{attrs:{label:t.$t("quotation.作废单"),value:"9"}})],1)],1),e("el-form-item",{attrs:{label:t.$t("quotation.创建日期：")}},[e("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":t.$t("myinvoice.to"),"start-placeholder":t.$t("myinvoice.startDate"),"end-placeholder":t.$t("myinvoice.endDate")},on:{clear:function(e){return t.clearFilter("date")},change:t.dateChange},model:{value:t.filterParams.date,callback:function(e){t.$set(t.filterParams,"date",e)},expression:"filterParams.date"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.filterItem}},[t._v(t._s(t.$t("mycustomer.filter")))]),e("el-button",{attrs:{type:"danger"},on:{click:t.clearFilter}},[t._v(t._s(t.$t("mycustomer.clear")))])],1)],1)],1)])],1),e("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{data:t.items,stripe:"","row-key":"id"}},[e("el-table-column",{attrs:{label:t.$t("quotation.编号"),prop:"code"}}),e("el-table-column",{attrs:{label:t.$t("quotation.状态")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(1==a.row.status&&t.$t("quotation.待报价")||2==a.row.status&&t.$t("quotation.报价中")||3==a.row.status&&t.$t("quotation.已报价")||4==a.row.status&&t.$t("quotation.作废单")||t.$t("quotation.作废单"))+" "),2==a.row.status||3==a.row.status?e("span",[t._v("（ "+t._s(1==a.row.vendorStatus&&t.$t("quotation.待报价")||2==a.row.vendorStatus&&t.$t("quotation.报价中")||3==a.row.vendorStatus&&t.$t("quotation.待审核")||4==a.row.vendorStatus&&t.$t("quotation.已采纳")||9==a.row.vendorStatus&&t.$t("quotation.未采纳")||t.$t("quotation.无效"))+" ）")]):t._e()]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.报价单类型")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(1==e.row.type?t.$t("quotation.订单报价单"):t.$t("quotation.商品报价单"))+" ")]}}])}),1!=t.filterParams.type?[e("el-table-column",{attrs:{label:t.$t("quotation.客户")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.customerName)+" ")]}}],null,!1,4129509950)})]:[e("el-table-column",{attrs:{label:t.$t("quotation.shopify店铺")},scopedSlots:t._u([{key:"default",fn:function(a){return a.row.accounts?t._l(a.row.accounts,(function(a){return e("div",{key:a.id},[t._v(" "+t._s(a)+" ")])})):void 0}}],null,!0)}),e("el-table-column",{attrs:{label:t.$t("quotation.shopify订单"),prop:"orderCnt"}}),e("el-table-column",{attrs:{label:t.$t("quotation.订单金额"),prop:"totalPrice"}})],e("el-table-column",{attrs:{label:t.$t("quotation.创建时间"),width:"230"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(t.$moment.unix(a.row.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")])]}}])},[e("div")]),e("el-table-column",{attrs:{label:t.$t("quotation.操作"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[9!=a.row.status?e("div",[[a.row.canComplete&&3!=a.row.status?e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.completeQuotation(a.row)}}},[t._v(t._s(t.$t("quotation.完成报价")))]):t._e()]],2):t._e(),e("div",[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.getProduct(a.row)}}},[t._v(t._s(t.$t("quotation.报价详情")))])],1)]}}])},[e("div")])],2)],1)],1)],1),t.items.length?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",[e("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSizes,"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1),e("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:20}}),e("el-dialog",{attrs:{visible:t.quotationDetail,width:"50%"},on:{close:function(e){t.quotationDetail=!1}}},[e("div",{staticClass:"dialog-body"},[e("div",{staticStyle:{padding:"20px"}},[e("el-divider"),e("el-table",{ref:"gridTable2",staticStyle:{width:"100%"},attrs:{data:t.datailList,stripe:"","row-key":"id",height:"500"}},[e("el-table-column",{attrs:{label:t.$t("quotation.名称"),prop:"name"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.row.name,placement:"top"}},[e("span",{staticClass:"tx-ellipsis2",staticStyle:{"white-space":"none"}},[t._v(" "+t._s(a.row.name)+" ")])])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.图片"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{height:"70px",width:"70px"},attrs:{src:t.row.imgUrl,"z-index":9999,fit:"cover","preview-src-list":[t.row.imgUrl]}})]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.客户SKU"),prop:"shopifySkuId"}}),e("el-table-column",{attrs:{label:t.$t("quotation.属性"),prop:"propertyValue"}}),e("el-table-column",{attrs:{label:"SKU",prop:"vendorSku"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.vendorSku?e("span",[t._v(t._s(a.row.vendorSku)+" ")]):e("span",[t._v("---")])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.报价")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.price?e("span",[t._v(t._s(a.row.price)+" ")]):e("span",[t._v(t._s(t.$t("quotation.未报价")))])]}}])})],1)],1)])]),e("el-dialog",{attrs:{"close-on-click-modal":!1,visible:t.ProductDetailVis,width:"50%",title:t.$t("quotation.报价详情")},on:{close:function(e){t.ProductDetailVis=!1}}},[e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.addLoading,expression:"addLoading"}],attrs:{"append-to-body":"","close-on-click-modal":!1,visible:t.addProductVis,width:"70%",title:t.$t("quotation.添加商品")},on:{close:t.closeAdd}},[e("el-divider"),e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.基础信息")))]),e("el-form",{attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{label:t.$t("quotation.图片："),"label-width":"150px"}},[e("div",{staticClass:"upload"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.nowItem.imgUrl,"z-index":9999,fit:"cover","preview-src-list":[t.nowItem.imgUrl]}})],1)]),e("el-form-item",{attrs:{label:t.$t("quotation.描述"),"label-width":"150px"}},[e("span",[t._v(t._s(t.nowItem.detail))])]),e("el-form-item",{attrs:{label:t.$t("quotation.期望价格"),"label-width":"150px"}},[t.nowItem.expectPrice&&"0.00"!=t.nowItem.expectPrice?e("span",[t._v(" "+t._s(t.nowItem.expectPrice))]):e("span",[t._v("/")])]),e("el-form-item",{attrs:{label:t.$t("quotation.备注"),"label-width":"150px"}},[e("span",[t._v(t._s(t.nowItem.remarks))])])],1),e("el-divider"),e("div",{staticStyle:{padding:"20px 0"}},[e("el-tabs",{attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:t.$t("quotation.手工添加"),name:"first"}},[e("b",{staticClass:"mg-t-20"},[t._v(t._s(t.$t("quotation.商品规格")))]),e("div",{staticStyle:{"margin-left":"40px","margin-top":"20px"}},[e("div",{staticClass:"mg-b-20"},[t._v(" "+t._s(t.$t("quotation.规格名称："))+" "),t._l(t.dynamicTags,(function(a,i){return e("el-tag",{key:i,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(a)}}},[t._v(" "+t._s(a.name)+" ")])})),[t.inputVisible?e("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v(t._s(t.$t("quotation.+ 自定义")))]),e("span",{staticStyle:{color:"#ccc","margin-left":"20px"}},[t._v(t._s(t.$t("quotation.回车键确认添加")))])]],2),e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{width:"76px","padding-top":"14px"}},[t._v(" "+t._s(t.$t("quotation.规格值："))+" ")]),e("div",t._l(t.dynamicTags,(function(a,i){return e("div",{key:i,staticClass:"mg-t-10 d-flex"},[e("span",[t._v(t._s(a.name)+": ")]),e("el-input",{ref:"saveTagInput",refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small",placeholder:t.$t("quotation.请输入值")},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"tag.value"}})],1)})),0)]),e("div",{staticClass:"mg-t-15"},[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.addPro("on")}}},[t._v(t._s(t.$t("quotation.添加")))])],1)])]),e("el-tab-pane",{attrs:{label:t.$t("quotation.商品链接添加"),name:"second"}},[e("el-form",[e("el-form-item",{attrs:{label:t.$t("quotation.商品链接：")}},[e("el-input",{staticClass:"mg-r-20",staticStyle:{width:"80%"},attrs:{placeholder:t.$t("quotation.请输入AliExpress商品链接")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.LinkAdd.apply(null,arguments)}},model:{value:t.LinkUrl,callback:function(e){t.LinkUrl=e},expression:"LinkUrl"}}),e("el-button",{attrs:{type:"primary"},on:{click:t.LinkAdd}},[t._v(t._s(t.$t("quotation.添加")))])],1)],1)],1)],1)],1),e("el-divider"),e("el-dialog",{attrs:{width:"40%",title:t.$t("quotation.编辑属性"),visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(e){t.innerVisible=e},close:t.closeEdit}},[e("div",{staticStyle:{"margin-left":"40px","margin-top":"20px"}},[e("div",{staticClass:"mg-b-20"},[t._v(" "+t._s(t.$t("quotation.规格名称："))+" "),t._l(t.dynamicTags2,(function(a,i){return e("el-tag",{key:i,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(a)}}},[t._v(" "+t._s(a.name)+" ")])})),t.inputVisible2?e("el-input",{ref:"saveTagInput2",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm2},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm2.apply(null,arguments)}},model:{value:t.inputValue2,callback:function(e){t.inputValue2=e},expression:"inputValue2"}}):e("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput2}},[t._v(t._s(t.$t("quotation.+ 自定义")))])],2),e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{width:"76px","padding-top":"14px"}},[t._v(" "+t._s(t.$t("quotation.规格值："))+" ")]),e("div",t._l(t.dynamicTags2,(function(a,i){return e("div",{key:i,staticClass:"mg-t-10 d-flex"},[e("span",[t._v(t._s(a.name)+": ")]),e("el-input",{ref:"saveTagInput2",refInFor:!0,staticClass:"input-new-tag",attrs:{size:"small",placeholder:t.$t("quotation.请输入值")},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"tag.value"}})],1)})),0)])]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addPro()}}},[t._v(t._s(t.$t("quotation.修改")))])],1)]),e("div",{staticStyle:{padding:"20px 0"}},[e("b",{staticClass:"mg-t-20"},[t._v(t._s(t.$t("quotation.商品规格列表")))]),e("el-table",{ref:"gridTable2",staticStyle:{width:"100%"},attrs:{data:t.productList.stocks,stripe:"","row-key":"id"}},[e("el-table-column",{attrs:{label:t.$t("quotation.名称")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{model:{value:a.row.name,callback:function(e){t.$set(a.row,"name",e)},expression:"scope.row.name"}})]}}])}),e("el-table-column",{attrs:{label:"SKU"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{model:{value:a.row.vendorSku,callback:function(e){t.$set(a.row,"vendorSku",e)},expression:"scope.row.vendorSku"}})]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.属性")},scopedSlots:t._u([{key:"default",fn:function(a){return[t._l(a.row.propertyName.split("||"),(function(i,s){return e("div",{key:i},[t._v(" "+t._s(i)+" : "+t._s(a.row.propertyValue.split("||")[s])+" ")])})),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.editProper(a.row)}}},[t._v(t._s(t.$t("quotation.编辑")))])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.报价($)"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input-number",{staticStyle:{width:"140px"},attrs:{precision:2,controls:!1},model:{value:a.row.price,callback:function(e){t.$set(a.row,"price",e)},expression:"scope.row.price"}})]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.操作"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.delProper(a)}}},[t._v(t._s(t.$t("quotation.删除")))])]}}])})],1)],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.addProductVis=!1}}},[t._v(t._s(t.$t("mycustomer.取 消")))]),e("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v(t._s(t.$t("quotation.保存并完成报价")))])],1)],1),e("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,visible:t.ProductDetailbody,width:"70%",title:t.$t("quotation.报价详情")},on:{close:function(e){t.ProductDetailbody=!1}}},[e("el-divider"),e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.基础信息")))]),e("el-form",{attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{label:t.$t("quotation.图片："),"label-width":"150px"}},[e("div",{staticClass:"upload"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.nowItemDetail.imgUrl,"z-index":9999,fit:"cover","preview-src-list":[t.nowItemDetail.imgUrl]}})],1)]),e("el-form-item",{attrs:{label:t.$t("quotation.描述"),"label-width":"150px"}},[e("span",[t._v(t._s(t.nowItemDetail.detail))])]),e("el-form-item",{attrs:{label:t.$t("quotation.期望价格"),"label-width":"150px"}},[t.nowItemDetail.expectPrice&&"0.00"!=t.nowItemDetail.expectPrice?e("span",[t._v(" "+t._s(t.nowItemDetail.expectPrice))]):e("span",[t._v("/")])]),e("el-form-item",{attrs:{label:t.$t("quotation.备注"),"label-width":"150px"}},[e("span",[t._v(t._s(t.nowItemDetail.remarks))])])],1),e("el-divider"),e("div",{staticStyle:{padding:"20px 0"}},[e("b",{staticClass:"mg-t-20"},[t._v(t._s(t.$t("quotation.商品规格列表")))]),e("el-table",{ref:"gridTable2",staticStyle:{width:"100%"},attrs:{data:t.nowItemDetail.offerPrices,stripe:"","row-key":"id"}},[e("el-table-column",{attrs:{label:t.$t("quotation.名称")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.productName))])]}}])}),e("el-table-column",{attrs:{label:"SKU"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.vendorSku))])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.属性")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.propertyName?e("div",t._l(a.row.propertyName.split("||"),(function(i,s){return e("div",{key:i},[t._v(" "+t._s(i)+" : "+t._s(a.row.variableId.split("||")[s])+" ")])})),0):e("div",[t._v("---")])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.报价($)"),width:"160"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.price))])]}}])})],1)],1)],1)],1),e("div",{staticClass:"dialog-body"},[e("div",{staticStyle:{padding:"20px"}},[e("el-divider"),e("el-table",{ref:"gridTable3",staticStyle:{width:"100%"},attrs:{data:t.productDetailList,stripe:"","row-key":"id",height:"500"}},[e("el-table-column",{attrs:{label:t.$t("quotation.图片"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{height:"70px",width:"70px"},attrs:{src:t.row.imgUrl,"z-index":9999,fit:"cover","preview-src-list":[t.row.imgUrl]}})]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.描述"),prop:"detail"}}),e("el-table-column",{attrs:{label:t.$t("quotation.期望价格"),prop:"expectPrice"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.expectPrice&&"0.00"!=a.row.expectPrice?e("span",[t._v(" "+t._s(a.row.expectPrice)+" ")]):e("span",[t._v(" / ")])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.备注"),prop:"remarks"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.remarks?e("span",[t._v(t._s(a.row.remarks))]):e("span",[t._v("---")])]}}])}),e("el-table-column",{attrs:{label:t.$t("quotation.操作")},scopedSlots:t._u([{key:"default",fn:function(a){return[9!=t.filterParams.status?e("div",[a.row.offerPrices&&0!=a.row.offerPrices.length?e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.proDetail(a)}}},[t._v(t._s(t.$t("quotation.报价详情")))]):e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.addProduct(a.row)}}},[t._v(t._s(t.$t("quotation.提交商品")))])],1):e("div",[t._v(" --- ")])]}}])})],1)],1)])],1)],1)},s=[],o=(a("14d9"),{props:{},data(){return{productDetailList:[],ProductDetailbody:!1,isReady:!0,propertyList2:[],nowItemDetail:{},ProductDetailVis:!1,offerId:"",index:"",innerVisible:!1,nowItem:{},addLoading:!1,propertyList:[],productList:{stocks:[]},importId:"",uploadFile:"",LinkUrl:"",activeName:"first",items:[],datailList:[],loading:!1,addProductVis:!1,filterParams:{code:"",customerId:"",customer:"",accountId:"",account:"",status:"",type:"2",date:[],timeCreatedFrom:"",timeCreatedTo:""},dynamicTags:[],dynamicTags2:[],inputVisible2:!1,inputValue2:"",inputVisible:!1,inputValue:"",filterParamsDefault:"{}",quotationDetail:!1,pageSizes:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("myQuotationRowsPerPage")?Number(localStorage.getItem("myQuotationRowsPerPage")):10,total:0,totalPage:0,getShopNameInput:{shopList:[],loading:!1},selectLoading:!1,selectArr:[]}},watch:{$route:"gotoPage"},mounted(){this.filterParamsDefault=JSON.stringify(this.filterParams),this.getItem()},methods:{close(){this.selectArr=[],this.filterParams.customerId=this.filterParams.customer="",this.getItem()},remoteMethodCustom(t){this.selectArr=[],t&&(this.selectLoading=!0,this.$apiCall("api.Relationship.findByVendor",{name:t},t=>{this.selectLoading=!1,9999==t.ErrorCode?this.selectArr=t.Data.Results:this.$message({message:t.Message,type:"error"})}))},completeQuotation(t){this.loading=!0,this.$apiCall("api.OfferList.completeOffer",{id:t.id},t=>{this.loading=!1,9999==t.ErrorCode?(this.getItem(),this.$message({message:this.$t("quotation.完成报价成功"),type:"success"})):this.$message({message:t.Message,type:"error"})})},proDetail(t){this.nowItemDetail=this.productDetailList[t.$index],this.productDetailList[t.$index].offerPrices[0]&&this.productDetailList[t.$index].offerPrices[0].propertyName?this.propertyList2=this.productDetailList[t.$index].offerPrices[0].propertyName.split("||"):this.propertyList2=[],this.ProductDetailbody=!0},getShopName(t){this.getShopNameInput.shopList=[],t&&(this.getShopNameInput.loading=!0,this.$apiCall("api.Invoice.findStoreByVendor",{shopName:t},t=>{this.getShopNameInput.loading=!1,9999==t.ErrorCode?this.getShopNameInput.shopList=t.Data.Results:this.$message({message:t.Message,type:"error"})}))},delProper(t){let e=t.$index;this.productList.stocks.splice(e,1),this.$elementMessage(this.$t("quotation.删除成功"),"success")},handleChange(t){this.loading=!0,this.$apiCall("api.OfferList.importByVendor",{id:this.importId,"@file":t.raw},t=>{this.loading=!1,"9999"==t.ErrorCode?this.$elementMessage(this.$t("quotation.导入成功"),"success"):this.$elementMessage(t.Message,"error")})},closeAdd(){this.addProductVis=!1,this.productList={stocks:[]},this.dynamicTags=[],this.propertyList=[],this.LinkUrl="",this.activeName="first"},closeEdit(){this.dynamicTags2=[],this.inputVisible2=!1,this.inputValue2=""},editProper(t){this.productList.stocks.forEach((e,a)=>{e==t&&(this.index=a)});let e=t.propertyName.split("||");e.forEach((e,a)=>{this.dynamicTags2.push({name:e,value:t.propertyValue.split("||")[a]})}),this.innerVisible=!0},addPro(t){if(t){let t=[];this.propertyList=[],this.dynamicTags.forEach(e=>{t.push(e.value),this.propertyList.push(e.name)}),this.productList.propertyName=this.propertyList.join("||");let e=!1;if(this.productList.stocks.forEach(a=>{a.propertyValue==t.join("||")&&a.propertyName==this.propertyList.join("||")&&(this.$elementMessage(this.$t("quotation.不能添加重复属性"),"error"),e=!0)}),e)return!1;this.productList.stocks.push({name:"",price:"",propertyValue:t.join("||"),propertyName:this.propertyList.join("||"),vendorSku:""}),this.$elementMessage(this.$t("quotation.添加成功"),"success")}else{let t=[],e=[],a=!1;if(this.dynamicTags2.forEach(a=>{t.push(a.value),e.push(a.name)}),this.productList.stocks.forEach(i=>{i.propertyValue==t.join("||")&&i.propertyName==e.join("||")&&(this.$elementMessage(this.$t("quotation.该属性已存在"),"error"),a=!0)}),0!=a)return!1;this.productList.stocks[this.index].propertyValue=t.join("||"),this.productList.stocks[this.index].propertyName=e.join("||"),this.innerVisible=!1,this.$elementMessage(this.$t("quotation.编辑成功"),"success")}},save(){this.addLoading=!0;let t=this.productList.stocks;t.forEach(t=>{t.productName=t.name}),this.$apiCall("api.OfferList.completeByVendor",{id:this.offerId,offerId:this.nowItem.offerId,skuArr:t},t=>{this.addLoading=!1,9999==t.ErrorCode?(this.$elementMessage(this.$t("quotation.保存成功"),"success"),this.getItem(),this.addProductVis=!1,this.ProductDetailVis=!1):this.$message({message:t.Message,type:"error"})})},handleClose(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput(){this.inputVisible=!0,this.$nextTick(()=>{this.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm(){this.inputValue&&this.dynamicTags.push({name:this.inputValue,value:""}),this.inputVisible=!1,this.inputValue=""},showInput2(){this.inputVisible2=!0,this.$nextTick(()=>{this.$refs.saveTagInput2.$refs.input.focus()})},handleInputConfirm2(){this.inputValue2&&this.dynamicTags2.push({name:this.inputValue2,value:""}),this.inputVisible2=!1,this.inputValue2=""},importPro(t){this.importId=t.id},exportPro(t){this.loading=!0,0==$("#ifilePro").length&&$("body").append('<iframe id="ifilePro" style="display:none"></iframe>'),this.$apiCall("api.OfferList.exportByVendor",{id:t.id},t=>{9999==t.ErrorCode?(this.loading=!1,this.$elementMessage(this.$t("quotation.导出成功"),"success"),document.getElementById("ifilePro").src=t.Data.Results.file):this.$message({message:t.Message,type:"error"})})},LinkAdd(){this.addLoading=!0,this.$apiCall("api.OfferList.getByUrl",{url:this.LinkUrl},t=>{this.addLoading=!1,9999==t.ErrorCode?(t.Data.Results.stocks.forEach(e=>{e.name=t.Data.Results.productName,e.propertyName=t.Data.Results.propertyName}),this.productList=t.Data.Results,this.propertyList=this.productList.propertyName.split("||"),this.$elementMessage(this.$t("quotation.添加成功"),"success")):this.$message({message:t.Message,type:"error"})})},addProduct(t){this.nowItem=t,this.offerId=t.id,this.addProductVis=!0},toPage(t){t!=this.$route.query.page&&this.$router.push({query:{page:t}})},changePageSize(t){this.rowsPerPage=t,localStorage.setItem("myQuotationRowsPerPage",t),this.getItem()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()},getItem(){this.loading=!0,this.$apiCall("api.OfferList.findByVendor",{status:this.filterParams.status,type:this.filterParams.type,customerId:this.filterParams.customerId,accountId:this.filterParams.accountId,code:this.filterParams.code,timeCreatedFrom:this.filterParams.timeCreatedFrom,timeCreatedTo:this.filterParams.timeCreatedTo,page:this.page,rowsPerPage:this.rowsPerPage},t=>{this.loading=!1,9999==t.ErrorCode?(this.items=t.Data.Results,this.total=Number(t.Data.Pagination.totalCount),this.totalPage=Number(t.Data.Pagination.totalPage),this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0):this.$message({message:t.Message,type:"error"})})},dateChange(){this.filterParams.date.length>1&&(this.filterParams.timeCreatedFrom=this.$moment(this.filterParams.date[0]).format("YYYY-MM-DD"),this.filterParams.timeCreatedTo=this.$moment(this.filterParams.date[1]).format("YYYY-MM-DD"),this.filterItem())},getOrder(t){this.$apiCall("api.OfferList.getDetailByVendor",{id:t.id},t=>{9999==t.ErrorCode?this.datailList=t.Data.Results:this.$message({message:t.Message,type:"error"})}),this.quotationDetail=!0},getProduct(t){this.$apiCall("api.OfferList.getDetailByVendor",{id:t.id},t=>{9999==t.ErrorCode?(this.productDetailList=t.Data.Results,this.ProductDetailVis=!0):this.$message({message:t.Message,type:"error"})})},clearFilter(t){switch(t){case"code":this.filterParams.code="";break;case"customerId":this.filterParams.customerId="",this.filterParams.accountId="";break;case"type":this.filterParams.type="";break;case"date":this.filterParams.date=[],this.filterParams.timeCreatedFrom="",this.filterParams.timeCreatedTo="";break;default:this.filterParams=JSON.parse(this.filterParamsDefault);break}this.filterItem()},filterItem(t){"cust"==t?(this.selectArr.forEach(t=>{t.customerName==this.filterParams.customer&&(this.filterParams.customerId=t.customerId)}),this.getItem()):1==this.$route.query.page?this.getItem():this.$router.push({query:{page:1}})}},components:{}}),r=o,l=(a("0d8b"),a("8ab8"),a("2877")),n=Object(l["a"])(r,i,s,!1,null,"5a14bcca",null);e["default"]=n.exports},"8ab8":function(t,e,a){"use strict";a("e0d9")},"934d":function(t,e,a){},e0d9:function(t,e,a){}}]);