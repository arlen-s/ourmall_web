(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["menuSetting"],{15752:function(e,t,n){"use strict";n("8bed")},"8bed":function(e,t,n){},e9c1:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"contentpanel menu-setting-page"},[n("div",{ref:"pageHeader",staticClass:"pagetitle"},[n("div",{staticClass:"left"},[n("div",{staticClass:"title"},[n("i",{staticClass:"el-icon-menu"}),n("h2",[e._v(e._s(e.$t("storeSetting.菜单导航")))]),e._v(" "),n("span",[e._v(e._s(e.$t("menuSetting.你可以在此设置菜单，装修店铺顶部导航、页尾时，可手动关联对应的菜单")))])])]),n("div",{staticClass:"right"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!e.$isRole(e.$route.meta.roleWrite)},on:{click:function(t){return e.openEditMenu()}}},[e._v(e._s(e.$t("menuSetting.新增菜单")))])],1)]),n("div",{staticClass:"pagebody"},[n("el-card",[n("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{data:e.items,stripe:"","row-key":"id"}},[n("el-table-column",{attrs:{label:e.$t("menuSetting.菜单名称"),prop:"name",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))]),t.row.id<3?n("span",{staticClass:"tx-danger"},[e._v(" ("+e._s(e.$t("menuSetting.不可删除"))+")")]):e._e()]}}])}),n("el-table-column",{attrs:{label:e.$t("menuSetting.菜单一级目录")},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.menu,(function(t){return n("el-tag",{key:t.id,staticStyle:{"margin-right":"10px"},attrs:{type:"info",effect:"plain"}},[e._v(" "+e._s(t.label)+" ")])}))}}])}),n("el-table-column",{attrs:{label:e.$t("menuSetting.操作"),width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small",disabled:!e.$isRole(e.$route.meta.roleWrite)},on:{click:function(n){return e.openEditMenu(t.row)}}},[e._v(e._s(e.$t("menuSetting.编辑")))]),t.row.id>2?n("el-button",{attrs:{type:"danger",size:"small",disabled:!e.$isRole(e.$route.meta.roleWrite)},on:{click:function(n){return e.delMenu(t.row)}}},[e._v(e._s(e.$t("menuSetting.删除")))]):e._e()]}}])})],1)],1),this.$store.state.configJson.menu.length?n("el-row",{attrs:{gutter:20}},[n("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[n("div",{staticStyle:{position:"relative",top:"10px"}},[n("el-pagination",{attrs:{"current-page":e.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":e.pageSize,"page-size":e.rowsPerPage,total:e.totalCount},on:{"current-change":e.toPage,"size-change":e.changePageSize}})],1)])],1):e._e()],1)])},i=[],o=(n("a9e3"),n("b0c0"),n("fb6a"),n("e9c4"),{data:function(){return{pageLoading:!1,page:this.$route.query.page?Number(this.$route.query.page):1,pageSize:[10,20,50,100],rowsPerPage:localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))?Number(localStorage.getItem("".concat(this.$route.name,"RowsPerPage"))):10}},computed:{items:function(){var e=(this.page-1)*this.rowsPerPage,t=this.page*this.rowsPerPage;return this.$store.state.configJson.menu.slice(e,t)},totalCount:function(){return this.$store.state.configJson.menu.length},totalPage:function(){return Math.ceil(this.$store.state.configJson.menu.length/this.rowsPerPage)}},mounted:function(){this.getConfig()},methods:{delMenu:function(e){var t=this;this.$confirm(this.$t("menuSetting.是否要删除菜单"),"",{confirmButtonText:this.$t("products.删除"),cancelButtonText:this.$t("products.取消"),confirmButtonClass:"el-button--danger"}).then((function(){t.$store.commit("delMenu",e.id),t.pageLoading=!0,t.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(t.$store.state.configJson)},(function(e){t.pageLoading=!1,9999==e.ErrorCode?(t.$elementMessage(t.$t("shop.删除成功"),"success"),t.page>t.totalPage&&(t.page=t.totalPage)):t.$message({message:e.Message,type:"error"})}))}))},getConfig:function(){var e=this;this.pageLoading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},(function(t){e.pageLoading=!1,9999==t.ErrorCode&&0!==t.Data.Results.length&&(e.$store.commit("getShopConfig",t.Data.Results),t.Data.Results.menu&&t.Data.Results.menu.length||e.$store.commit("getDefaultMenu"))}))},openEditMenu:function(e){e?this.$router.push({name:"menuEditor",query:{id:e.id}}):this.$router.push({name:"menuEditor",query:{id:(new Date).getTime()}})},changePageSize:function(e){this.rowsPerPage=e,localStorage.setItem("".concat(this.$route.name,"RowsPerPage"),e)},toPage:function(e){this.page=e,this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0}}}),s=o,r=(n("15752"),n("2877")),u=Object(r["a"])(s,a,i,!1,null,"3b473726",null);t["default"]=u.exports},fb6a:function(e,t,n){"use strict";var a=n("23e7"),i=n("e8b5"),o=n("68ee"),s=n("861d"),r=n("23cb"),u=n("07fa"),l=n("fc6a"),c=n("8418"),g=n("b622"),p=n("1dde"),d=n("f36a"),m=p("slice"),f=g("species"),h=Array,$=Math.max;a({target:"Array",proto:!0,forced:!m},{slice:function(e,t){var n,a,g,p=l(this),m=u(p),v=r(e,m),b=r(void 0===t?m:t,m);if(i(p)&&(n=p.constructor,o(n)&&(n===h||i(n.prototype))?n=void 0:s(n)&&(n=n[f],null===n&&(n=void 0)),n===h||void 0===n))return d(p,v,b);for(a=new(void 0===n?h:n)($(b-v,0)),g=0;v<b;v++,g++)v in p&&c(a,g,p[v]);return a.length=g,a}})}}]);