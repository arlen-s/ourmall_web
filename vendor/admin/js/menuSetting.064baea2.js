(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["menuSetting"],{4990:function(t,e,s){},e9c1:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"contentpanel menu-setting-page"},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"el-icon-menu"}),e("h2",[t._v(t._s(t.$t("storeSetting.菜单导航")))]),t._v(" "),e("span",[t._v(t._s(t.$t("menuSetting.你可以在此设置菜单，装修店铺顶部导航、页尾时，可手动关联对应的菜单")))])])]),e("div",{staticClass:"right"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.openEditMenu()}}},[t._v(t._s(t.$t("menuSetting.新增菜单")))])],1)]),e("div",{staticClass:"pagebody"},[e("el-card",[e("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{data:t.items,stripe:"","row-key":"id"}},[e("el-table-column",{attrs:{label:t.$t("menuSetting.菜单名称"),prop:"name",width:"350"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.name))]),s.row.id<3?e("span",{staticClass:"tx-danger"},[t._v(" ("+t._s(t.$t("menuSetting.不可删除"))+")")]):t._e()]}}])}),e("el-table-column",{attrs:{label:t.$t("menuSetting.菜单一级目录")},scopedSlots:t._u([{key:"default",fn:function(s){return t._l(s.row.menu,(function(s){return e("el-tag",{key:s.id,staticStyle:{"margin-right":"10px"},attrs:{type:"info",effect:"plain"}},[t._v(" "+t._s(s.label)+" ")])}))}}])}),e("el-table-column",{attrs:{label:t.$t("menuSetting.操作"),width:"250"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"primary",size:"small",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.openEditMenu(s.row)}}},[t._v(t._s(t.$t("menuSetting.编辑")))]),s.row.id>2?e("el-button",{attrs:{type:"danger",size:"small",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.delMenu(s.row)}}},[t._v(t._s(t.$t("menuSetting.删除")))]):t._e()]}}])})],1)],1),this.$store.state.configJson.menu.length?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",{staticStyle:{position:"relative",top:"10px"}},[e("el-pagination",{attrs:{"current-page":t.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"page-size":t.rowsPerPage,total:t.totalCount},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1)])},i=[],n=(s("14d9"),{data(){return{pageLoading:!1,page:this.$route.query.page?Number(this.$route.query.page):1,pageSize:[10,20,50,100],rowsPerPage:localStorage.getItem(this.$route.name+"RowsPerPage")?Number(localStorage.getItem(this.$route.name+"RowsPerPage")):10}},computed:{items(){let t=(this.page-1)*this.rowsPerPage,e=this.page*this.rowsPerPage;return this.$store.state.configJson.menu.slice(t,e)},totalCount(){return this.$store.state.configJson.menu.length},totalPage(){return Math.ceil(this.$store.state.configJson.menu.length/this.rowsPerPage)}},mounted(){this.getConfig()},methods:{delMenu(t){this.$confirm(this.$t("menuSetting.是否要删除菜单"),"",{confirmButtonText:this.$t("products.删除"),cancelButtonText:this.$t("products.取消"),confirmButtonClass:"el-button--danger"}).then(()=>{this.$store.commit("delMenu",t.id),this.pageLoading=!0,this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},t=>{this.pageLoading=!1,9999==t.ErrorCode?(this.$elementMessage(this.$t("shop.删除成功"),"success"),this.page>this.totalPage&&(this.page=this.totalPage)):this.$message({message:t.Message,type:"error"})})})},getConfig(){this.pageLoading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},t=>{this.pageLoading=!1,9999==t.ErrorCode&&0!==t.Data.Results.length&&(this.$store.commit("getShopConfig",t.Data.Results),t.Data.Results.menu&&t.Data.Results.menu.length||this.$store.commit("getDefaultMenu"))})},openEditMenu(t){t?this.$router.push({name:"menuEditor",query:{id:t.id}}):this.$router.push({name:"menuEditor",query:{id:(new Date).getTime()}})},changePageSize(t){this.rowsPerPage=t,localStorage.setItem(this.$route.name+"RowsPerPage",t)},toPage(t){this.page=t,this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0}}}),o=n,r=(s("f8f0"),s("2877")),l=Object(r["a"])(o,a,i,!1,null,"3b473726",null);e["default"]=l.exports},f8f0:function(t,e,s){"use strict";s("4990")}}]);