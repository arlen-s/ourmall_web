(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["storeSettingProductCategory"],{"308b":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"setting-page"},[s("el-scrollbar",{staticClass:"left"},[s("div",{staticClass:"content"},[s("h1",{on:{click:t.goBack}},[s("el-link",{attrs:{icon:"el-icon-arrow-left",underline:!1}},[t._v(t._s(t.$t("storeSetting.商品类目")))])],1),s("div",{staticClass:"change-content"},[s("div",[t._v(t._s(t.$t("storeSetting.商品类目"))+" "+t._s(t.setting.categorys.length)+"/"+t._s(t.setting.cntPerRows*this.setting.rows))]),s("div",{staticClass:"category-p"},[t._v(t._s(t.$t("storeSetting.如需更换分类封面图可前往商品分类管理进行配置"))+" "),s("router-link",{attrs:{to:"/category-mgr"}},[t._v(t._s(t.$t("storeSetting.立即前往")))])],1),s("draggable",{attrs:{handle:".draggable-i"},model:{value:t.setting.categorys,callback:function(e){t.$set(t.setting,"categorys",e)},expression:"setting.categorys"}},t._l(t.setting.categorys,(function(e,i){return s("div",{key:i,staticClass:"category-select draggable-i"},[s("i",{staticClass:"iconfont icon-draggable"}),s("el-image",{staticClass:"mg-l-5 img",attrs:{src:e.themeUrl,fit:"contain"}}),s("div",{staticClass:"mg-l-5 name"},[t._v(t._s(e.name))]),s("i",{staticClass:"delete el-icon-delete",on:{click:function(e){return t.deleteCategory(i)}}})],1)})),0),t.selectedIds.length<t.setting.rows*t.setting.cntPerRows?s("div",{staticClass:"add-category",on:{click:t.addCategory}},[s("i",{staticClass:"el-icon-circle-plus"}),s("div",{staticClass:"mg-l-5"},[t._v(t._s(t.$t("storeSetting.添加商品分类")))])]):s("div",{staticClass:"notice"},[t._v(" "+t._s(t.$t("storeSetting.类目已经达到上限请先删除再添加"))+" ")])],1),s("div",{staticClass:"change-content mt-20"},[s("el-form",{ref:"category-form",attrs:{size:"mini"}},[s("el-form-item",{attrs:{label:t.$t("storeSetting.标题")}},[s("el-input",{staticStyle:{width:"210px"},model:{value:t.setting.title,callback:function(e){t.$set(t.setting,"title",e)},expression:"setting.title"}})],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.展示排数(最多可展示4排)")}},[s("el-input-number",{staticStyle:{width:"210px"},attrs:{"controls-position":"right",min:1,max:4},on:{change:t.rowsChange},model:{value:t.setting.rows,callback:function(e){t.$set(t.setting,"rows",e)},expression:"setting.rows"}})],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.每排展示个数(每排最多可展示4排)")}},[s("el-input-number",{staticStyle:{width:"210px"},attrs:{"controls-position":"right",min:1,max:4},on:{change:t.perChange},model:{value:t.setting.cntPerRows,callback:function(e){t.$set(t.setting,"cntPerRows",e)},expression:"setting.cntPerRows"}})],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.更多按钮文案")}},[s("el-input",{staticStyle:{width:"210px"},model:{value:t.setting.moreText,callback:function(e){t.$set(t.setting,"moreText",e)},expression:"setting.moreText"}})],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.图片比例")}},[s("el-select",{staticStyle:{width:"210px"},model:{value:t.setting.proportion,callback:function(e){t.$set(t.setting,"proportion",e)},expression:"setting.proportion"}},[s("el-option",{attrs:{value:"1",label:"1:1"}}),s("el-option",{attrs:{value:"1.5",label:"2:3"}}),s("el-option",{attrs:{value:"0.666",label:"3:2"}}),s("el-option",{attrs:{value:"1.333",label:"3:4"}}),s("el-option",{attrs:{value:"0.75",label:"4:3"}})],1)],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.图片填充方式")}},[s("el-select",{staticStyle:{width:"210px"},model:{value:t.setting.fillWay,callback:function(e){t.$set(t.setting,"fillWay",e)},expression:"setting.fillWay"}},[s("el-option",{attrs:{value:"fill",label:"$t('storeSetting.填充')"}}),s("el-option",{attrs:{value:"contain",label:"$t('storeSetting.适应')"}})],1)],1),s("el-form-item",{attrs:{label:t.$t("storeSetting.链接打开方式")}},[s("el-radio-group",{model:{value:t.setting.target,callback:function(e){t.$set(t.setting,"target",e)},expression:"setting.target"}},[s("el-radio",{attrs:{label:"_self"}},[t._v(t._s(t.$t("storeSetting.当前页面打开链接")))]),s("el-radio",{attrs:{label:"_blank"}},[t._v(t._s(t.$t("storeSetting.新开窗口打开链接")))])],1)],1)],1)],1)])]),s("div",{staticClass:"action"},[s("el-button",{attrs:{type:"danger",size:"medium"},on:{click:t.del}},[t._v(t._s(t.$t("storeSetting.删除该组件")))]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.saveData}},[t._v(t._s(t.$t("storeSetting.完成")))])],1),s("el-scrollbar",{ref:"rightBox",staticClass:"right"},[s("div",{staticClass:"content"},[s("demoHeader",{attrs:{data:t.$store.state.configJson.header,headerMenu:t.headerMenu}}),s("demoBody",{attrs:{data:t.setting,header:t.$store.state.configJson.header}}),s("demoFooter",{attrs:{setting:t.$store.state.configJson.footer}})],1)]),s("el-dialog",{attrs:{title:t.$t("storeSetting.商品分类"),width:"300px",visible:t.addCategoryVisible},on:{"update:visible":function(e){t.addCategoryVisible=e}}},[s("div",{staticClass:"dialog-area"},[s("div",{staticClass:"search"},[s("el-input",{attrs:{size:"mini","suffix-icon":"el-icon-search"},on:{input:t.searchCategory},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),s("el-scrollbar",[t.displayItems.length>0?s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.cLoading,expression:"cLoading"}],staticClass:"item-area"},[t._l(t.displayItems,(function(e,i){return[-1==t.selectedIds.indexOf(e.id)?s("div",{key:i},[s("div",{staticClass:"item-list"},[s("div",{staticClass:"left"},[s("el-image",{staticClass:"image",attrs:{fit:"contain",src:e.themeUrl}}),s("div",{staticClass:"name"},[t._v(t._s(e.name))])],1),s("div",[s("el-checkbox",{attrs:{label:e},model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}},[s("div",{staticStyle:{display:"none"}},[t._v("1")])])],1)]),s("el-divider")],1):t._e()]})),t.selectedIds.length==t.displayItems.length?s("div",{staticClass:"no-category"},[t._v(" "+t._s(t.$t("storeSetting.暂无更多类目"))+" ")]):t._e(),s("div",{staticStyle:{height:"20px"}})],2):t._e()]),0==t.displayItems.length?s("div",{staticClass:"no-category"},[t._v(" "+t._s(t.$t("storeSetting.暂无类目"))+" "),s("router-link",{attrs:{to:"/category-mgr"}},[t._v(t._s(t.$t("storeSetting.前去添加")))])],1):t._e(),s("div",{staticClass:"control"},[s("router-link",{staticClass:"mg-r-20",attrs:{to:"/category-mgr"}},[t._v(t._s(t.$t("storeSetting.管理商品类目")))]),s("i",{staticClass:"refresh mg-r-20 el-icon-refresh",on:{click:t.getCategory}}),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addCategoryHandle}},[t._v(t._s(t.$t("storeSetting.添加"))+" ")])],1)],1)])],1)},o=[],n=s("7980"),a=(s("2027"),s("ba49"),s("5ede"),s("5972"),s("39dd"),s("f433"),s("5f8e"),s("8745"),s("4f85")),r=s("826e"),l=s("db46"),c=s("8c3c"),g=s("3335"),d=s.n(g),u={data:function(){return{keyword:"",selectedIds:[],cLoading:!1,selectedItems:[],headerMenu:[],addCategoryVisible:!1,editorOption:{modules:{syntax:{highlight:function(t){return hljs.highlightAuto(t).value}},toolbar:{container:[["bold","italic","underline","strike"]]}},placeholder:this.$t("goodsEdit.编辑商品描述")},isSave:!1,setting:{cid:this.$route.query.cid,type:"productCategory",title:"",rows:2,cntPerRows:3,moreText:"",proportion:"1",fillWay:"cover",target:"_blank",categorys:[]},items:[],exist:!1,displayItems:[]}},components:{Category:a["a"],demoHeader:r["a"],draggable:d.a,demoBody:c["a"],demoFooter:l["a"]},beforeRouteLeave:function(t,e,s){if(this.isSave)s();else{var i=confirm(this.$t("logistics.当前页面还未保存，确定要离开吗?"));i?s():s(!1)}},created:function(){this.getCategory()},methods:{rowsChange:function(t,e){t*this.setting.cntPerRows<this.setting.categorys.length&&(this.setting.categorys.splice(t*this.setting.cntPerRows-1,this.setting.categorys.length-t*this.setting.cntPerRows),this.selectedIds.splice(t*this.setting.cntPerRows-1,this.selectedIds.length-t*this.setting.cntPerRows))},perChange:function(t,e){t*this.setting.rows<this.setting.categorys.length&&(this.setting.categorys.splice(t*this.setting.rows-1,this.setting.categorys.length-t*this.setting.rows),this.selectedIds.splice(t*this.setting.rows-1,this.selectedIds.length-t*this.setting.rows))},del:function(){var t=this;this.isSave=!0,this.$store.commit("delComponent",this.setting.cid),this.setting=JSON.parse(JSON.stringify(this.$store.state.configJson)),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},(function(e){9999==e.ErrorCode?(t.$elementMessage("删除成功","success"),t.$router.replace({name:"storeSettingMain"})):t.$message({message:e.Message,type:"error"})}))},deleteCategory:function(t){this.selectedIds.splice(t,1),this.setting.categorys.splice(t,1)},searchCategory:function(t){var e=[];this.items.forEach((function(s){s.name.indexOf(t)>-1&&e.push(s)})),this.displayItems=e,console.log(this.displayItems)},addCategoryHandle:function(){var t,e=this,s=this.setting.rows*this.setting.cntPerRows;this.selectedIds.length+this.selectedItems.length>s?this.$elementMessage(this.$t("storeSetting.超出限制数量"),"error"):(this.selectedItems.forEach((function(t){e.selectedIds.push(t.id)})),(t=this.setting.categorys).push.apply(t,Object(n["a"])(this.selectedItems)),this.selectedItems=[],this.addCategoryVisible=!1)},getCategory:function(){var t=this;this.cLoading=!0,this.$apiCall("api.ProductCategory.findByUser",{level:1},(function(e){setTimeout((function(){t.cLoading=!1}),500),9999==e.ErrorCode&&(t.items=e.Data.Results,t.displayItems=e.Data.Results,t.$apiCall("api.VendorShop.getShopConfig",{},(function(e){9999==e.ErrorCode&&0!==e.Data.Results.length&&(e.Data.Results.sort.forEach((function(e){if(e.cid==t.$route.query.cid){var s=[];e.categorys.forEach((function(e){t.items.forEach((function(i){e.id==i.id&&(s.push(i),t.selectedIds.push(i.id))}))})),e.categorys=s,t.setting=JSON.parse(JSON.stringify(e)),t.exist=!0,t.$nextTick((function(){t.$refs.rightBox.wrap.scrollTop=document.getElementById("row".concat(e.cid)).offsetTop}))}})),t.$store.commit("getShopConfig",e.Data.Results),t.exist||(t.setting={cid:t.$route.query.cid,type:"productCategory",title:"",rows:2,cntPerRows:3,moreText:"",proportion:"1",fillWay:"cover",target:"_blank",categorys:[]},t.exist=!0,t.$store.commit("addStoreComponent",t.setting)))})))}))},addCategory:function(){this.addCategoryVisible=!0},goBack:function(){this.$router.push({name:"storeSettingMain"})},saveData:function(){var t=this;this.isSave=!0,this.exist&&(this.$store.commit("setStoreComponent",this.setting),this.$elementMessage("保存成功","success")),this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},(function(e){9999==e.ErrorCode?t.$elementMessage("保存成功","success"):t.$message({message:e.Message,type:"error"})}))}}},h=u,f=(s("be9f"),s("6152"),s("cba8")),m=Object(f["a"])(h,i,o,!1,null,"e211ef22",null);e["default"]=m.exports},3173:function(t,e,s){},3901:function(t,e,s){"use strict";var i=s("6dd3"),o=s("9699"),n=s("4a15"),a=s("14b4"),r=s("9801"),l=s("03e9"),c=s("1de0"),g=s("521d"),d=s("1657"),u=s("3d1e"),h=s("9b46"),f=s("906c"),m=h("slice"),p=u("species"),y=o.Array,v=Math.max;i({target:"Array",proto:!0,forced:!m},{slice:function(t,e){var s,i,o,u=g(this),h=c(u),m=l(t,h),b=l(void 0===e?h:e,h);if(n(u)&&(s=u.constructor,a(s)&&(s===y||n(s.prototype))?s=void 0:r(s)&&(s=s[p],null===s&&(s=void 0)),s===y||void 0===s))return f(u,m,b);for(i=new(void 0===s?y:s)(v(b-m,0)),o=0;m<b;m++,o++)m in u&&d(i,o,u[m]);return i.length=o,i}})},6152:function(t,e,s){"use strict";s("8653")},6586:function(t,e,s){var i=s("235f"),o=s("0635");t.exports=function(t,e,s,n){try{return n?e(i(s)[0],s[1]):e(s)}catch(a){o(t,"throw",a)}}},6860:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));s("3901"),s("39dd"),s("5f8e"),s("fc09"),s("55b1"),s("5ede"),s("ccbd");var i=s("a01c");function o(t,e){if(t){if("string"===typeof t)return Object(i["a"])(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?Object(i["a"])(t,e):void 0}}},7980:function(t,e,s){"use strict";s.d(e,"a",(function(){return l}));var i=s("a01c");function o(t){if(Array.isArray(t))return Object(i["a"])(t)}s("5ae2"),s("09be"),s("39dd"),s("00e8"),s("55b1"),s("3946"),s("fc09");function n(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var a=s("6860");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return o(t)||n(t)||Object(a["a"])(t)||r()}},8653:function(t,e,s){},a01c:function(t,e,s){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}s.d(e,"a",(function(){return i}))},be9f:function(t,e,s){"use strict";s("3173")},d902:function(t,e,s){"use strict";var i=s("9699"),o=s("4f4c"),n=s("a22c"),a=s("ed2b"),r=s("6586"),l=s("8d89"),c=s("14b4"),g=s("1de0"),d=s("1657"),u=s("40ec"),h=s("4557"),f=i.Array;t.exports=function(t){var e=a(t),s=c(this),i=arguments.length,m=i>1?arguments[1]:void 0,p=void 0!==m;p&&(m=o(m,i>2?arguments[2]:void 0));var y,v,b,C,$,S,w=h(e),_=0;if(!w||this==f&&l(w))for(y=g(e),v=s?new this(y):f(y);y>_;_++)S=p?m(e[_],_):e[_],d(v,_,S);else for(C=u(e,w),$=C.next,v=s?new this:[];!(b=n($,C)).done;_++)S=p?r(C,m,[b.value,_],!0):b.value,d(v,_,S);return v.length=_,v}},fc09:function(t,e,s){var i=s("6dd3"),o=s("d902"),n=s("329e"),a=!n((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:a},{from:o})}}]);