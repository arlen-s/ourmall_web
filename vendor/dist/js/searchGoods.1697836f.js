(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["searchGoods"],{"069c":function(t,e,a){t.exports=a.p+"img/noData.46b81b49.png"},"0959":function(t,e,a){},"0cd1":function(t,e,a){"use strict";a("3cb0")},"280b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel goods-mgr-page"},[e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-xunjia"}),e("h2",[t._v(t._s(t.$t("app.搜品管理")))])])]),e("div",{staticClass:"right"},[t.$store.state.userInfo.subUserId?t._e():e("div",["SGAssign"==t.$route.name&&t.isOpenAssign||"SGQuotation"==t.$route.name&&!t.isOpenAssign?[t.isOpenAssign?e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.changeAssign("close")}}},[t._v(t._s(t.$t("quotation.关闭分配")))]):e("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.changeAssign("open")}}},[t._v(t._s(t.$t("quotation.开启分配")))])]:t._e()],2)])]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[e("el-card",[e("el-row",[e("el-col",{attrs:{span:24}},[e("Sub",{key:t.pageKey,ref:"subPage",attrs:{loading:t.loading,items:t.items,filterData:t.filterData},on:{filterGetItem:t.filterGetItem,clearFilter:t.clearFilter,assign:t.assign}}),e("div",{ref:"tableFooter"},[t.items.length?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",{staticStyle:{position:"relative",top:"10px"}},[e("el-pagination",{attrs:{"current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1)],1)],1)],1)],1),e("el-dialog",{attrs:{visible:t.assignDialog,width:"500px"},on:{"update:visible":function(e){t.assignDialog=e}}},[e("div",{staticClass:"tx-center dialog-content",staticStyle:{padding:"20px"}},[t._v(" "+t._s(t.isOpenAssign?t.$t("quotation.是否确定关闭分配功能？确定后搜品请求直接在待报价状态"):t.$t("quotation.是否确定开启分配功能？确定后搜品请求需求分配后才能操作"))+" ")]),e("div",{staticClass:"dialog-footer d-flex justify-content-center",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.assignDialog=!1}}},[t._v(t._s(t.$t("quotation.取消")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.closeAssign()}}},[t._v(t._s(t.$t("quotation.确定")))])],1)]),e("el-dialog",{attrs:{visible:t.selectAssignDialog,width:"500px"},on:{"update:visible":function(e){t.selectAssignDialog=e},close:t.closeSelectAssign}},[e("div",{staticClass:"tx-center dialog-content",staticStyle:{padding:"20px"}},[e("el-form",[e("el-form-item",{attrs:{label:t.$t("quotation.请选择角色")}},[e("el-select",{staticStyle:{width:"320px"},attrs:{filterable:""},on:{change:t.staffChange},model:{value:t.form.roleId,callback:function(e){t.$set(t.form,"roleId",e)},expression:"form.roleId"}},t._l(t.roleList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),e("el-form-item",{attrs:{label:t.$t("quotation.请选择人员")}},[e("el-select",{staticStyle:{width:"320px"},attrs:{disabled:!t.isSetect,filterable:""},model:{value:t.form.staff,callback:function(e){t.$set(t.form,"staff",e)},expression:"form.staff"}},t._l(t.staffList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeSelectAssign}},[t._v(t._s(t.$t("quotation.取消")))]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.assignStaff()}}},[t._v(t._s(t.$t("quotation.分配")))])],1)])],1)},i=[],r=(a("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"goods-list-page"},[e("div",{ref:"tablefilter"},[e("div",{ref:"pageFilter",staticClass:"page-filter",staticStyle:{"border-bottom":"none"}},[t.filterData?e("el-form",{attrs:{inline:!0,size:"mini"}},[e("el-form-item",[e("el-input",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:t.$t("goods.商品名称")},on:{clear:function(e){return t.clearFilter("name")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem()}},model:{value:t.filterData.name,callback:function(e){t.$set(t.filterData,"name",e)},expression:"filterData.name"}})],1),e("el-form-item",["SGQuotation"==t.$route.name?e("el-select",{attrs:{filterable:"",remote:"","remote-method":t.remoteMethodCustom,loading:t.selectLoading,placeholder:t.$t("quotation.分配人"),clearable:""},on:{change:function(e){return t.filterGetItem()},clear:function(e){return t.clearFilter("subUserId")}},model:{value:t.filterData.subUserId,callback:function(e){t.$set(t.filterData,"subUserId",e)},expression:"filterData.subUserId"}},t._l(t.selectArr,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e()],1),e("el-form-item",["SGQuotation"!=t.$route.name&&"SGAssign"!=t.$route.name?e("el-select",{attrs:{filterable:"",remote:"","remote-method":t.remoteMethodCustom,loading:t.selectLoading,placeholder:t.$t("quotation.报价人"),clearable:""},on:{change:function(e){return t.filterGetItem()},clear:function(e){return t.clearFilter("subUserIdCompleted")}},model:{value:t.filterData.subUserIdCompleted,callback:function(e){t.$set(t.filterData,"subUserIdCompleted",e)},expression:"filterData.subUserIdCompleted"}},t._l(t.selectArr,(function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e()],1),e("el-form-item",["SGSearch"==t.$route.name?e("el-select",{attrs:{placeholder:t.$t("quotation.状态"),clearable:""},on:{change:function(e){return t.filterGetItem()},clear:function(e){return t.clearFilter("status")}},model:{value:t.filterData.type,callback:function(e){t.$set(t.filterData,"type",e)},expression:"filterData.type"}},[e("el-option",{attrs:{label:t.$t("quotation.待处理"),value:"1"}}),e("el-option",{attrs:{label:t.$t("quotation.已完成"),value:"2"}})],1):t._e()],1),e("el-form-item",{attrs:{label:t.$t("quotation.日期")}},[e("el-date-picker",{key:"date2",attrs:{"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","start-placeholder":"Start","end-placeholder":"End"},on:{clear:function(e){return t.clearFilter("date")},change:t.dateChange},model:{value:t.filterData.date,callback:function(e){t.$set(t.filterData,"date",e)},expression:"filterData.date"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"0"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterGetItem()}}},[t._v(t._s(t.$t("myinvoice.filter")))]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.clearFilter()}}},[t._v(t._s(t.$t("goods.重置")))])],1)],1):t._e()],1)]),e("div",{staticClass:"table-wrap",staticStyle:{"border-top":"1px #ebeef5 solid","padding-top":"5px"}},[t.items.length&&"SGAssign"==t.$route.name?e("div",{staticClass:"table-action"},[e("div",{staticClass:"mg-r-15"},[e("el-checkbox",{on:{change:t.changeAllCheckbox},model:{value:t.isAllCheck,callback:function(e){t.isAllCheck=e},expression:"isAllCheck"}},[e("span",{staticStyle:{color:"#606266","font-size":"12px"}},[t._v(t._s(t.$t("goods.全选/全不选"))+" ("+t._s(t.checkboxArr.length)+")")])])],1),e("div",[e("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.assignAll()}}},[t._v(t._s(t.$t("quotation.批量分配")))])],1)]):t._e(),t.items.length||t.loading?e("el-table",{key:"gridTable"+t.$route.name,ref:"gridTable"+t.$route.name,attrs:{data:t.items,stripe:""}},[t.items.length&&"SGAssign"==t.$route.name?e("el-table-column",{attrs:{label:"",width:"40"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-checkbox",{staticClass:"none-label",attrs:{label:a.row.id},model:{value:t.checkboxArr,callback:function(e){t.checkboxArr=e},expression:"checkboxArr"}})]}}],null,!1,2613777098)}):t._e(),e("el-table-column",{attrs:{label:t.$t("goods.商品名称"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.name?e("p",{staticClass:"tx-ellipsis3",staticStyle:{"line-height":"22px"}},[t._v(" "+t._s(a.row.name)+" ")]):e("p",[t._v("---")])]}}],null,!1,2426365836)}),e("el-table-column",{attrs:{label:t.$t("goods.商品图片")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.imgUrlArr?e("el-image",{staticStyle:{width:"80px",height:"80px",border:"1px solid #ddd","background-color":"#fff"},attrs:{src:a.row.imgUrlArr[0],fit:"contain","scroll-container":".main-scroll .el-scrollbar__wrap","preview-src-list":a.row.imgUrlArr,lazy:""}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})]),t._v("+ ")]):t._e()]}}],null,!1,3222068885)}),"SGAssign"==t.$route.name||"SGQuotation"==t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.商品链接"),width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.url?e("p",{staticClass:"tx-ellipsis3",staticStyle:{"line-height":"22px"}},[e("a",{attrs:{href:a.row.url,target:"_blank"}},[t._v(t._s(a.row.url))])]):e("p",[t._v("---")])]}}],null,!1,2653453590)}):t._e(),e("el-table-column",{attrs:{label:t.$t("quotation.客户邮箱")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.username?e("span",[t._v(t._s(a.row.username))]):e("span",[t._v("---")])]}}],null,!1,1477976252)}),e("el-table-column",{attrs:{label:t.$t("quotation.预期价格")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("b",[t._v("$"+t._s(a.row.minPrice)+"-"+t._s(a.row.maxPrice))])]}}],null,!1,2283629017)}),"SGFinish"==t.$route.name||"SGSearch"==t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.回复价格")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.vendorProduct?e("div",[a.row.vendorProduct.cost?e("b",[t._v("$"+t._s(a.row.vendorProduct.cost))]):e("span",[t._v("---")])]):e("div",[t._v(t._s(t.$t("quotation.暂无数据展示")))])]}}],null,!1,2222934269)}):t._e(),"SGNone"==t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.失败原因")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.remark))])]}}],null,!1,186672324)}):t._e(),"SGQuotation"==t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.分配人")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.subUserName?e("span",[t._v(t._s(a.row.subUserName))]):e("span",[t._v("---")])]}}],null,!1,3025709884)}):t._e(),"SGQuotation"!=t.$route.name&&"SGAssign"!=t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.报价人")},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.subUserNameCompleted?e("span",[t._v(t._s(a.row.subUserNameCompleted))]):e("span",[t._v("---")])]}}],null,!1,1048716892)}):t._e(),e("el-table-column",{attrs:{label:t.$t("quotation.创建日期")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(1e3*e.row.timeCreated).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}],null,!1,908369978)}),"SGSearch"!=t.$route.name?e("el-table-column",{attrs:{label:t.$t("goods.操作"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return["SGQuotation"==t.$route.name||"SGAssign"==t.$route.name?e("el-link",{staticClass:"mg-r-15",attrs:{type:"primary",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.quotation(a.row)}}},[t._v(t._s(t.$t("quotation.报价")))]):t._e(),"SGAssign"==t.$route.name?e("el-link",{staticClass:"mg-r-15",attrs:{type:"primary",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.assign(a.row)}}},[t._v(t._s(t.$t("quotation.分配")))]):t._e(),e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.openDetail(a.row)}}},[t._v(t._s(t.$t("quotation.详情")))])]}}],null,!1,3248845272)}):t._e(),"SGSearch"==t.$route.name?e("el-table-column",{attrs:{label:t.$t("quotation.状态"),width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==t.$store.state.userInfo.offerProductDistribute?[1==a.row.status?e("span",[t._v(t._s(t.$t("quotation.待报价")))]):t._e(),2==a.row.status?e("span",[t._v(t._s(t.$t("quotation.已完成")))]):t._e(),9==a.row.status?e("span",[t._v(t._s(t.$t("quotation.无法搜品")))]):t._e()]:[1!=a.row.status||a.row.subUserId&&0!=a.row.subUserId?t._e():e("span",[t._v(t._s(t.$t("quotation.待分配")))]),1==a.row.status&&a.row.subUserId&&0!=a.row.subUserId?e("span",[t._v(t._s(t.$t("quotation.待报价")))]):t._e(),2==a.row.status?e("span",[t._v(t._s(t.$t("quotation.已完成")))]):t._e(),9==a.row.status?e("span",[t._v(t._s(t.$t("quotation.无法搜品")))]):t._e()]]}}],null,!1,290386706)}):t._e()],1):e("div",{staticClass:"noProduct"},[e("div",[t._v(t._s(t.$t("quotation.暂无数据展示")))])])],1),e("dialogDetail",{attrs:{data:t.dialogDetail}})],1)}),o=[],l=function(){var t=this,e=t._self._c;return e("div",[t.data?e("el-dialog",{attrs:{visible:t.data.isShow,width:"700px",title:t.$t("quotation.详情")},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)}}},[e("el-divider"),e("div",{staticStyle:{height:"500px",overflow:"auto"}},[e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.基础信息")))]),e("el-form",{ref:"baseForm",attrs:{"label-position":"left"}},[e("el-form-item",{staticClass:"img-box",attrs:{label:t.$t("quotation.图片："),"label-width":"150px"}},[t.data.data.imgUrlJson?e("div",{staticClass:"d-flex",staticStyle:{"flex-wrap":"wrap"}},t._l(t.data.data.imgUrlJson,(function(t){return e("div",{key:t,staticClass:"upload"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t,"z-index":9999,fit:"cover"}})],1)})),0):t._e()]),e("el-form-item",{attrs:{label:t.$t("quotation.商品名称")+":","label-width":"150px"}},[t.data.data.name?e("span",[t._v(t._s(t.data.data.name))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.价格")+":","label-width":"150px"}},[t.data.data.minPrice&&t.data.data.maxPrice?e("span",[t._v("$"+t._s(t.data.data.minPrice)+"-"+t._s(t.data.data.maxPrice))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.商品链接")+":","label-width":"150px"}},[t.data.data.url?e("span",[t._v(t._s(t.data.data.url))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.描述")+":","label-width":"150px"}},[t.data.data.description?e("span",[t._v(t._s(t.data.data.description))]):e("span",[t._v("---")])]),"SGAssign"!=t.$route.name?e("el-form-item",{attrs:{label:t.$t("quotation.分配人")+":","label-width":"150px"}},[t.data.data.subUserName?e("span",[t._v(t._s(t.data.data.subUserName))]):e("span",[t._v("---")])]):t._e()],1)],1),"SGFinish"==t.$route.name||"SGNone"==t.$route.name?e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.回复信息")))]),"SGFinish"==t.$route.name?[t.data.data.vendorProduct?e("el-form",{ref:"productForm",attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{"label-width":"150px",label:t.$t("quotation.回复价格")+":"}},[t.data.data.vendorProduct.cost?e("span",[t._v("$"+t._s(t.data.data.vendorProduct.cost))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{"label-width":"150px",label:t.$t("quotation.回复时间")+":"}},[t._v(" "+t._s(t.$moment(1e3*t.data.data.timeUpdate).format("YYYY-MM-DD HH:mm:ss"))+" ")]),e("el-form-item",{attrs:{"label-width":"150px",label:t.$t("quotation.备注")+":"}},[t.data.data.remark?e("span",[t._v(t._s(t.data.data.remark))]):e("span",[t._v("---")])])],1):t._e()]:[e("el-form",{ref:"productForm",attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{"label-width":"150px",label:t.$t("quotation.失败原因")+":"}},[t.data.data.remark?e("span",[t._v(t._s(t.data.data.remark))]):e("span",[t._v("---")])])],1)]],2):t._e()]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.data.isShow=!1}}},[t._v(t._s(t.$t("quotation.关闭")))])],1)],1):t._e()],1)},n=[],u={props:["data"],data(){return{}},methods:{},components:{}},c=u,d=(a("dc9a"),a("2877")),m=Object(d["a"])(c,l,n,!1,null,"041875cc",null),p=m.exports,h={props:["loading","items","categroyArr","filterData"],data(){return{selectLoading:!1,selectArr:[],isAllCheck:!1,checkboxArr:[],productTypeArr:this.$dict.productTypeArr,productItem:{},dialogDetail:{isShow:!1,data:{}}}},components:{dialogDetail:p},watch:{checkboxArr(){this.isAllCheck=this.items.length&&this.items.length==this.checkboxArr.length}},methods:{quotation(t){this.$router.push({name:"quotationGoods",query:{id:t.id,waitDistribute:this.waitDistribute}})},changeAllCheckbox(t){this.checkboxArr=t?this.items.map(t=>t.id):[]},remoteMethodCustom(t){this.selectArr=[],t&&(this.selectLoading=!0,this.$apiCall("api.SubUser.findByUser",{nameLike:t},t=>{this.selectLoading=!1,9999==t.ErrorCode?(this.selectArr=t.Data.Results,"SGQuotation"!=this.$route.name&&this.selectArr.push({name:this.$store.state.userInfo.name,id:"0"})):this.$message({message:t.Message,type:"error"})}))},assign(t){"All"==t?this.$emit("assign",this.checkboxArr):(this.selectArr=[],this.selectArr.push(t.id),this.$emit("assign",this.selectArr))},openDetail(t){this.dialogDetail.data=this.productItem=t,this.dialogDetail.isShow=!0},assignAll(){this.assign("All")},dateChange(){this.filterData.date.length>1&&(this.filterData.dateFrom=this.$moment(this.filterData.date[0]).format("YYYY-MM-DD"),this.filterData.dateTo=this.$moment(this.filterData.date[1]).format("YYYY-MM-DD"),this.filterGetItem())},filterGetItem(){this.$emit("filterGetItem")},clearFilter(t){this.selectArr=[],this.$emit("clearFilter",t)}}},g=h,f=(a("a1c2"),a("0cd1"),Object(d["a"])(g,r,o,!1,null,"facb2a66",null)),b=f.exports,$={data(){return{distributedNum:0,waitDistributeNum:0,offerProductDistribute:2,form:{staff:"",idList:[]},roleList:[],staffList:[],isSetect:!1,status:"",statusIn:"",waitDistribute:"",assignDialog:!1,selectAssignDialog:!1,isOpenAssign:!1,loading:!1,pageKey:(new Date).valueOf(),activeName:"",pageSize:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem(this.$route.name+"RowsPerPage")?Number(localStorage.getItem(this.$route.name+"RowsPerPage")):10,items:[],total:0,totalPage:0,productTypeArr:this.$dict.productTypeArr,filterData:{name:"",nameIpt:"",date:[],dateFrom:"",dateTo:"",subUserId:"",subUserIdCompleted:"",type:""},defaultFilterData:"{}"}},components:{Sub:b},computed:{},watch:{$route:"gotoPage"},mounted(){this.defaultFilterData=JSON.stringify(this.filterData),this.$store.state.userInfo.offerProductDistribute&&1==this.$store.state.userInfo.offerProductDistribute?this.isOpenAssign=!0:this.isOpenAssign=!1,this.activeName=this.$route.name,this.changeStatus(),this.getRole(),this.getNum()},methods:{getNum(){this.$apiCall("api.OfferProduct.getVendorAllOfferProductCnt",{waitDistribute:this.isOpenAssign?"1":"2"},t=>{9999==t.ErrorCode?(this.waitDistributeNum=t.Data.Results.waitDistributeNum?t.Data.Results.waitDistributeNum:0,this.distributedNum=t.Data.Results.distributedNum?t.Data.Results.distributedNum:0):this.$message({message:t.Message,type:"error"})})},assignStaff(){this.$apiCall("api.OfferProduct.distributeSubUser",{idList:this.form.idList,subUserId:this.form.staff},t=>{9999==t.ErrorCode?(this.closeSelectAssign(),this.getItems(),this.getNum(),this.$message({message:this.$t("shop.分配成功"),type:"success"})):this.$message({message:t.Message,type:"error"})})},closeSelectAssign(){this.selectAssignDialog=!1,this.form={roleId:"",staff:"",idList:[]},this.isSetect=!1},staffChange(){this.form.staff="",this.isSetect=!0,this.$apiCall("api.SubUser.findByUser",{page:this.page,rowsPerPage:100,roleId:this.form.roleId},t=>{9999==t.ErrorCode?this.staffList=t.Data.Results:this.$message({message:t.Message,type:"error"})})},getRole(){this.$apiCall("api.UserRole.findByUser",{},t=>{9999==t.ErrorCode?this.roleList=t.Data.Results:this.$message({message:t.Message,type:"error"})})},assign(t){this.form.idList=t,this.selectAssignDialog=!0},changeStatus(){switch(this.$route.name){case"SGAssign":this.status=1,this.waitDistribute=1;break;case"SGQuotation":this.status=1,this.waitDistribute=2;break;case"SGFinish":this.status=2,this.waitDistribute="";break;case"SGNone":this.status=9,this.waitDistribute="";break;case"SGSearch":this.status="",this.waitDistribute="";break}this.getItems()},changeAssign(t){this.offerProductDistribute="open"==t?1:2,this.assignDialog=!0},closeAssign(){this.$apiCall("api.OfferProduct.changeUserDistributed",{offerProductDistribute:this.offerProductDistribute},t=>{9999==t.ErrorCode?(this.assignDialog=!1,this.isOpenAssign=!this.isOpenAssign,this.$store.state.userInfo.offerProductDistribute=this.offerProductDistribute,2==this.offerProductDistribute&&this.$router.push({name:"SGQuotation"}),this.getNum(),this.$message({message:1==this.offerProductDistribute?this.$t("quotation.开启成功"):this.$t("quotation.关闭成功"),type:"success"})):this.$message({message:t.Message,type:"error"})})},getItems(t){this.loading=!0;let e={subUserIdCompleted:this.filterData.subUserIdCompleted,statusIn:this.statusIn,status:this.status,waitDistribute:this.waitDistribute,nameLike:this.filterData.name,subUserId:this.filterData.subUserId,timeCreatedFrom:this.filterData.dateFrom,timeCreatedTo:this.filterData.dateTo,page:this.page,rowsPerPage:this.rowsPerPage};"SGSearch"==this.$route.name&&(e.isManageList=1),this.$apiCall("api.OfferProduct.findByVendor",e,e=>{this.loading=!1,9999==e.ErrorCode?(this.items=e.Data.Results.map(t=>(t.imgUrlArr=t.imgUrlJson,t.vendorProduct&&(t.vendorProduct.imgUrlArr=JSON.parse(t.vendorProduct.imgUrlJson)),t)),this.total=Number(e.Data.Pagination.totalCount),this.totalPage=Number(e.Data.Pagination.totalPage),t||(this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0)):this.$message({message:e.Message,type:"error"})})},handleClick(t){t.name==this.$route.name?this.pageKey=(new Date).valueOf():(this.clearFilter("none"),this.$refs.subPage.checkboxArr=[],this.$router.push({name:t.name}))},filterGetItem(){1==this.filterData.type?(this.statusIn="",this.status=this.filterData.type):2==this.filterData.type&&(this.status="",this.statusIn="2,9"),this.page=1,this.getItems()},clearFilter(t){switch(t){case"name":this.filterData.nameIpt=this.filterData.name="";break;case"date":this.filterData.date=[],this.filterData.dateFrom=this.filterData.dateTo="";break;case"subUserId":this.filterData.subUserId="";break;case"subUserIdCompleted":this.filterData.subUserIdCompleted="";break;case"status":this.filterData.type=this.status="",this.statusIn="";break;default:"SGSearch"==this.$route.name&&(this.status=""),this.statusIn="",this.filterData=JSON.parse(this.defaultFilterData)}"none"!=t&&this.toPage(1)},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.$route.name!=this.activeName?(this.clearFilter(),this.$refs["subPage"].selectArr=[],this.activeName=this.$route.name,this.$nextTick(()=>{this.changeStatus()})):this.$nextTick(()=>{this.getItems()})},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t}}):this.getItems()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem(this.$route.name+"RowsPerPage",t),this.getItems()}}},_=$,v=(a("9dc4"),Object(d["a"])(_,s,i,!1,null,null,null));e["default"]=v.exports},"3cb0":function(t,e,a){},"57b4":function(t,e,a){"use strict";a("0959")},"62de":function(t,e,a){},8569:function(t,e,a){},"88a7":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"select-product"},[e("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.data.loading,expression:"data.loading"}],attrs:{visible:t.data.isShow,title:t.$t("storeSetting.选择商品"),width:"600px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.data,"isShow",e)},close:t.closeDialog}},[e("el-divider"),e("div",[e("el-form",{staticStyle:{"margin-bottom":"10px !important"},attrs:{inline:!0,size:"mini"}},[t.up?t._e():e("el-form-item",[e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:t.$t("storeSetting.请选择")},on:{change:function(e){return t.filterGetItem("status")}},model:{value:t.filterData.status,callback:function(e){t.$set(t.filterData,"status",e)},expression:"filterData.status"}},[e("el-option",{attrs:{label:t.$t("storeSetting.全部"),value:""}}),e("el-option",{attrs:{label:t.$t("storeSetting.上架"),value:"1"}}),e("el-option",{attrs:{label:t.$t("storeSetting.下架"),value:"2"}})],1)],1),e("el-form-item",[e("el-input",{staticStyle:{width:"160px"},attrs:{clearable:"",size:"mini",placeholder:t.$t("goods.商品名称")},on:{clear:function(e){return t.clearFilter("name")}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterGetItem()}},model:{value:t.filterData.name,callback:function(e){t.$set(t.filterData,"name",e)},expression:"filterData.name"}})],1),e("el-form-item",{staticStyle:{"margin-bottom":"0"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.filterGetItem()}}},[t._v(t._s(t.$t("myinvoice.filter")))]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.clearFilter()}}},[t._v(t._s(t.$t("goods.重置")))])],1)],1)],1),e("el-divider"),e("div",{staticClass:"action"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.goToGoods}},[t._v(t._s(t.$t("storeSetting.管理商品")))]),e("div",{staticClass:"refresh",on:{click:t.getItems}},[e("i",{staticClass:"el-icon-refresh-right"}),e("span",{staticClass:"mg-l-5"},[t._v(t._s(t.$t("storeSetting.刷新")))])])],1),e("el-divider"),t.data.item&&t.data.item.length?e("el-table",{ref:"productTable",attrs:{data:t.data.item,stripe:"",height:"300px"}},[e("el-table-column",{attrs:{label:"",width:"60"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.statusIpt?e("el-radio",{staticClass:"none-label",attrs:{label:a.row.id},model:{value:t.productData,callback:function(e){t.productData=e},expression:"productData"}},[t._v(t._s(""))]):t._e()]}}],null,!1,768795816)}),e("el-table-column",{attrs:{label:t.$t("goods.商品图片"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("el-image",{staticStyle:{width:"60px",height:"60px",border:"1px solid #ddd","background-color":"#fff"},attrs:{src:t.row.imgUrl,fit:"contain","scroll-container":".main-scroll .el-scrollbar__wrap","preview-src-list":t.row.imgUrlArr}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("i",{staticClass:"el-icon-picture-outline"})])])]}}],null,!1,2968517507)}),e("el-table-column",{attrs:{label:t.$t("goods.商品名称")},scopedSlots:t._u([{key:"default",fn:function(a){return[e("p",{staticClass:"tx-ellipsis3",staticStyle:{"line-height":"22px"}},[t._v(t._s(a.row.name))])]}}],null,!1,2941362605)}),e("el-table-column",{attrs:{label:t.$t("storeSetting.状态"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.statusIpt?e("el-tag",[t._v(t._s(t.$t("storeSetting.上架")))]):e("el-tag",{attrs:{type:"success"}},[t._v(t._s(t.$t("storeSetting.下架")))])]}}],null,!1,73026675)})],1):e("div",{staticClass:"no-data"},[e("img",{attrs:{src:a("069c")}}),e("div",[t._v(t._s(t.$t("storeSetting.暂无数据"))+"，"),e("span",{on:{click:t.goToGoods}},[t._v(t._s(t.$t("storeSetting.去添加商品")))])])]),e("div",{ref:"tableFooter",staticStyle:{margin:"10px 0 20px"}},[t.data.item&&t.data.item.length?e("el-row",{attrs:{gutter:20}},[e("el-col",{staticClass:"d-flex justify-content-center",attrs:{span:24}},[e("div",[e("el-pagination",{attrs:{small:"","current-page":Number(t.page),background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"pager-count":Number(5),"page-size":t.rowsPerPage,total:Number(t.total)},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)])],1):t._e()],1),e("el-divider"),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.closeDialog}},[t._v(t._s(t.$t("storeSetting.取消")))]),e("el-button",{attrs:{type:"primary",disabled:!t.productData},on:{click:t.AddGoods}},[t._v(t._s(t.$t("storeSetting.添加")))])],1)],1)],1)},i=[],r=(a("14d9"),{props:["data","up"],data(){return{host:location.host,productItem:{},productData:"",filterData:{name:"",status:""},defaultFilterData:"{}",pageSize:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem(this.$route.name+"RowsPerPage")?Number(localStorage.getItem(this.$route.name+"RowsPerPage")):10,total:0,totalPage:0,loading:!1}},mounted(){this.up&&(this.filterData.status=1),this.getItems(),this.defaultFilterData=JSON.stringify(this.filterData)},watch:{$route:"gotoPage","data.menuData":{deep:!0,handler(){this.data.menuData.urlData&&(this.productData=this.data.menuData.urlData.id)}}},methods:{getItems(){this.loading=!0,this.$apiCall("api.VendorShop.vendorFindProducts",{page:this.page,rowsPerPage:this.rowsPerPage,name:this.filterData.name,status:this.filterData.status},t=>{this.loading=!1,9999==t.ErrorCode?(this.data.item=t.Data.Results.products.map(t=>(t.imgUrlArr=JSON.parse(t.imgUrlJson),t.statusIpt="1"==t.status,t)),this.total=Number(t.Data.Pagination.totalCount),this.totalPage=Number(t.Data.Pagination.totalPage),this.$refs.productTable&&(this.$refs.productTable.bodyWrapper.scrollTop=0)):this.$message({message:t.Message,type:"error"})})},filterGetItem(){this.page=1,this.productData="",this.getItems()},clearFilter(t){switch(t){case"name":this.filterData.name="";break;default:this.filterData=JSON.parse(this.defaultFilterData)}"none"!=t&&this.toPage(1)},AddGoods(){this.productItem?(this.data.item.forEach(t=>{t.id==this.productData&&(this.productItem=t)}),"menuEditor"==this.$route.name?this.$emit("selectedProduct",this.productItem):"quotationGoods"==this.$route.name?(this.$parent.form.id=this.productItem.id,this.$parent.form.imgUrl=this.productItem.imgUrl,this.$parent.form.cost=this.productItem.cost,this.$parent.form={...this.$parent.form}):(this.$parent.setting.name=this.productItem.name,this.$parent.setting.cost=this.productItem.cost,this.$parent.setting.imgUrl=this.productItem.imgUrl,this.$parent.setting.id=this.productItem.id,this.$parent.setting={...this.$parent.setting}),this.closeDialog()):this.$message({message:"请选择一件商品",type:"error"})},goToGoods(){this.$router.push("/goods-mgr/all")},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.$nextTick(()=>{this.getItems()})},toPage(t){t!=this.$route.query.page?this.$router.push({query:{page:t,cid:this.$route.query.cid,id:this.$route.query.id}}):this.getItems()},changePageSize(t){this.rowsPerPage=t,localStorage.setItem(this.$route.name+"RowsPerPage",t),this.getItems()},closeDialog(){this.page=1,"quotationGoods"==this.$route.name?this.$router.push({query:{id:this.$route.query.id}}):this.$router.push({query:{cid:this.$route.query.cid}}),this.data.item={},this.productData="",this.productItem={},this.filterData=JSON.parse(this.defaultFilterData),this.data.isShow=!1}},components:{}}),o=r,l=(a("fd99"),a("2877")),n=Object(l["a"])(o,s,i,!1,null,"4207c570",null);e["a"]=n.exports},"9dc4":function(t,e,a){"use strict";a("b3d2")},a1c2:function(t,e,a){"use strict";a("ab51")},ab51:function(t,e,a){},b3d2:function(t,e,a){},bdbc:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel transaction-page"},[e("el-link",{staticClass:"mg-r-20 mg-b-20",attrs:{icon:"el-icon-back",underline:!1},on:{click:t.returnTo}},[t._v(t._s(t.$t("quotation.报价")))]),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[e("el-row",{attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-card",[e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.基础信息")))]),e("el-form",{ref:"baseForm",staticClass:"mg-t-20",attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{label:t.$t("quotation.图片"),"label-width":"150px"}},[t.item.imgUrlJson?e("div",{staticClass:"d-flex",staticStyle:{"flex-wrap":"wrap"}},t._l(t.item.imgUrlJson,(function(t){return e("div",{key:t,staticClass:"upload"},[e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t,"z-index":9999,fit:"cover"}})],1)})),0):t._e()]),e("el-form-item",{attrs:{label:t.$t("quotation.商品名称"),"label-width":"150px"}},[t.item.name?e("span",[t._v(t._s(t.item.name))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.价格"),"label-width":"150px"}},[t.item.minPrice&&t.item.maxPrice?e("span",[t._v("$"+t._s(t.item.minPrice)+"-"+t._s(t.item.maxPrice))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.商品链接"),"label-width":"150px"}},[t.item.url?e("span",[t._v(t._s(t.item.url))]):e("span",[t._v("---")])]),e("el-form-item",{attrs:{label:t.$t("quotation.描述"),"label-width":"150px"}},[t.item.description?e("span",[t._v(t._s(t.item.description))]):e("span",[t._v("---")])])],1)],1)]),e("el-card",{staticClass:"mg-t-20"},[e("div",{staticClass:"addprobox"},[e("b",[t._v(t._s(t.$t("quotation.回复")))]),e("el-form",{ref:"replyForm",staticClass:"mg-t-20",attrs:{"label-position":"left"}},[e("el-form-item",{attrs:{"label-width":"100px"}},[e("el-radio",{attrs:{label:"1"},model:{value:t.form.radio,callback:function(e){t.$set(t.form,"radio",e)},expression:"form.radio"}},[t._v(t._s(t.$t("quotation.有商品")))]),e("el-radio",{attrs:{label:"2"},model:{value:t.form.radio,callback:function(e){t.$set(t.form,"radio",e)},expression:"form.radio"}},[t._v(t._s(t.$t("quotation.无商品")))]),e("el-radio",{attrs:{label:"3"},model:{value:t.form.radio,callback:function(e){t.$set(t.form,"radio",e)},expression:"form.radio"}},[t._v(t._s(t.$t("quotation.无法报价")))])],1),"1"==t.form.radio?[e("el-form-item",{attrs:{label:t.$t("quotation.添加商品"),"label-width":"150px",required:""}},[e("div",{staticClass:"d-flex"},[e("el-link",{attrs:{type:"primary"},on:{click:t.openSelect}},[t._v(t._s(t.$t("quotation.选择商品")))])],1)]),e("el-form-item",{attrs:{label:t.$t("quotation.商品图片"),"label-width":"150px",required:""}},[e("div",{staticClass:"upload"},[t.form.imgUrl?e("el-image",{staticStyle:{width:"100%",height:"100%"},attrs:{src:t.form.imgUrl,fit:"cover"}}):e("i",{staticClass:"el-icon-plus"})],1)]),e("el-form-item",{attrs:{label:t.$t("quotation.回复价格"),"label-width":"150px",required:""}},[e("el-input-number",{staticStyle:{width:"120px"},attrs:{disabled:"",min:0,controls:!1,precision:2},model:{value:t.form.cost,callback:function(e){t.$set(t.form,"cost",e)},expression:"form.cost"}})],1),e("el-form-item",{attrs:{label:t.$t("quotation.备注"),"label-width":"150px"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:"",placeholder:t.$t("quotation.请输入备注信息")},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)]:"2"==t.form.radio?[e("el-form-item",{attrs:{label:t.$t("quotation.新增商品"),"label-width":"100px"}},[e("el-link",{attrs:{type:"primary"},on:{click:t.goProduct}},[t._v("去上架")])],1)]:[e("el-form-item",{attrs:{label:t.$t("quotation.原因"),"label-width":"100px"}},[e("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:"",placeholder:t.$t("quotation.请输入原因")},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],e("el-form-item",[e("el-divider"),e("div",{staticClass:"mg-t-20"},[e("el-button",{on:{click:t.returnTo}},[t._v(t._s(t.$t("quotation.取消")))]),e("el-button",{attrs:{type:"primary",disabled:"2"==t.form.radio},on:{click:t.quote}},[t._v(t._s(t.$t("quotation.确定")))])],1)],1)],2)],1)])],1)],1)],1),e("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:20}}),e("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"imgFile",accept:".jpg,.png,.gif"},on:{change:function(e){return t.Base64(e)}}}),e("selectProduct",{attrs:{data:t.dialogProductList,up:"up"}})],1)},i=[],r=(a("14d9"),a("88a7")),o={data(){return{dialogProductList:{isShow:!1,item:null},loading:!1,item:{},form:{id:"",radio:"1",imgUrl:"",cost:void 0,remark:""}}},components:{selectProduct:r["a"]},mounted(){this.getItems()},methods:{goProduct(){this.$router.push({name:"GoodsMgrAll"})},returnTo(){this.$router.push("/search-goods-quotation")},getProduct(){this.$apiCall("api.VendorShop.vendorFindProducts",{status:1,page:1,rowsPerPage:10},t=>{9999==t.ErrorCode?this.dialogProductList.item=t.Data.Results.products.map(t=>(t.imgUrlArr=JSON.parse(t.imgUrlJson),t.statusIpt="1"==t.status,t)):this.$message({message:t.Message,type:"error"})})},openSelect(){this.getProduct(),this.dialogProductList.isShow=!0},getItems(){this.loading=!0,this.$apiCall("api.OfferProduct.findByVendor",{status:1,waitDistribute:this.$route.query.waitDistribute},t=>{if(this.loading=!1,9999==t.ErrorCode){let e=[];e=t.Data.Results,e.forEach(t=>{t.id==this.$route.query.id&&(this.item=t)})}else this.$message({message:t.Message,type:"error"})})},uploadOpen(){document.getElementById("imgFile").click()},Base64(t){if(t.target.value){if(t.target.files[0].size/1024/1024>1)return void this.$message({message:this.$t("shop.上传文件不能大于1MB"),type:"error"});let e=new FileReader,a=new Image,s="";e.onload=t=>{a.src=t.target.result;let e=t.target.result.match(/data:image\/(.*);base64,.*/);s=e[1],this.uploadImgBase64(t.target.result.split(",").pop(),s)},e.readAsDataURL(t.target.files[0])}},uploadImgBase64(t,e){this.loading=!0,this.$apiCall("api.User.uploadImgBase64",{imgUrlBase64:t,ext:e},t=>{this.loading=!1,9999==t.ErrorCode?this.form.imgUrl=t.Data.Results.imgUrl:this.$message.error(t.Message)})},quote(){"2"!=this.form.radio?this.form.id||"3"==this.form.radio?(this.loading=!0,this.$apiCall("api.OfferProduct.saveDetail",{id:this.$route.query.id,status:"3"==this.form.radio?"9":"2",productId:this.form.id,remark:this.form.remark},t=>{this.loading=!1,9999==t.ErrorCode?(this.$message.success(this.$t("shop.报价成功")),this.returnTo()):this.$message.error(t.Message)})):this.$message.error(this.$t("shop.请完善回复信息")):this.$message.error(this.$t("shop.请先去上架商品"))}}},l=o,n=(a("57b4"),a("2877")),u=Object(n["a"])(l,s,i,!1,null,"ddad1166",null);e["default"]=u.exports},dc9a:function(t,e,a){"use strict";a("62de")},fd99:function(t,e,a){"use strict";a("8569")}}]);