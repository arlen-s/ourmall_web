(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["storeCode"],{2239:function(t,e,s){t.exports=s.p+"img/store-code.0687d2eb.png"},"31b6":function(t,e,s){"use strict";s("d634")},"337a":function(t,e,s){"use strict";s("f522")},"4ad7":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"add-page"}},[e("div",[e("el-link",{attrs:{icon:"el-icon-arrow-left",underline:!1},on:{click:t.goBack}},[t._v(t._s(t.$t("storePage.返回菜单")))])],1),e("div",{staticClass:"page-title"},[e("h2",[t._v(t._s(t.$t("storePage.自定义页面")))])]),e("el-card",[e("h2",{staticClass:"title"},[t._v(t._s(t.$t("storePage.页面标题")))]),e("el-divider"),e("el-input",{attrs:{maxlength:50,"show-word-limit":""},model:{value:t.addForm.title,callback:function(e){t.$set(t.addForm,"title",e)},expression:"addForm.title"}})],1),e("el-card",{staticClass:"mg-t-30",staticStyle:{"padding-bottom":"20px"}},[e("h2",{staticClass:"title"},[t._v(t._s(t.$t("storePage.内容")))]),e("el-divider"),e("div",{staticStyle:{position:"relative"}},[e("quill-editor",{ref:"QuillEditor",staticClass:"editor",attrs:{options:t.editorOption},model:{value:t.addForm.content,callback:function(e){t.$set(t.addForm,"content",e)},expression:"addForm.content"}})],1),e("el-upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{action:"",limit:5,"list-type":"picture-card","before-upload":t.onBeforeUpload,"http-request":t.Upload}},[e("i",{staticClass:"el-icon-plus"})]),e("el-row",{staticClass:"btn-group"},[e("el-button",{staticClass:"btn-size",on:{click:t.onCancel}},[t._v(t._s(t.$t("storePage.取消")))]),e("el-button",{staticClass:"btn-size",attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v(t._s(t.$t("storePage.保存")))])],1)],1)],1)},i=[],a=(s("14d9"),s("a753"),s("8096"),s("14e1"),s("953d")),r={data(){return{addForm:{title:"",content:""},type:"add",file:null,loading:!1,editorOption:{modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{script:"sub"},{script:"super"}],[{align:[]}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{header:1},{header:2}],[{direction:"rtl"}],["link","image","video"],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}]],handlers:{image:function(t){t?(console.log(t),document.querySelector(".el-upload__input").click()):this.quill.format("image",!1)}}}}}}},components:{quillEditor:a["quillEditor"]},mounted(){this.getConfig();let t=this.$route.params.items;this.type=this.$route.params.type,"edit"==this.type&&(this.addForm.title=t.title,this.addForm.content=t.content)},methods:{onBeforeUpload(t){this.file=t,console.log(t)},Upload(){let t=this.file;const e=t=>new Promise((function(e,s){let o=new FileReader;o.readAsDataURL(t),o.onload=function(t){e(this.result)}}));e(t).then(t=>{let e=t,s=e.match(/data:image\/(.*);base64,.*/);this.ext=s[1],this.base64=e.split("base64,").pop(),this.$apiCall("api.User.uploadImgBase64",{imgUrlBase64:this.base64,ext:this.ext},t=>{if(9999==t.ErrorCode){console.log(t);let e=this.$refs.QuillEditor.quill;if(t){let s=e.getSelection().index;e.insertEmbed(s,"image",t.Data.Results.imgUrl),e.setSelection(s+1)}else Message.error("图片插入失败")}})})},getConfig(){this.$apiCall("api.VendorShop.getShopConfig",{},t=>{9999==t.ErrorCode&&t.Data.Results.header&&(this.$store.commit("getShopConfig",t.Data.Results),t.Data.Results.hasOwnProperty("customPage")||this.$store.commit("noThenAdd",[]))})},goBack(){this.$router.push({path:"/store-page"})},onCancel(){this.$router.go(-1)},onSubmit(){let t={id:this.$moment().unix(),title:this.addForm.title,content:this.addForm.content,updateTime:this.$moment().unix()};"edit"==this.type?(t.id=this.$route.params.id,this.$store.commit("editCustomPage",t),this.$store.commit("asyncChangeMenu",t)):this.$store.commit("addCustomPage",t),this.loading=!0,this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},t=>{this.loading=!1,9999==t.ErrorCode?(this.$elementMessage(this.$t("storecode.success"),"success"),this.$router.go(-1)):this.$message({message:t.Message,type:"error"})})}}},l=r,n=(s("337a"),s("2877")),d=Object(n["a"])(l,o,i,!1,null,"d9f8d020",null);e["default"]=d.exports},"699b":function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"custom-page"}},[e("div",{staticClass:"page-title"},[e("h2",[t._v(t._s(t.$t("storePage.自定义页面")))]),t.items.length>0?e("el-button",{attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),size:"mini",type:"primary"},on:{click:t.addPage}},[t._v(t._s(t.$t("storePage.创建新页面")))]):t._e()],1),e("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{minHeight:"200px"}},[t.loading||t.items.length||t.deleteStatus?t._e():e("div",{staticClass:"no-code"},[e("div",{staticClass:"image"},[e("img",{attrs:{src:s("7841"),alt:""}})]),e("div",{staticClass:"content"},[e("h3",[t._v(t._s(t.$t("storePage.定制专属页面")))]),e("p",[t._v(t._s(t.$t("storePage.快速创建")))]),e("button",{on:{click:t.addPage}},[t._v(t._s(t.$t("storePage.创建页面")))])])]),t.items.length>0?e("div",{staticClass:"list"},[e("el-table",{attrs:{data:t.items}},[e("el-table-column",{attrs:{type:"selection"}}),e("el-table-column",{attrs:{label:t.$t("storePage.页面标题"),prop:"title"}}),e("el-table-column",{attrs:{label:t.$t("storePage.最后修改日期")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.$moment(1e3*e.row.updateTime).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}],null,!1,643219435)}),e("el-table-column",{attrs:{label:t.$t("storePage.操作")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-link",{attrs:{type:"primary",disabled:!t.$isRole(t.$route.meta.roleWrite)},on:{click:function(e){return t.onEditor(s.row)}}},[t._v(t._s(t.$t("storePage.编辑")))]),e("el-link",{staticClass:"mg-l-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"warning"},on:{click:function(e){return t.deleteFn(s.row.id)}}},[t._v(t._s(t.$t("storePage.删除")))])]}}],null,!1,3451165159)})],1),e("el-row",{staticClass:"pagination mg-t-20"},[e("el-pagination",{attrs:{"current-page":t.page,background:!0,layout:"sizes, total, prev, pager, next, jumper","page-sizes":t.pageSize,"page-size":t.rowsPerPage,total:t.totalCount},on:{"current-change":t.toPage,"size-change":t.changePageSize}})],1)],1):t._e()])],1)},i=[],a=(s("14d9"),{data(){return{configJson:null,deleteStatus:!1,page:this.$route.query.page?Number(this.$route.query.page):1,pageSize:[10,20,50,100],rowsPerPage:localStorage.getItem(this.$route.name+"RowsPerPage")?Number(localStorage.getItem(this.$route.name+"RowsPerPage")):10}},computed:{items(){let t=(this.page-1)*this.rowsPerPage,e=this.page*this.rowsPerPage;return this.$store.state.configJson.customPage?this.$store.state.configJson.customPage.slice(t,e):[]},totalCount(){return this.$store.state.configJson.customPage.length},totalPage(){return Math.ceil(this.$store.state.configJson.customPage.length/this.rowsPerPage)}},created(){this.getItem()},methods:{changePageSize(t){this.rowsPerPage=t,localStorage.setItem(this.$route.name+"RowsPerPage",t)},toPage(t){this.page=t,this.$root.$children[0].$refs.mainScroll.wrap.scrollTop=0},onEditor(t){this.$router.push({name:"addPage",params:{items:t||"",id:t&&t.id||"",type:t&&t.id>0?"edit":""}})},deleteFn(t){this.$confirm(this.$t("storecode.delete1"),"",{confirmButtonText:this.$t("storecode.confirm"),cancelButtonText:this.$t("storecode.cancel"),type:""}).then(()=>{this.loading=!0,this.deleteStatus=!0,this.$store.commit("deletetCustomPage",t),setTimeout(()=>{this.loading=!0,this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},t=>{9999==t.ErrorCode?(setTimeout(()=>{this.deleteStatus=!1},500),this.page>this.totalPage&&(this.page=this.totalPage),this.$elementMessage(this.$t("storecode.success"),"success"),this.getItem()):this.$message({message:t.Message,type:"error"}),this.loading=!1})},300)}).catch(()=>{})},addPage(){this.$router.push({path:"/add-page"})},getItem(){this.loading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},t=>{this.loading=!1,9999==t.ErrorCode?(this.$store.commit("getShopConfig",t.Data.Results),t.Data.Results.hasOwnProperty("customPage")||this.$store.commit("noThenAdd",[]),this.configJson=t.Data.Results):this.$message({message:t.Message,type:"error"})})}}}),r=a,l=(s("d252"),s("2877")),n=Object(l["a"])(r,o,i,!1,null,"2655050d",null);e["default"]=n.exports},7841:function(t,e,s){t.exports=s.p+"img/custom-page.c6f0bec3.png"},c99a:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"contentpanel transaction-page"},[t.items.length?e("div",{ref:"pageHeader",staticClass:"pagetitle"},[e("div",{staticClass:"left"},[e("div",{staticClass:"title"},[e("i",{staticClass:"iconfont icon-zidingyidaima"}),e("h2",[t._v(t._s(t.$t("storecode.title")))])])]),e("div",{staticClass:"right"},[e("el-button",{attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary",size:"medium"},on:{click:t.addCode}},[t._v(t._s(t.$t("storecode.addtitle")))])],1)]):t._e(),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pagebody"},[e("el-row",{staticClass:"mg-b-20",attrs:{gutter:15}},[e("el-col",{attrs:{span:24}},[e("el-card",[t.loading||t.items.length?e("el-table",{ref:"gridTable",staticStyle:{width:"100%"},attrs:{stripe:"",data:t.items,"tooltip-effect":"dark","row-key":t=>t.id}},[e("el-table-column",{attrs:{label:t.$t("storecode.codename")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.name||"---"))])]}}])}),e("el-table-column",{attrs:{label:t.$t("storecode.tap")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.pages||"---"))])]}}])}),e("el-table-column",{attrs:{label:t.$t("storecode.position")},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",[t._v(t._s(s.row.position||"---"))])]}}])}),e("el-table-column",{attrs:{label:t.$t("storecode.action"),width:"150"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",[e("el-link",{staticClass:"mg-r-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary"},on:{click:function(e){return t.addCode(s.row)}}},[t._v(" "+t._s(t.$t("storecode.edit"))+" ")]),e("el-link",{staticClass:"mg-r-20",attrs:{disabled:!t.$isRole(t.$route.meta.roleWrite),type:"primary"},on:{click:function(e){return t.deleteFn(s.row.id)}}},[t._v(" "+t._s(t.$t("storecode.delete"))+" ")])],1)]}}])})],1):e("div",{staticClass:"no-code"},[e("img",{attrs:{src:s("2239"),width:"800"}}),e("h3",[t._v(t._s(t.$t("storecode.title1")))]),e("p",[t._v(t._s(t.$t("storecode.title2")))]),e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.addCode}},[t._v(t._s(t.$t("storecode.addtitle")))])],1)],1)],1)],1)],1),e("el-backtop",{staticClass:"goto-top",attrs:{target:".main-scroll  .el-scrollbar__wrap",right:20,bottom:20}})],1)},i=[],a=(s("14d9"),{data(){return{loading:!1,pageSizes:[10,20,50,100],page:this.$route.query.page?Number(this.$route.query.page):1,rowsPerPage:localStorage.getItem("storecodeRowsPerPage")?Number(localStorage.getItem("storecodeRowsPerPage")):10,items:[],configJson:[],total:0,totalPage:0,setting:null}},components:{},watch:{$route:"gotoPage"},mounted(){this.getItem()},methods:{deleteFn(t){this.$confirm(this.$t("storecode.delete1"),"",{confirmButtonText:this.$t("storecode.confirm"),cancelButtonText:this.$t("storecode.cancel"),type:""}).then(()=>{this.$store.commit("deletetCustomCode",t),setTimeout(()=>{this.loading=!0,this.$apiCall("api.VendorShop.setShopConfig",{configJson:JSON.stringify(this.$store.state.configJson)},t=>{this.loading=!1,9999==t.ErrorCode?(this.$elementMessage(this.$t("storecode.success"),"success"),this.getItem()):this.$message({message:t.Message,type:"error"})})},300)}).catch(()=>{})},addCode(t){this.$router.push({name:"addCode",params:{items:t||"",id:t&&t.id||"",type:t&&t.id>0?"edit":""}})},toPage(t){t!=this.$route.query.page&&this.$router.push({query:{page:t}})},changePageSize(t){this.rowsPerPage=t,localStorage.setItem("storecodeRowsPerPage",t),this.getItem()},gotoPage(){this.page=this.$route.query.page?this.$route.query.page:1,this.getItem()},getItem(t){this.loading=!0,this.$apiCall("api.VendorShop.getShopConfig",{},t=>{this.loading=!1,9999==t.ErrorCode?(this.$store.commit("getStoreComponent",t.Data.Results),this.configJson=t.Data.Results,this.items=this.configJson.customCode||[]):this.$message({message:t.Message,type:"error"})})}}}),r=a,l=(s("31b6"),s("2877")),n=Object(l["a"])(r,o,i,!1,null,"27535663",null);e["default"]=n.exports},d252:function(t,e,s){"use strict";s("f2a9")},d634:function(t,e,s){},f2a9:function(t,e,s){},f522:function(t,e,s){}}]);